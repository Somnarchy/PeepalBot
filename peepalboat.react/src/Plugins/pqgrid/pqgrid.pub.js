!function(t){var e=window.pq=window.pq||{},i=e.mixin={};i.render={getRenderVal:function(t,e,i){var n=t.column,r=n.exportRender;return(e&&!1!==r||r)&&(n.render||n._render||n.format)?i.renderCell(t):[t.rowData[t.dataIndx],""]}},i.GrpTree={buildCache:function(){for(var t,e,i=this.that.options,n="groupModel"===this.model,r=n?this.that.pdata:i.dataModel.data,o=this.cache={},a=this.id,s=0,l=r.length;s<l;s++)if(t=r[s],!n||t.pq_gtitle){if(null===(e=t[a]))throw"unknown id of row";o[e]=t}},cascadeInit:function(){if(this.getCascadeInit()){for(var t,e=[],i=this.cbId,n=this.that,r=n.options[this.model].select,o=n.pdata,a=0,s=o.length;a<s;a++)(t=o[a])[i]?this.isEditable(t)?(e.push(t),delete t[i]):r&&(t.pq_rowselect=!0):null===t[i]&&delete t[i];e.length&&this.checkNodes(e,null,null,!0)}},cascadeNest:function(t){for(var e,i,n,r=this.cbId,o=this.prop,a=this.childstr,s=t.length,l=0;l<s;l++)(i=t[l])[o]&&(e=!0,this.eachChild(i,this.chkEachChild(r,i[r],o)),delete i[o]),(n=i[a])&&n.length&&this.cascadeNest(n);e&&this.hasParent(i)&&this.eachParent(i,this.chkEachParent(r))},checkAll:function(t,e){t=null===t||t;var i=this.that;return this.checkNodes(i.pdata,t,e,null,!0)},checkNodes:function(t,e,i,n,r){null===e&&(e=!0);for(var o,a,s,l=0,d=t.length,c=[],h={check:e},u=this.that,f=u.riOffset,p=this.cbId,g=this.prop,v=u.options[this.model],m=!r&&this.isCascade(v),w=n&&v.eventForInit||!n,x=v.select;l<d;l++)o=t[l],this.isEditable(o)&&(a=o.pq_ri,c.push({rowData:o,rowIndx:a,rowIndxPage:a-f}));if(h.rows=c,h.dataIndx=this.colUI.dataIndx,n&&(h.init=n),w&&(s=u._trigger("beforeCheck",i,h)),!1!==s&&(d=(c=h.rows).length)){var y=this.chkRows=[];for(l=0;l<d;l++)o=c[l].rowData,m&&(o[g]=!0),y.push({rd:o,val:e,oldVal:o[p]}),o[p]=e;m&&this.cascadeNest(this.getRoots()),x&&this.selectRows(),m&&(h.getCascadeList=this.getCascadeList(this)),w&&u._trigger("check",i,h),y.length=0}this.setValCBox(),n||u.refresh({header:!1})},chkEachChild:function(t,e,i){return function(n){if(this.isEditable(n)&&(!i||!n[i])){var r=n[t];null!==e&&r!==e&&(this.chkRows.push({rd:n,val:e,oldVal:r}),n[t]=e)}}},chkEachParent:function(t){var e=this.childstr;return function(i){if(this.isEditable(i)){for(var n,r,o,a=i[e],s=0,l=0,d=i[t],c=0,h=a.length;c<h;c++)if(n=a[c],this.isEditable(n)){if(o=n[t])s++;else{if(null===o){r=null;break}l++}if(s&&l){r=null;break}}void 0===r&&(r=!!s),d!==r&&(this.chkRows.push({rd:i,val:r,oldVal:d}),i[t]=r)}}},eachChild:function(t,e){e.call(this,t);for(var i,n=this.childstr,r=t[n]||[],o=0,a=r.length;o<a;o++)(i=r[o])[n]?this.eachChild(i,e):e.call(this,i)},eachParent:function(t,e){for(;t=this.getParent(t);)e.call(this,t)},_flatten:function(t,e,i,n){for(var r,o,a=t.length,s=this.id,l=this.parentId,d=0,c=this.childstr;d<a;d++)(r=t[d]).pq_level=i,n.push(r),e&&(r[l]=s?e[s]:e),(o=r[c])&&this._flatten(o,r,i+1,n)},flatten:function(t){var e=[];return this._flatten(t,null,0,e),e},getCascadeInit:function(){var t=this._cascadeInit;return this._cascadeInit=!0,t},getNode:function(t){return this.cache[t]},getParent:function(t){var e=t[this.parentId];return this.cache[e]},hasParent:function(t){return null!==t[this.parentId]},getRoots:function(t){for(var e,i=this.that,n=t||i.pdata||[],r=n.length,o=0,a=[];o<r;o++)0!==(e=n[o]).pq_level||e.pq_gsummary||a.push(e);return r&&!a.length&&(a=n),a},setCascadeInit:function(t){this._cascadeInit=t},getCascadeList:function(t){var e=[];return function(){if(!e.length)for(var i=t.chkRows,n=0,r=t.cbId,o=i.length;n<o;n++){var a=i[n],s=a.rd,l=s.pq_ri,d={},c={};d[r]=a.val,c[r]=a.oldVal,e.push({rowIndx:l,rowData:s,newRow:d,oldRow:c})}return e}},getChildren:function(t){return t[this.childstr]},getSummary:function(t){return t.pq_child_sum},isAncestor:function(t,e){for(var i=t;i=this.getParent(i);)if(i===e)return!0},isCascade:function(t){return t.cascade&&t.checkbox&&!t.maxCheck},isEditable:function(t){if(t.pq_gsummary)return!1;var e,i=this.that,n=this.colCB;return!n||!(e=n.editable)||("function"==typeof e?e.call(i,{rowData:t}):e)},isFolder:function(t){return null!==t.pq_close||!!t[this.childstr]},onCheckbox:function(t,e){return function(i,n){e.checkbox&&t.colUI===n.column&&t.checkNodes([n.rowData],n.input.checked,i)}},onCMInit:function(){var t,e,i=this.that,n=i.columns,r=this.model,o="treeModel"===r,a=i.options[r];a.checkbox&&n&&((e=n[a.cbId]||{dataIndx:a.cbId}).cb={check:!0,uncheck:!1,select:a.select,header:a.checkboxHead,maxCheck:a.maxCheck},t=o?n[a.dataIndx]:i.colModel[0]),this.colCB=e,this.colUI=t,n&&o&&this.setCellRender()},onCustomSortTree:function(t,e){var i=this.getRoots(e.data);return this.sort(i,e.sort_composite),e.data=this.flatten(i),!1},onRefresh:function(t,e){return function(){if(e.checkbox)for(var t=this.$cont.find(".pq_indeter"),i=t.length;i--;)t[i].indeterminate=!0}},refreshView:function(t){this.that.refreshView({header:!1,source:t})},renderCB:function(t,e,i){if(e.pq_gsummary)return"";var n,r=this.that,o="",a="",s="";return"function"==typeof t&&(t=t.call(r,e)),t?(e[i]&&(o="checked"),this.isEditable(e)||(a="disabled",n="pq_disable"),null===e[i]&&(s="class='pq_indeter'"),["<input type='checkbox' "+s+" "+o+" "+a+"/>",n]):void 0},selectRows:function(){for(var t=0,e=this.chkRows,i=e.length;t<i;t++){var n=e[t],r=n.rd,o=n.val;r.pq_rowselect=o}},sort:function(t,e){var i=this.childstr,n=function(t){return"function"==typeof e?e:e[t]};!function t(e,r){var o,a=e.length,s=0;if(a)for(r&&e.sort(r),r=n(e[0].pq_level+1);s<a;s++)(o=e[s][i])&&t(o,r)}(t,n(0))},copyArray:function(t,e){for(var i=0,n=e.length;i<n;i++)t.push(e[i])},_summaryT:function(t,i,n,r,o,a,s){for(var l,d,c,h,u,f=this.childstr,p="groupModel"===this.model,g=a.summaryInTitleRow,v=this.that.colIndxs,m=a.showSummary,w=a.titleInFirstCol,x=0,y=t.length,C=0,b={},I={},_=this.id,q=this.parentId,D=p&&s?a.dataIndx[s.pq_level]:"",R=[],M=n.length,T=e.aggregate;C<M;C++)b[u=n[C]]=[];for(;x<y;x++){if(d=t[x],l=null,i.push(d),c=d[f]){for(l=this._summaryT(c,i,n,r,o,a,d),C=0;C<M;C++)u=n[C],this.copyArray(b[u],l[1][u]);this.copyArray(R,l[2])}if(!p||!d.pq_gtitle){for(C=0;C<M;C++)b[u=n[C]].push(d[u]);R.push(d)}}for(C=0;C<M;C++)u=n[C],h=(h=r[C])[D]||h.type,I[u]=T[h](b[u],o[C],R),g&&s&&(0===v[u]&&w||(s[u]=I[u]));return!s||p&&!m[s.pq_level]||(I.pq_level=s.pq_level,I[q]=s[_],i.push(I),s.pq_child_sum=I,I.pq_hidden=s.pq_close),I.pq_gsummary=!0,[I,b,R]},summaryT:function(){for(var e,i,n,r=this.that,o=r.options,a=o[this.model],s=this.getRoots(),l=[],d=[],c=[],h=[],u=0,f=r.colModel,p=f.length;u<p;u++)(i=(e=f[u]).summary)&&!t.isEmptyObject(i)&&(c.push(e.dataIndx),h.push(e),d.push(i));n=this._summaryT(s,l,c,d,h,a)[0],a.grandSummary?(n.pq_grandsummary=!0,this.summaryData=o.summaryData=[n]):(this.summaryData||[]).length=0,r.pdata=l}}}(jQuery),function(t){var e=(window.pq=window.pq||{}).mixin,i=!0;t(function(){var e=t("<input type='checkbox' style='position:fixed;left:-50px;top:-50px;'/>").appendTo(document.body);e[0].indeterminate=!0,e.on("change",function(){i=!1}),e.click(),e.remove()}),e.ChkGrpTree={getCheckedNodes:function(t){var e,i=this.that,n=t?i.getData():i.options.dataModel.data,r=n.length,o=0,a=[],s=this.colCB||{},l=(s.cb||{}).check,d=s.dataIndx;if(null!==d)for(;o<r;o++)(e=n[o])[d]===l&&a.push(e);return a},hasCboxHead:function(){return((this.colCB||{}).cb||{}).header},isHeadChecked:function(){return this.inpVal},onBeforeCheck:function(t,e){if(e.check&&this.colCB){var i=this.colCB,n=i.cb,r=n.select,o=n.maxCheck;if(o&&this.colUI.dataIndx===e.dataIndx){var a=e.rows.slice(0,o),s=a.length,l=i.dataIndx,d=this.getCheckedNodes(!0),c=s+d.length-o;c>0&&d.slice(0,c).forEach(function(t){t[l]=n.uncheck,r&&delete t.pq_rowselect}),e.rows=a}}},onHeaderChange:function(t){!1===this.checkAll(t.target.checked,t)&&this.refreshHeadVal()},onRefreshHeader:function(){var t=this,e=t.that;if(t.hasCboxHead()){if("groupModel"===t.model&&!e.options[t.model].on)return;var n=e.getCellHeader({dataIndx:t.colUI.dataIndx}),r=n.find("input");r.length||(n.find(".pq-title-span").prepend('<input type="checkbox" />'),r=n.find("input")),t.$inp&&r[0]===t.$inp[0]||(t.$inp=r,t.refreshHeadVal(),i&&r.on("click",function(e){null===r.data("pq_value")&&(r[0].checked=!0,r.data("pq_value",!0),t.onHeaderChange(e))}),r.on("change",function(e){t.onHeaderChange(e)}))}},refreshHeadVal:function(){this.$inp&&this.$inp.pqval({val:this.inpVal})},setValCBox:function(){if(this.hasCboxHead()){var t,e,i=this.that,n=i.options,r=this.colCB,o=r.dataIndx,a=i.colIndxs[o],s=r.cb,l=s.all,d="remote"===n.pageModel.type||!l?i.riOffset:0,c=l?n.dataModel.data:i.pdata,h=null,u=0,f=0,p=0;if(c){for(var g=0,v=c.length;g<v;g++)e=g+d,(t=c[g]).pq_gsummary||t.pq_gtitle||!this.isEditable(t,r,e,a,o)||(f++,t[o]===s.check?u++:p++);u===f&&f?h=!0:p===f&&(h=!1),this.inpVal=h,this.refreshHeadVal()}}},unCheckAll:function(){this.checkAll(!1)},unCheckNodes:function(t,e){this.checkNodes(t,!1,e)}}}(jQuery),function(t){var e=t.ui.autocomplete.prototype,i=e._renderMenu,n=e._renderItem;e._renderMenu=function(e,n){i.call(this,e,n);var r=this.options.selectItem;if(r&&r.on){var o=void 0===(o=r.cls)?"ui-state-highlight":o,a=this.element.val();a&&o&&t("a",e).filter(function(){return t(this).text()===a}).addClass(o)}},e._renderItem=function(t,e){var i=n.call(this,t,e),r=this.options.highlightText;if(r&&r.on){var o=this.element.val();if(o){var a=new RegExp("("+o+")","i"),s=e.label;if(a.test(s)){var l=void 0===(l=r.style)?"font-weight:bold;":l,d=void 0===(d=r.cls)?"":d;s=s.replace(a,"<span style='"+l+"' class='"+d+"'>$1</span>"),i.find("a").html(s)}}}return i};var r=t.paramquery=t.paramquery||{},o=function(t,e,i,n){for(var r=e.slice(),o=0,a=r.length,s=[];o<a;o++){var l=r[o],d=l.cb,c=l.one;if(c){if(l._oncerun)continue;l._oncerun=!0}if(!1===d.call(t,i,n)&&(i.preventDefault(),i.stopPropagation()),c&&s.push(o),i.isImmediatePropagationStopped())break}if(a=s.length)for(o=a-1;o>=0;o--)r.splice(s[o],1)};r._trigger=function(e,i,n){var r,a,s=this.listeners,l=s[e],d=this.options,c=d.allEvents,h=d.bubble,u=this.element,f=d[e];if(n=n||{},(i=t.Event(i)).type=this.widgetName+":"+e,i.target=u[0],a=i.originalEvent)for(r in a)r in i||(i[r]=a[r]);if(c&&"function"==typeof c&&c.call(this,i,n),l&&l.length&&(o(this,l,i,n),i.isImmediatePropagationStopped()))return!i.isDefaultPrevented();if(d.trigger&&(u[h?"trigger":"triggerHandler"](i,n),i.isImmediatePropagationStopped()))return!i.isDefaultPrevented();f&&(!1===f.call(this,i,n)&&(i.preventDefault(),i.stopPropagation()));return(l=s[e+"Done"])&&l.length&&o(this,l,i,n),!i.isDefaultPrevented()};var a=function(t,e,i,n,r){var o=t.listeners[e];o||(o=t.listeners[e]=[]),o[r?"unshift":"push"]({cb:i,one:n})};r.on=function(){var t=arguments;if("boolean"==typeof t[0])var e=t[0],i=t[1],n=t[2],r=t[3];else i=t[0],n=t[1],r=t[2];for(var o=i.split(" "),s=0;s<o.length;s++){var l=o[s];l&&a(this,l,n,r,e)}return this},r.one=function(){for(var t=arguments.length,e=[],i=0;i<t;i++)e[i]=arguments[i];return e[t]=!0,this.on.apply(this,e)};var s=function(t,e,i){if(i){var n=t.listeners[e];if(n){for(var r=[],o=0,a=n.length;o<a;o++){i===n[o].cb&&r.push(o)}if(r.length)for(o=r.length-1;o>=0;o--)n.splice(r[o],1)}}else delete t.listeners[e]};r.off=function(t,e){for(var i=t.split(" "),n=0;n<i.length;n++){var r=i[n];r&&s(this,r,e)}return this};var l={options:{items:".pq-grid-cell.pq-has-tooltip,.pq-grid-cell[title]",position:{my:"center top",at:"center bottom"},content:function(){var e=t(this),i=e.closest(".pq-grid").pqGrid("instance"),n=i.getCellIndices({$td:e}),r=n.rowIndx,o=n.dataIndx,a=i.data({rowIndx:r,dataIndx:o,data:"pq_valid"}).data;if(a){var s=a.icon,l=a.msg;return(""===s?"":"<span class='ui-icon "+s+" pq-tooltip-icon'></span>")+(l=null!==l?l:"")}return e.attr("title")}},_create:function(){this._super();var e=this.element,i=this.eventNamespace;e.on("pqtooltipopen"+i,function(e,i){var n=t(e.target),r=t(e.originalEvent.target);if(r.on("remove.pqtt",function(t){n.pqTooltip("close",t,!0)}),n.is(".pq-grid")){var o,a=n.pqGrid("instance"),s=a.getCellIndices({$td:r}),l=s.rowIndx,d=s.dataIndx;if((o=a.getRowData({rowIndx:l}))&&(o=o.pq_celldata)&&(o=o[d])&&(o=o.pq_valid)){var c=o,h=c.style,u=c.cls;i.tooltip.addClass(u);var f=i.tooltip.attr("style");i.tooltip.attr("style",f+";"+h)}}}),e.on("pqtooltipclose"+i,function(e,i){t(e.target);t(e.originalEvent.target).off(".pqtt")})}};t.widget("paramquery.pqTooltip",t.ui.tooltip,l)}(jQuery),function(t){t.paramquery=t.paramquery||{},t.paramquery.onResize=function(e,i){var n=t(e);"static"===n.css("position")&&n.css("position","relative");var r=t('<iframe type="text/html" src="about:blank" class="pq-resize-iframe" style="display:block;width:100%;height:100%;position:absolute;top:0;left:0;z-index:-1;overflow: hidden; pointer-events: none;" />').appendTo(n);r[0].data="about:blank",r.css("opacity","0");for(var o=0;o<n.length;o++){var a=r[o];t(a.contentWindow).on("resize",function(t){i.call(e,t)})}}}(jQuery),function(t){var e=t.paramquery,i=Array.prototype;!i.find&&(i.find=function(t,e){for(var i,n=0,r=this.length;n<r;n++)if(i=this[n],t.call(e,i,n,this))return i}),!i.findIndex&&(i.findIndex=function(t,e){for(var i,n=0,r=this.length;n<r;n++)if(i=this[n],t.call(e,i,n,this))return n;return-1});var n,r,o=t.extend(window.pq,{arrayUnique:function(t,e){var i,n,r,o=[],a=t.length,s={};for(i=0;i<a;i++)n=t[i],1!==s[r=e?n[e]:n]&&(s[r]=1,o.push(n));return o},cap1:function(t){return t&&t.length?t[0].toUpperCase()+t.slice(1):""},elementFromXY:function(e){var i,n=e.clientX,r=e.clientY,o=t(document.elementFromPoint(n,r));return o.closest(".ui-draggable-dragging").length&&((i=o).hide(),o=t(document.elementFromPoint(n,r)),i.show()),o},escapeHtml:function(t){return t.replace(/&/g,"&amp;").replace(/<(\S)/g,"&lt;$1")},escapeXml:function(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;")},excelToJui:(r={},function(t){var e=r[t];return e||(e=t.replace(/yy/g,"y").replace(/dddd/g,"DD").replace(/ddd/g,"D").replace(/mmmm/g,"MM").replace(/mmm/g,"M"),r[t]=e),e}),excelToNum:function(){var t={};return function(e){var i=t[e];return i||(i=e.replace(/\\/g,""),t[e]=i),i}}(),flatten:function(t,e){var i,n=0,r=t.length;for(e=e||[];n<r;n++)null!==(i=t[n])&&(i.push?o.flatten(i,e):e.push(i));return e},toRC:function(t){var e=t.match(/([A-Z]+)(\d+)/),i=o.toNumber(e[1]);return[e[2]-1,i]},formatEx:function(t,e,i,n){return i&&(n=n||o.getDataType(t),o.filter.conditions[i][n])?this.format(t,e,n):e},format:function(e,i,n){var r=e.format;if(r&&null!==i){if("function"==typeof r)return r(i);if("date"===(n=n||o.getDataType(e)))try{var a=new Date(i);a&&!isNaN(a.getTime())&&(i=t.datepicker.formatDate(r,a))}catch(t){}else i=o.formatNumber(i,r)}return i},deFormat:function(e,i,n){if(i){var r,a,s=e.format;if(s&&(a=o.getDataType(e),!n||o.filter.conditions[n][a]))try{"function"==typeof s?i=e.deFormat(i):"date"===a?(r=e.formatRaw||"mm/dd/yy")!==s&&(i=t.datepicker.parseDate(s,i),i=t.datepicker.formatDate(r,i)):i=o.deFormatNumber(i,s)}catch(t){i=null}}return i},fakeEvent:function(t,e,i){if("timeout"===e){var n;t.off("keyup change").on("keyup change",function(){clearTimeout(n),n=setTimeout(function(){t.triggerHandler("timeout")},i)})}},getAddress:function(t){var e=t.split(":"),i=this.toRC(e[0]),n=i[0],r=i[1],o=this.toRC(e[1]||e[0]),a=o[0],s=o[1];return{r1:n,c1:r,rc:a-n+1,cc:s-r+1,r2:a,c2:s}},getDataType:function(t){var e,i=t.dataType;return"bool"===i?e="bool":"float"===i||"integer"===i?e="number":"date"===i&&(e="date"),e||"string"},getFn:(n={},function(t){var e=t;return"string"==typeof t&&((e=n[t])||(e=window,t.split(".").forEach(function(t){e=e[t]}),n[t]=e)),e}),isCtrl:function(t){return t.ctrlKey||t.metaKey},isDateFormat:function(){var t={};return function(e){var i=t[e];return null===i&&(i=t[e]=/^[mdy\s-\/,]*$/i.test(e)),i}}(),isEmpty:function(t){for(var e in t)return!1;return!0},juiToExcel:function(){var t={};return function(e){var i=t[e];return i||(i=e.replace(/y/g,"yy").replace(/DD/g,"dddd").replace(/D/g,"ddd").replace(/MM/g,"mmmm").replace(/M/g,"mmm"),t[e]=i),i}}(),makePopup:function(e,i,n){var r=(Math.random()+"").replace(".",""),a="mousedown.pq"+r+" keydown.pq"+r,s=function(){l.remove(),t(document).off(a),n&&n()},l=t(e);l.addClass("pq-popup").on("keydown",function(e){e.keyCode===t.ui.keyCode.ESCAPE&&s()}),t(i).one("remove",function(){s()}),t(document).on(a,function(n){var r=t(n.target);e.contains(r[0])||o.isCtrl(n)||r.closest(".ui-datepicker").length||r.closest(i).length||s()})},moveItem:function(t,e,i,n){return i>n?(e.splice(i,1),e.splice(n++,0,t)):i===n?n++:(e.splice(n,0,t),e.splice(i,1)),n},newLine:function(t){return isNaN(t)&&"string"==typeof t?t.replace(/(\r\n|\r|\n)/g,"<br>"):t},numToExcel:function(){var t={};return function(e){var i=t[e];return i||(i=e.replace(/[^#0,.@]/g,function(t){return"\\"+t}),t[e]=i),i}}(),objectify:function(t){for(var e={},i=t.length;i--;)e[t[i]]=1;return e},unescapeXml:function(){var t={amp:"&",lt:"<",gt:">",quot:'"',apos:"'"};return function(e){return e.replace(/&(amp|lt|gt|quot|apos);/g,function(e,i){return t[i]})}}()});e.select=function(t){var e,i,n,r=t.attr,o=t.options,a=t.groupIndx,s=t.labelIndx,l=t.valueIndx,d=null!==s&&null!==l,c=null!==a,h=t.prepend,u=t.dataMap,f=function(){for(var t={},e=0;e<u.length;e++){var i=u[e];t[i]=w[i]}return"data-map='"+JSON.stringify(t)+"'"},p=["<select ",r," >"];if(h)for(var g in h)p.push('<option value="',g,'">',h[g],"</option>");if(o&&o.length){for(var v=0,m=o.length;v<m;v++){var w=o[v];if(d){var x=w[l],y=w.pq_disabled?'disabled="disabled" ':"",C=w.pq_selected?'selected="selected" ':"";if(null===x)continue;if(n=u?f():"",c){var b=w.pq_disabled_group?'disabled="disabled" ':"";i!==(e=w[a])&&(null!==i&&p.push("</optgroup>"),p.push('<optgroup label="',e,'" ',b," >"),i=e)}if(s===l)p.push("<option ",C,y,n,">",x,"</option>");else{var I=w[s];p.push("<option ",C,y,n,' value="',x,'">',I,"</option>")}}else if("object"==typeof w)for(var g in w)p.push('<option value="',g,'">',w[g],"</option>");else p.push("<option>",w,"</option>")}c&&p.push("</optgroup>")}return p.push("</select>"),p.join("")},t.fn.pqval=function(t){if(t){if(t.incr){var e=this.data("pq_value");return this.prop("indeterminate",!1),e?(e=!1,this.prop("checked",!1)):!1===e?(e=null,this.prop("indeterminate",!0),this.prop("checked",!1)):(e=!0,this.prop("checked",!0)),this.data("pq_value",e),e}return e=t.val,this.data("pq_value",e),this.prop("indeterminate",!1),null===e?(this.prop("indeterminate",!0),this.prop("checked",!1)):e?this.prop("checked",!0):this.prop("checked",!1),this}return this.data("pq_value")},e.xmlToArray=function(e,i){var n=i.itemParent,r=i.itemNames,o=[];return t(e).find(n).each(function(e,i){var n=t(i),a=[];t(r).each(function(t,e){a.push(n.find(e).text().replace(/\r|\n|\t/g,""))}),o.push(a)}),o},e.xmlToJson=function(e,i){var n=i.itemParent,r=i.itemNames,o=[];return t(e).find(n).each(function(e,i){for(var n=t(i),a={},s=0,l=r.length;s<l;s++){var d=r[s];a[d]=n.find(d).text().replace(/\r|\n|\t/g,"")}o.push(a)}),o},e.tableToArray=function(e){var i=t(e),n=[],r=[],o=i.children("tbody").children("tr"),a=o.length?t(o[0]):t(),s=o.length>1?t(o[1]):t();return a.children("th,td").each(function(e,i){var r=t(i),o=r.html(),a=r.width(),l="left";if(s.length){var d=s.find("td:eq("+e+")").attr("align");l=d||l}var c={title:o,width:a,dataType:"string",align:l,dataIndx:e};n.push(c)}),o.each(function(e,i){if(0!==e){var n=t(i),o=[];n.children("td").each(function(e,i){o.push(t.trim(t(i).html()))}),r.push(o)}}),{data:r,colModel:n}};var a,s=(a={},function(t,e){var i,n,r,o;if(t){if(n=t.split(":"),t=e&&n.length>1?n[1]:n[0],i=a[t])return i;r=/^([^#]*|&#[^#]*)?[\,\.#0]*?([\,\s\.]?)([#0]*)([\,\s\.]?)([0]*?)(\s*[^#^0]*|&#[^#]*)?$/,(o=t.match(r))&&o.length&&(i={symbol:o[1]||"",thouSep:o[2],thousand:o[3].length,decSep:o[4],decimal:o[5].length,symbolEnd:o[6]||""},a[t]=i)}return i=i||{symbol:"",symbolEnd:"",thouSep:",",thousand:3,decSep:".",decimal:2}});e.formatCurrency=function(t,e){var i=parseFloat(t);if(!isNaN(i)){for(var n=i<0,r=s(e,n),o=r.symbol,a=r.symbolEnd,l=r.thousand,d=r.thouSep,c=r.decSep,h=r.decimal,u=(i=i.toFixed(h)).length,f=h+c.length,p=i.substring(0,u-f),g=i.substring(u-f+c.length,u),v=p.match(/\d/g).reverse(),m=[],w=0;w<v.length;w++)w>0&&w%l==0&&m.push(d),m.push(v[w]);return(n?"-":"")+o+(p=(m=m.reverse()).join(""))+c+g+a}},o.formatNumber=e.formatCurrency,o.deFormatNumber=function(t,e){var i=s(e,t<0),n=i.symbol,r=i.symbolEnd,o=i.thouSep,a=i.decSep;return o="."===o?"\\.":o,t=t.replace(n,"").replace(r,"").replace(new RegExp(o,"g"),""),a&&(t=1*t.replace(a,".")),t},o.validation={is:function(t,e){return"string"===t||!t||this["is"+(t=t.substring(0,1).toUpperCase()+t.substring(1,t.length))](e)},isFloat:function(t){var e=parseFloat(t);return!isNaN(e)&&e===t},isInteger:function(t){var e=parseInt(t);return!isNaN(e)&&e===t},isDate:function(t){var e=Date.parse(t);return!isNaN(e)}};var l=[],d={},c=o.toLetter=function(t){var e=l[t];if(!e){var i=++t%26,n=t/26|0,r=i?String.fromCharCode(64+i):(--n,"Z");e=n?c(n-1)+r:r,l[--t]=e,d[e]=t}return e};function h(t){return t.charCodeAt(0)-64}o.toNumber=function(t){var e,i,n,r=d[t];if(null===r){for(e=t.length,r=-1,i=0;i<e;i++)n=e-i-1,r+=h(t[i])*Math.pow(26,n);l[r]=t,d[t]=r}return r},o.generateData=function(t,e){for(var i=[],n=0;n<e;n++)i[n]=c(n);var r=[];for(n=0;n<t;n++)for(var o=r[n]=[],a=0;a<e;a++)o[a]=i[a]+(n+1);return r}}(jQuery),function(t){pq.validations={minLen:function(t,e,i){if(t=i(t),e=i(e),t.length>=e)return!0},nonEmpty:function(t){if(null!==t&&""!==t)return!0},maxLen:function(t,e,i){if(t=i(t),e=i(e),t.length<=e)return!0},gt:function(t,e,i){if((t=i(t))>(e=i(e)))return!0},gte:function(t,e,i){if((t=i(t))>=(e=i(e)))return!0},lt:function(t,e,i){if((t=i(t))<(e=i(e)))return!0},lte:function(t,e,i){if((t=i(t))<=(e=i(e)))return!0},neq:function(t,e,i){if((t=i(t))!==(e=i(e)))return!0},regexp:function(t,e){if(new RegExp(e).test(t))return!0}};var e=t.paramquery;e.cValid=function(t){this.that=t},e.cValid.prototype={_isValidCell:function(t){var e=this.that,i=t.column,n=i.validations;if(!n||!n.length)return{valid:!0};var r,o=t.value,a=i.dataType,s=function(t){return e.getValueFromDataType(t,a,!0)},l=t.rowData;if(!l)throw"rowData required.";for(var d=0;d<n.length;d++){var c=n[d],h=c.on,u=c.type,f=!1,p=c.msg,g=c.value;if(!1!==h){if(r=pq.validations[u])f=null!==o&&r(o,g,s);else if(u){var v={column:i,value:o,rowData:l,msg:p};!1===e.callFn(u,v)?(f=!1,p=v.msg):f=!0}else f=!0;if(!f)return{valid:!1,msg:p,column:i,warn:c.warn,dataIndx:i.dataIndx,validation:c}}}return{valid:!0}},onScrollCell:function(t,e,i,n,r,o){var a,s=this.that,l=s.options.bootstrap;if(t||(a=s.getEditCell())&&a.$cell){var d=t||a.$cell;d.attr("title",e);var c="tooltip",h="open";l.on&&l.tooltip&&(c=l.tooltip,h="show");try{d[c]("destroy")}catch(t){}d[c]({trigger:"manual",position:{my:"left center+5",at:"right center"},content:function(){return(""===i?"":"<span class='ui-icon "+i+" pq-tooltip-icon'></span>")+e},open:function(t,e){var i=e.tooltip;if(n&&i.addClass(n),o){var a=i.attr("style");i.attr("style",a+";"+o)}r&&i.tooltip.css(r)}})[c](h)}},isValidCell:function(e){var i=this,n=this.that,r=e.rowData,o=e.rowIndx,a=e.value,s=e.valueDef,l=e.column,d=e.focusInvalid,c=n.options,h=(c.bootstrap,e.allowInvalid),u=l.dataIndx,f=c.validation,p=c.warning,g=c.editModel,v=g.invalidClass,m=g.warnClass,w=document.activeElement;if(e.checkEditable&&!1===n.isEditable({rowIndx:o,rowData:r,column:l,dataIndx:u}))return{valid:!0};var x=this._isValidCell({column:l,value:a,rowData:r}),y=x.valid,C=x.warn,b=x.msg;if(y)n.data({rowData:r,dataIndx:u,data:"pq_valid"})&&(n.removeClass({rowData:r,rowIndx:o,dataIndx:u,cls:m+" "+v}),n.removeData({rowData:r,dataIndx:u,data:"pq_valid"}));else var I=t.extend({},C?p:f,x.validation),_=I.css,q=I.cls,D=I.icon,R=I.style;if(h||C)return y?{valid:!0}:(n.addClass({rowData:r,rowIndx:o,dataIndx:u,cls:C?m:v}),n.data({rowData:r,dataIndx:u,data:{pq_valid:{css:_,icon:D,style:R,msg:b,cls:q}}}),x);if(!y){if(null===o){var M=n.getRowIndx({rowData:r,dataUF:!0});if(null===(o=M.rowIndx)||M.uf)return x.uf=M.uf,x}if(d){var T;if(s){if(t(w).hasClass("pq-editor-focus")){var k=c.editModel.indices;if(k){var E=k.rowIndx,S=k.dataIndx;if(null!==o&&o!==E)throw"incorrect usage of isValid rowIndx: "+o;if(u!==S)throw"incorrect usage of isValid dataIndx: "+u;n.editCell({rowIndx:E,dataIndx:u})}}}else{n.goToPage({rowIndx:o});var P={rowIndx:o,dataIndx:u};P=n.normalize(P);T=n.getCell(P),n.scrollCell(P,function(){i.onScrollCell(T,b,D,q,_,R),n.focus(P)})}this.onScrollCell(T,b,D,q,_,R)}return x}if(s){var $=n.getEditCell();if($&&$.$cell){var A=$.$cell;A.removeAttr("title");try{A.tooltip("destroy")}catch(t){}}}return{valid:!0}},isValid:function(t){t=t||{};var e=this.that,i=t.allowInvalid,n=t.focusInvalid,r=t.checkEditable;i=null!==i&&i;if(null!==(f=t.dataIndx)){var o=e.columns[f],a=t.rowData||e.getRowData(t),s=t.hasOwnProperty("value"),l=s?t.value:a[f];return(p=this.isValidCell({rowData:a,checkEditable:r,rowIndx:t.rowIndx,value:l,valueDef:s,column:o,allowInvalid:i,focusInvalid:n})).valid||p.warn?{valid:!0}:p}if(null!==t.rowIndx||null!==t.rowIndxPage||null!==t.rowData){a=t.rowData||e.getRowData(t);for(var d=e.colModel,c=[],h=0,u=d.length;h<u;h++){if(!(o=d[h]).hidden){var f,p;l=a[f=o.dataIndx];if(!(p=this.isValidCell({rowData:a,value:l,column:o,rowIndx:t.rowIndx,checkEditable:r,allowInvalid:i,focusInvalid:n})).valid&&!p.warn){if(!i)return p;c.push({rowData:a,dataIndx:f,column:o})}}}return i&&c.length?{cells:c,valid:!1}:{valid:!0}}var g=t.data?t.data:e.options.dataModel.data;c=[];if(!g)return null;for(h=0,u=g.length;h<u;h++){a=g[h];var v=this.isValid({rowData:a,rowIndx:void 0,checkEditable:r,allowInvalid:i,focusInvalid:n}),m=v.cells;if(!1===i){if(!v.valid)return v}else m&&m.length&&(c=c.concat(m))}return i&&c.length?{cells:c,valid:!1}:{valid:!0}}}}(jQuery),function(t){var e={options:{curPage:0,totalPages:0,totalRecords:0,msg:"",rPPOptions:[10,20,30,40,50,100],rPP:20,layout:["first","prev","|","strPage","|","next","last","|","strRpp","|","refresh","|","strDisplay"]},_create:function(){var t=this,e=t.options,i=t.element,n={first:t.initButton(e.strFirstPage,"seek-first","pq-page-first"),"|":"<span class='pq-separator'></span>",next:t.initButton(e.strNextPage,"seek-next","pq-page-next"),prev:t.initButton(e.strPrevPage,"seek-prev","pq-page-prev"),last:t.initButton(e.strLastPage,"seek-end","pq-page-last"),strPage:t.getPageOf(),strRpp:t.getRppOptions(),refresh:t.initButton(e.strRefresh,"refresh","pq-page-refresh"),strDisplay:"<span class='pq-page-display'>"+t.getDisplay()+"</span>"},r=e.layout.map(function(t){return n[t]}).join("");t.listeners={},i.html(r),i.addClass("pq-pager"),t.$first=i.find(".pq-page-first"),t.bindButton(t.$first,function(i){e.curPage>1&&t.onChange(i,1)}),t.$prev=i.find(".pq-page-prev"),t.bindButton(t.$prev,function(i){if(e.curPage>1){var n=e.curPage-1;t.onChange(i,n)}}),t.$next=i.find(".pq-page-next"),t.bindButton(t.$next,function(i){if(e.curPage<e.totalPages){var n=e.curPage+1;t.onChange(i,n)}}),t.$last=i.find(".pq-page-last"),t.bindButton(t.$last,function(i){if(e.curPage!==e.totalPages){var n=e.totalPages;t.onChange(i,n)}}),t.$refresh=i.find(".pq-page-refresh"),t.bindButton(t.$refresh,function(e){if(!1===t._trigger("beforeRefresh",e))return!1;t._trigger("refresh",e)}),t.$display=i.find(".pq-page-display"),t.$select=i.find(".pq-page-select").val(e.rPP).on("change",t.onChangeSelect.bind(t)),t.$totalPages=i.find(".pq-page-total"),t.$curPage=i.find(".pq-page-current"),t.bindCurPage(t.$curPage)},_destroy:function(){this.element.empty().removeClass("pq-pager").enableSelection(),this._trigger("destroy")},_setOption:function(t,e){"curPage"!==t&&"totalPages"!==t||(e*=1),this._super(t,e)},_setOptions:function(e){var i,n=!1,r=this.options;for(i in e){var o=e[i],a=typeof o;"string"===a||"number"===a?o!==r[i]&&(this._setOption(i,o),n=!0):"function"==typeof o.splice||t.isPlainObject(o)?JSON.stringify(o)!==JSON.stringify(r[i])&&(this._setOption(i,o),n=!0):o!==r[i]&&(this._setOption(i,o),n=!0)}return n&&this._refresh(),this}};t.widget("paramquery.pqPager",e),pq.pager=function(e,i){var n=t(e).pqPager(i);return n.data("paramqueryPqPager")||n.data("paramquery-pqPager")};var i=t.paramquery,n=i.pqPager;n.regional={},n.defaults=n.prototype.options,t.extend(n.prototype,{bindButton:function(e,i){e.bind("click keydown",function(e){if("keydown"!==e.type||e.keyCode===t.ui.keyCode.ENTER)return i.call(this,e)})},bindCurPage:function(e){var i=this,n=this.options;e.bind("keydown",function(e){e.keyCode===t.ui.keyCode.ENTER&&t(this).trigger("change")}).bind("change",function(e){var r=t(this),o=r.val();return isNaN(o)||o<1?(r.val(n.curPage),!1):(o=parseInt(o))!==n.curPage?o>n.totalPages?(r.val(n.curPage),!1):!1===i.onChange(e,o)?(r.val(n.curPage),!1):void 0:void 0})},initButton:function(t,e,i){return"<span class='pq-ui-button ui-widget-header "+i+"' tabindex='0' title='"+t+"'><span class='ui-icon ui-icon-"+e+"'></span></span>"},onChange:function(t,e){var i={curPage:e};if(!1===this._trigger("beforeChange",t,i))return!1;this.options.curPage=e,this._trigger("change",t,i)},onChangeSelect:function(e){var i=t(e.target),n=1*i.val(),r={rPP:n};if(!1===this._trigger("beforeChange",e,r))return i.val(this.options.rPP),!1;this.options.rPP=n,this._trigger("change",e,r)},refresh:function(){this._destroy(),this._create()},_refresh:function(){var t=this.options,e=t.curPage>=t.totalPages;this.setDisable(this.$next,e),this.setDisable(this.$last,e),e=t.curPage<=1,this.setDisable(this.$first,e),this.setDisable(this.$prev,e),this.$totalPages.text(t.totalPages),this.$curPage.val(t.curPage),this.$select.val(t.rPP),this.$display.html(this.getDisplay()),this._trigger("refreshView")},getDisplay:function(){var t=this.options;if(t.totalRecords>0){var e=t.rPP,i=t.strDisplay||"",n=t.curPage,r=t.totalRecords,o=(n-1)*e,a=n*e;a>r&&(a=r),i=(i=(i=i.replace("{0}",o+1)).replace("{1}",a)).replace("{2}",r)}else i="";return i},getPageOf:function(){var t=this.options;return"<span>"+(t.strPage||"").replace("{0}","<input type='text' value='"+t.curPage+"' tabindex='0' class='pq-page-current ui-corner-all' />").replace("{1}","<span class='pq-page-total'>"+t.totalPages+"</span>")+"</span>"},getRppOptions:function(){var t=this.options,e=t.strRpp||"";if(e){var i,n,r=t.rPPOptions,o=["<select class='ui-corner-all pq-page-select' >"];if(-1!==e.indexOf("{0}")){for(var a=0,s=r.length;a<s;a++)n=r[a],o.push('<option value="',n,'">',n,"</option>");o.push("</select>"),i=o.join(""),e=e.replace("{0}",i)+"</span>"}}return"<span class='pq-page-rppoptions'>"+e+"</span>"},getInstance:function(){return{pager:this}},_trigger:i._trigger,on:i.on,one:i.one,off:i.off,setDisable:function(t,e){t[e?"addClass":"removeClass"]("disabled").css("pointer-events",e?"none":"").attr("tabindex",e?"":"0")}})}(jQuery),function(t){var e=function(){};e.prototype={belongs:function(t){if(t.target===this.that.element[0])return!0},setTimer:function(t,e){clearTimeout(this._timeID),this._timeID=setTimeout(function(){t()},e)}};var i=t.paramquery;i.cClass=e;var n={widgetEventPrefix:"pqgrid",_create:function(){var e=this,n=this.options,r=this.element,o=n.dataModel,a=n.bootstrap,s=a.on,l=n.roundCorners&&!s,d=n.ui,c=n.sortModel;if(t(document).triggerHandler("pqGrid:bootup",{instance:this}),this.BS_on=s,n.collapsible||(n.collapsible={on:!1,collapsed:!1}),n.flexHeight&&(n.height="flex"),n.flexWidth&&(n.width="flex"),o.sortIndx){c.on=n.sortable,c.type=o.sorting;var h=[],u=o.sortIndx,f=o.sortDir;if(t.isArray(u)){for(var p=0;p<u.length;p++){var g=f&&f[p]?f[p]:"up";h.push({dataIndx:u[p],dir:g})}c.single=!1}else{g=f||"up";h.push({dataIndx:u,dir:g}),c.single=!0}c.sorter=h}this.iRefresh=new i.cRefresh(this),this.iKeyNav=new i.cKeyNav(this),this.iValid=new i.cValid(this),this.tables=[],this.$tbl=null,this.iCols=new i.cColModel(this),this.iSort=new i.cSort(this),this._initTypeColumns(),r.on("scroll"+this.eventNamespace,function(){this.scrollLeft=0,this.scrollTop=0}).on("mousedown"+this.eventNamespace,this._mouseDown.bind(this));var v=s?a.grid:d.grid,m=s?"":d.header_o,w=s?"":d.bottom,x=s?a.top:d.top;r.empty().attr("role","grid").addClass("pq-grid pq-theme "+v+" "+(l?" ui-corner-all":"")).html(["<div class='pq-grid-top ",x," ",l?" ui-corner-top":"","'>","<div class='pq-grid-title",l?" ui-corner-top":"","'>&nbsp;</div>","</div>","<div class='pq-grid-center-o'>","<div class='pq-tool-panel' style='display:",n.toolPanel.show?"":"none",";'></div>","<div class='pq-grid-center' >","<div class='pq-header-outer ",m,"'></div>","<div class='pq-body-outer' tabindex='0' ></div>","<div class='pq-summary-outer' ></div>","</div>","<div style='clear:both;'></div>","</div>","<div class='pq-grid-bottom ",w," ",l?" ui-corner-bottom":"","'>","<div class='pq-grid-footer'></div>","</div>"].join("")),this.$bottom=t(".pq-grid-bottom",r),this.$summary=t(".pq-summary-outer",r),this.$toolPanel=r.find(".pq-tool-panel"),this.$top=t("div.pq-grid-top",r),n.showTop||this.$top.css("display","none"),this.$title=t("div.pq-grid-title",r),n.showTitle||this.$title.css("display","none");var y=this.$grid_center=t(".pq-grid-center",r).on("scroll",function(){this.scrollTop=0});this.addTouch();var C=this.$header=t(".pq-header-outer",y).on("scroll",function(){this.scrollTop=0,this.scrollLeft=0});this.iHeader=new i.cHeader(this,C),this.$footer=t(".pq-grid-footer",r);var b=this.$cont=t(".pq-body-outer",y);this.iRenderB=new pq.cRenderBody(e,{$center:y,$b:b,$sum:this.$summary,header:!0,$h:this.$header}),this._trigger("render",null,{dataModel:this.options.dataModel,colModel:this.colModel}),C.on("contextmenu",".pq-grid-col",function(t){if(e.evtBelongs(t))return e._onHeadRightClick(t)}),b.on("click",".pq-grid-cell,.pq-grid-number-cell",function(i){if(!0!==t.data(i.target,e.widgetName+".preventClickEvent"))return e.evtBelongs(i)?e._onClickCell(i):void 0}).on("contextmenu",".pq-grid-cell,.pq-grid-number-cell",function(t){if(e.evtBelongs(t))return e._onRightClick(t)}).on("dblclick",".pq-grid-cell",function(t){if(e.evtBelongs(t))return e._onDblClickCell(t)}),b.on("focusout",function(){e.onblur()}).on("focus",function(t){e.onfocus(t)}).on("mousedown",e._onMouseDown(e)).on("change",e._onChange(e)).on("mouseenter",".pq-grid-cell",e._onCellMouseEnter(e)).on("mouseenter",".pq-grid-row",e._onRowMouseEnter(e)).on("mouseleave",".pq-grid-cell",e._onCellMouseLeave(e)).on("mouseleave",".pq-grid-row",e._onRowMouseLeave(e)).on("keyup",e._onKeyUp(e)),n.selectionModel.native||this.disableSelection(),y.bind("keydown.pq-grid",e._onKeyPressDown(e)),this._refreshTitle(),this.iRows=new i.cRows(this),this.generateLoading(),this._initPager(),this._refreshResizable(),this._refreshDraggable(),this.iResizeColumns=new i.cResizeColumns(this)},addTouch:function(){var e,i,n;"ontouchend"in document&&((n=this.$grid_center[0]).addEventListener("touchstart",function(n){var r=n.target,o=n.changedTouches[0],a=t.Event("mousedown",o);if(t(r).trigger(a),e){if(r&&r===e.target){var s=e.x-o.pageX,l=e.y-o.pageY;Math.sqrt(s*s+l*l)<=12&&(i=e,setTimeout(function(){i=null},500))}}else e={x:o.pageX,y:o.pageY,target:r},setTimeout(function(){e=null},400)},!0),n.addEventListener("touchend",function(e){var n=e.target;i&&n===i.target&&t(n).trigger("dblclick",e)}))},_mouseDown:function(e){var i=this;if(t(e.target).closest(".pq-editor-focus").length)return this._blurEditMode=!0,void window.setTimeout(function(){i._blurEditMode=!1},0)},destroy:function(){for(var e in this._trigger("destroy"),this._super(),t(window).off("resize"+this.eventNamespace),this)delete this[e];this.options=void 0,t.fragments={}},_setOption:function(t,e){var i,n=this.options,r=function(){n[t]=e},o=this.iRenderB,a=this.iRenderSum,s=this.iRenderHead,l=function(t){return t?"addClass":"removeClass"},d=n.dataModel;if("height"===t)r(),this._refreshResizable();else if("width"===t)r(),this._refreshResizable();else if("title"===t)r(),this._refreshTitle();else if("roundCorners"===t){r();var c=l(e);this.element[c]("ui-corner-all"),this.$top[c]("ui-corner-top"),this.$bottom[c]("ui-corner-bottom")}else if("freezeCols"===t)e=parseInt(e),!isNaN(e)&&e>=0&&e<=this.colModel.length-2&&r();else if("freezeRows"===t)e=parseInt(e),!isNaN(e)&&e>=0&&r();else if("resizable"===t)r(),this._refreshResizable();else if("draggable"===t)r(),this._refreshDraggable();else if("dataModel"===t)e.data!==d.data&&d.dataUF&&(d.dataUF.length=0),r();else{if("groupModel"===t)throw"use groupOption() to set groupModel options.";if("treeModel"===t)throw"use treeOption() to set treeModel options.";if("pageModel"===t)r();else if("colModel"===t||"columnTemplate"===t)r(),this.iCols.init();else if("disabled"===t)this._super(t,e),!0===e?this._disable():this._enable();else if("strLoading"===t)r(),this._refreshLoadingString();else if("showTop"===t)r(),this.$top.css("display",e?"":"none");else if("showTitle"===t)r(),this.$title.css("display",e?"":"none");else if("showToolbar"===t){r(),this._toolbar.widget().css("display",e?"":"none")}else"collapsible"===t?(r(),this._createCollapse()):"showBottom"===t?(r(),this.$bottom.css("display",e?"":"none")):"wrap"===t||"hwrap"===t?("wrap"===t?o.$tbl.add(a.$tbl):s.$tbl)[l(!e)]("pq-no-wrap"):"rowBorders"===t?(r(),c=l(e),i="pq-td-border-top",o.$tbl[c](i),a.$tbl[c](i)):"columnBorders"===t?(r(),c=l(e),i="pq-td-border-right",o.$tbl[c](i),a.$tbl[c](i)):r()}return this}};n.options={cancel:"input,textarea,button,select,option,.pq-no-capture,.ui-resizable-handle",trigger:!1,bootstrap:{on:!1,thead:"table table-striped table-condensed table-bordered",tbody:"table table-condensed",grid:"panel panel-default",top:"",btn:"btn btn-default",groupModel:{icon:["glyphicon-triangle-bottom","glyphicon-triangle-right"]},header_active:"active"},ui:{on:!0,grid:"ui-widget ui-widget-content",top:"ui-widget-header",bottom:"ui-widget-header",header_o:"ui-widget-header",header:"ui-state-default",header_active:"ui-state-active"},collapsible:{on:!0,toggle:!0,collapsed:!1,_collapsed:!1,refreshAfterExpand:!0,css:{zIndex:1e3}},colModel:null,columnBorders:!0,dataModel:{data:[],dataUF:[],cache:!1,dataType:"JSON",location:"local",sorting:"local",sortDir:"up",method:"GET"},direction:"",draggable:!1,editable:!0,editModel:{cellBorderWidth:0,pressToEdit:!0,clicksToEdit:2,filterKeys:!0,keyUpDown:!0,reInt:/^([\-]?[1-9][0-9]*|[\-]?[0-9]?)$/,reFloat:/^[\-]?[0-9]*\.?[0-9]*$/,onBlur:"validate",saveKey:t.ui.keyCode.ENTER,onSave:"nextFocus",onTab:"nextFocus",allowInvalid:!1,invalidClass:"pq-cell-red-tr pq-has-tooltip",warnClass:"pq-cell-blue-tr pq-has-tooltip",validate:!0},editor:{select:!1,type:"textbox"},summaryOptions:{number:"avg,max,min,stdev,stdevp,sum",date:"count,max,min",string:"count"},summaryTitle:{avg:"Avg: {0}",count:"Count: {0}",max:"Max: {0}",min:"Min: {0}",stdev:"Stdev: {0}",stdevp:"Stdevp: {0}",sum:"Sum: {0}"},validation:{icon:"ui-icon-alert",cls:"ui-state-error",style:"padding:3px 10px;"},warning:{icon:"ui-icon-info",cls:"",style:"padding:3px 10px;"},freezeCols:0,freezeRows:0,freezeBorders:!0,calcDataIndxFromColIndx:!0,height:400,hoverMode:"null",maxColWidth:2e3,minColWidth:50,minWidth:100,menuUI:{tabs:["hideCols","filter"],buttons:["clear","ok"],gridOptions:{autoRow:!1,copyModel:{render:!0},editable:function(t){return!t.rowData.pq_disabled},fillHandle:"",filterModel:{header:!0,on:!0},hoverMode:"row",hwrap:!1,rowBorders:!1,rowHt:22,rowHtHead:23,scrollModel:{autoFit:!0},showTop:!1,height:300,wrap:!1}},numberCell:{width:30,title:"",resizable:!0,minWidth:30,maxWidth:100,show:!0},pageModel:{curPage:1,totalPages:0,rPP:10,rPPOptions:[10,20,50,100]},resizable:!1,roundCorners:!0,rowBorders:!0,autoRow:!0,scrollModel:{autoFit:!1},selectionModel:{type:"cell",onTab:"nextFocus",row:!0,mode:"block"},showBottom:!0,showHeader:!0,showTitle:!0,showToolbar:!0,showTop:!0,sortable:!0,sql:!1,stripeRows:!0,title:"&nbsp;",treeModel:null,width:"auto",wrap:!0,hwrap:!0},t.widget("paramquery._pqGrid",n);var r=i._pqGrid.prototype;function o(t){return"<span class='btn btn-xs glyphicon glyphicon-"+t+"' ></span>"}function a(t){return"<span class='ui-widget-header pq-ui-button'><span class='ui-icon ui-icon-"+t+"'></span></span>"}r.refreshCM=function(t,e){t&&(this.options.colModel=t),this.iCols.init(e)},r.evtBelongs=function(e){return t(e.target).closest(".pq-grid")[0]===this.element[0]},r.readCell=function(t,e,i,n,r){if(!i||!1!==i.isRootCell(n,r,"o"))return t[e.dataIndx]},r.saveCell=function(t,e,i){t[e.dataIndx]=i},r._destroyResizable=function(){var t=this.element,e=t.data();(e.resizable||e.uiResizable||e["ui-resizable"])&&t.resizable("destroy")},r._disable=function(){null===this.$disable&&(this.$disable=t("<div class='pq-grid-disable'></div>").css("opacity",.2).appendTo(this.element))},r._enable=function(){this.$disable&&(this.element[0].removeChild(this.$disable[0]),this.$disable=null)},r._destroy=function(){this.loading&&this.xhr.abort(),this._destroyResizable(),this._destroyDraggable(),this.element.off(this.eventNamespace),t(window).unbind(this.eventNamespace),t(document).unbind(this.eventNamespace),this.element.empty().css("height","").css("width","").removeClass("pq-grid ui-widget ui-widget-content ui-corner-all").removeData()},r.addColumn=function(t){var e=t.columns||[t.column],i=this.options.colModel.concat(e);this.refreshCM(i),this._trigger("addColumn"),!1!==t.refresh&&this.refresh()},r.deleteColumn=function(t){for(var e=t.colList||[{colIndx:t.colIndx}],i=!1!==t.history,n=this.options.colModel,r=e.length-1;r>=0;r--){var o=e[r],a=o.colIndx,s=n.splice(a,1)[0];o.column=s}this.iCols.init(),i&&(this.iHistory.increment(),e.type="delete",this.iHistory.push({colList:e})),this._trigger("deleteColumn",null,{colList:e}),!1!==t.refresh&&this.refreshView()},r._onKeyUp=function(t){return function(e){t.evtBelongs(e)&&t._trigger("keyUp",e,null)}},r.onKeyPressDown=function(e){if(t(e.target).closest(".pq-header-outer").length)return this._trigger("headerKeyDown",e,null);!1!==this.iKeyNav.bodyKeyPressDown(e)&&this._trigger("keyDown",e,null)},r._onKeyPressDown=function(t){return function(e){t.evtBelongs(e)&&t.onKeyPressDown(e,t)}},r.collapse=function(t){var e=this,i=this.element,n=this.options.collapsible,r=n.$collapse.children("span"),o=function(){i.css("overflow","hidden"),r.addClass("ui-icon-circle-triangle-s").removeClass("ui-icon-circle-triangle-n"),i.hasClass("ui-resizable")&&i.resizable("destroy"),e._toolbar&&e._toolbar.disable(),n.collapsed=!0,n._collapsed=!0,n.animating=!1,e._trigger("collapse")};if(t=t||{},n._collapsed)return!1;n.htCapture=i.height(),!1===t.animate?(i.height(23),o()):(n.animating=!0,i.animate({height:"23px"},function(){o()}))},r.expand=function(t){var e=this,i=this.element,n=this.options.collapsible,r=n.htCapture,o=n.$collapse.children("span"),a=function(){i.css("overflow",""),n._collapsed=!1,n.collapsed=!1,e._refreshResizable(),n.refreshAfterExpand&&e.refresh(),o.addClass("ui-icon-circle-triangle-n").removeClass("ui-icon-circle-triangle-s"),e._toolbar&&e._toolbar.enable(),n.animating=!1,e._trigger("expand")};if(t=t||{},!1===n._collapsed)return!1;!1===t.animate?(i.height(r),a()):(n.animating=!0,i.animate({height:r},function(){a()}))},r._createCollapse=function(){var e=this,i=this.$top,n=this.options,r=this.BS_on,s=n.collapsible;if(!s.$stripe){var l=t(["<div class='pq-slider-icon pq-no-capture'  >","</div>"].join("")).appendTo(i);s.$stripe=l}s.on?s.$collapse||(s.$collapse=t(r?o("collapse-down"):a("circle-triangle-n")).appendTo(s.$stripe).click(function(t){s.collapsed?e.expand():e.collapse()})):s.$collapse&&(s.$collapse.remove(),delete s.$collapse),s.collapsed&&!s._collapsed?e.collapse({animate:!1}):!s.collapsed&&s._collapsed&&e.expand({animate:!1}),s.toggle?s.$toggle||(s.$toggle=t(r?o("fullscreen"):a("arrow-4-diag")).prependTo(s.$stripe).click(function(t){e.toggle()})):s.$toggle&&(s.$toggle.remove(),delete s.$toggle)},r.toggle=function(){var e=this.options,i=e.collapsible,n=this.element,r=this._maxim,o=r?"min":"max",a=t(document.body);if(!1===this._trigger("beforeToggle",null,{state:o}))return!1;if("min"===o){var s=r.eleObj,l=r.docObj;this.option({height:s.height,width:s.width,maxHeight:s.maxHeight,maxWidth:s.maxWidth}),n[0].style.cssText=s.cssText,a[0].style.cssText=l.cssText,t("html").css({overflow:"visible"}),window.scrollTo(l.scrollLeft,l.scrollTop),this._maxim=null}else{s={height:e.height,width:e.width,cssText:n[0].style.cssText,maxHeight:e.maxHeight,maxWidth:e.maxWidth};this.option({height:"100%",width:"100%",maxHeight:null,maxWidth:null}),n.css(t.extend({position:"fixed",left:0,top:0,margin:0},i.css));l={scrollLeft:t(window).scrollLeft(),scrollTop:t(window).scrollTop(),cssText:a[0].style.cssText};a.css({height:0,width:0,overflow:"hidden",position:"static"}),t("html").css({overflow:"hidden"}),window.scrollTo(0,0),this._maxim={eleObj:s,docObj:l}}this._trigger("toggle",null,{state:o}),this._refreshResizable(),this.refresh(),t(window).trigger("resize",{$grid:n,state:o})},r._mousePQUp=function(e){t(document).unbind("mouseup"+this.eventNamespace,this._mousePQUpDelegate),this._trigger("mousePQUp",e,null)},r._onDblClickCell=function(e){var i=t(e.currentTarget),n=this.getCellIndices({$td:i});n.$td=i,!1!==this._trigger("cellDblClick",e,n)&&(this.options.editModel.clicksToEdit>1&&this.isEditable(n)&&this.editCell(n),n.$tr=i.closest(".pq-grid-row"),this._trigger("rowDblClick",e,n))},r.getValueFromDataType=function(e,i,n){if("="===(e+"")[0])return e;var r;if("date"===i)return r=Date.parse(e),isNaN(r)?void 0:n?r:e;if("integer"===i)r=parseInt(e);else{if("float"!==i)return"bool"===i?null===e?e:0===(r=t.trim(e).toLowerCase()).length?null:"true"===r||"yes"===r||"1"===r||"false"!==r&&"no"!==r&&"0"!==r&&Boolean(r):"object"===i?e:null===e?e:t.trim(e);r=parseFloat(e)}return isNaN(r)||null===r?null===e?e:null:r},r.isValid=function(t){return this.iValid.isValid(t)},r.isValidChange=function(t){t=t||{};var e=this.getChanges(),i=e.addList,n=e.updateList.concat(i);return t.data=n,this.isValid(t)},r.isEditableRow=function(t){var e=this.options.editable;return"function"==typeof e?e.call(this,this.normalize(t)):e},r.isEditableCell=function(t){var e,i,n=t.column;if(n||(n=(e=this.normalize(t)).column),null!==(i=n.editable))return"function"==typeof i?(e=e||this.normalize(t),this.callFn(i,e)):i},r.isEditable=function(t){var e=this.isEditableCell(t);return null===e?this.isEditableRow(t):e},r._onMouseDownCont=function(e){var i,n,r=this;r.blurEditor({blurIfFocus:!0}),r._mousePQUpDelegate=function(t){return r._mousePQUp(t)},t(document).bind("mouseup"+r.eventNamespace,r._mousePQUpDelegate),(i=r.pdata)&&i.length||((n=r.$cont[0]).setAttribute("tabindex",0),n.focus())},r._onMouseDown=function(e){return function(i){if((!i.which||1===i.which)&&e.evtBelongs(i)){var n,r=t(i.target),o=r.closest(".pq-grid-cell,.pq-grid-number-cell");if(o.length&&(i.currentTarget=o[0],e._onMouseDownCell(i)),i.isPropagationStopped())return;if((n=r.closest(".pq-grid-row")).length&&(i.currentTarget=n[0],e._onMouseDownRow(i)),i.isPropagationStopped())return;e._onMouseDownCont(i)}}},r._onMouseDownCell=function(e){var i,n=t(e.currentTarget),r=this.getCellIndices({$td:n});null!==r.rowIndx&&((i=this.iMerge.getRootCellO(r.rowIndx,r.colIndx,!0)).$td=n,this._trigger("cellMouseDown",e,i))},r._onMouseDownRow=function(e){var i=t(e.currentTarget),n=this.getRowIndx({$tr:i});n.$tr=i,this._trigger("rowMouseDown",e,n)},r._onCellMouseEnter=function(e){return function(i){if(e.evtBelongs(i)){var n=t(this),r=e.options,o=e.getCellIndices({$td:n});if(null===o.rowIndx||null===o.colIndx)return;if(!1===e._trigger("cellMouseEnter",i,o))return;return"cell"===r.hoverMode&&e.highlightCell(n),!0}}},r._onChange=function(e){var i,n,r;function o(){if(i&&n&&n.target===i.target){var t;for(t in{ctrlKey:0,metaKey:0,shiftKey:0,altKey:0})n[t]=i[t];e._trigger("valChange",n,r),n=i=void 0}}return e.on("cellClickDone",function(t){i=t.originalEvent,o()}),function(i){if(e.evtBelongs(i)){var a=t(i.target),s=a.closest(".pq-grid-cell");s.length&&(r=e.getCellIndices({$td:s}),(r=e.normalize(r)).input=a[0],n=i,o())}}},r._onRowMouseEnter=function(e){return function(i){if(e.evtBelongs(i)){var n=t(this),r=e.options,o=e.getRowIndx({$tr:n}),a=o.rowIndxPage;if(!1===e._trigger("rowMouseEnter",i,o))return;return"row"===r.hoverMode&&e.highlightRow(a),!0}}},r._onCellMouseLeave=function(e){return function(i){if(e.evtBelongs(i)){var n=t(this);"cell"===e.options.hoverMode&&e.unHighlightCell(n)}}},r._onRowMouseLeave=function(e){return function(i){if(e.evtBelongs(i)){var n=t(this),r=e.getRowIndx({$tr:n}),o=r.rowIndxPage;if(!1===e._trigger("rowMouseLeave",i,{$tr:n,rowIndx:r.rowIndx,rowIndxPage:o}))return;"row"===e.options.hoverMode&&e.unHighlightRow(o)}}},r.enableSelection=function(){this.element.removeClass("pq-disable-select").off("selectstart"+this.eventNamespace)},r.disableSelection=function(){this.element.addClass("pq-disable-select").on("selectstart"+this.eventNamespace,function(e){if(e.target){var i=t(e.target);return!!i.is("input,textarea,select")||(!!i.closest(".pq-native-select").length||void e.preventDefault())}})},r._onClickCell=function(e){var i=this.options.editModel,n=t(e.currentTarget),r=this.getCellIndices({$td:n}),o=this.normalize(r),a=o.colIndx;o.$td=n,o.evt=e,!1!==this._trigger("beforeCellClick",e,o)&&(this._trigger("cellClick",e,o),null===a||a<0||(1===i.clicksToEdit&&this.isEditable(o)&&this.editCell(o),o.$tr=n.closest(".pq-grid-row"),this._trigger("rowClick",e,o)))},r._onHeadRightClick=function(e){var i=t(e.currentTarget),n=this.iRenderB.getCellIndx(i[0]),r=n[0],o=n[1],a=this.headerCells,s={rowIndx:r,colIndx:o,column:(a[r]||a[r-1])[o],$th:i,filterRow:!a[r]};this._trigger("headRightClick",e,s)},r._onRightClick=function(e){var i=t(e.currentTarget),n=this.getCellIndices({$td:i});n.$td=i,!1!==this._trigger("cellRightClick",e,n)&&(n.$tr=i.closest(".pq-grid-row"),this._trigger("rowRightClick",e,n))},r.highlightCell=function(t){t.addClass("pq-grid-cell-hover ui-state-hover")},r.unHighlightCell=function(t){t.removeClass("pq-grid-cell-hover ui-state-hover")},r.highlightRow=function(t){if(isNaN(t));else{var e=this.getRow({rowIndxPage:t});e&&e.addClass("pq-grid-row-hover ui-state-hover")}},r.unHighlightRow=function(t){if(isNaN(t));else{var e=this.getRow({rowIndxPage:t});e&&e.removeClass("pq-grid-row-hover ui-state-hover")}},r._getCreateEventData=function(){return{dataModel:this.options.dataModel,data:this.pdata,colModel:this.options.colModel}},r._initPager=function(){var e=this,i=e.options,n=i.pageModel;if(n.type){var r={bootstrap:i.bootstrap,change:function(t,i){e.blurEditor({force:!0});var n=e.options.pageModel;void 0!==i.curPage&&(n.prevPage=n.curPage,n.curPage=i.curPage),void 0!==i.rPP&&(n.rPP=i.rPP),"remote"===n.type?e.remoteRequest({callback:function(){e._onDataAvailable({apply:!0,header:!1})}}):e.refreshView({header:!1,source:"pager"})},refresh:function(t){e.refreshDataAndView()}};r=t.extend(r,n),this.pagerW=pq.pager(n.appendTo?n.appendTo:this.$footer,r).on("destroy",function(){delete e.pagerW})}},r.generateLoading=function(){this.$loading&&this.$loading.remove(),this.$loading=t("<div class='pq-loading'></div>").appendTo(this.element),t(["<div class='pq-loading-bg'></div><div class='pq-loading-mask ui-state-highlight'><div>",this.options.strLoading,"...</div></div>"].join("")).appendTo(this.$loading),this.$loading.find("div.pq-loading-bg").css("opacity",.2)},r._refreshLoadingString=function(){this.$loading.find("div.pq-loading-mask").children("div").html(this.options.strLoading)},r.showLoading=function(){null===this.showLoadingCounter&&(this.showLoadingCounter=0),this.showLoadingCounter++,this.$loading.show()},r.hideLoading=function(){this.showLoadingCounter>0&&this.showLoadingCounter--,this.showLoadingCounter||this.$loading.hide()},r.getTotalRows=function(){var t=this.options,e=t.dataModel,i=e.data||[],n=e.dataUF||[],r=t.pageModel;return"remote"===r.location?r.totalRecords:i.length+n.length},r.refreshDataFromDataModel=function(t){t=t||{};var e,i,n,r,o=this.options,a=o.dataModel,s=o.pageModel,l=a.data,d=s.type,c=this._queueATriggers;for(var h in c){var u=c[h];delete c[h],this._trigger(h,u.evt,u.ui)}if(this._trigger("beforeRefreshData",null,{}),"local"===d)n=s.totalRecords=l.length,s.totalPages=i=Math.ceil(n/s.rPP),s.curPage>i&&(s.curPage=i),i&&!s.curPage&&(s.curPage=1),e=(e=(s.curPage-1)*s.rPP)>=0?e:0,(f=s.curPage*s.rPP)>l.length&&(f=l.length),this.pdata=l.slice(e,f),r=e;else if("remote"===d){var f;s.totalPages=i=Math.ceil(s.totalRecords/s.rPP),s.curPage>i&&(s.curPage=i),i&&!s.curPage&&(s.curPage=1),(f=s.rPP)>l.length&&(f=l.length),this.pdata=l.slice(0,f),r=s.rPP*(s.curPage-1)}else o.backwardCompat?this.pdata=l.slice(0):this.pdata=l;this.riOffset=r>=0?r:0,this._trigger("dataReady",null,{source:t.source}),this._trigger("dataReadyAfter",null,{source:t.source})},r.getQueryStringCRUD=function(){return""},r.remoteRequest=function(e){this.loading&&this.xhr.abort(),e=e||{};var i=this,n="",r="",o=this.options,a=!1,s=this.colModel,l=o.dataModel,d=o.sortModel,c=o.filterModel,h=o.pageModel;if("function"==typeof l.getUrl){var u={colModel:s,dataModel:l,sortModel:d,groupModel:o.groupModel,pageModel:h,filterModel:c},f=l.getUrl.call(this,u);f&&f.url&&(n=f.url),f&&f.data&&(r=f.data)}else if("string"==typeof l.url){n=l.url;var p,g={},v={},m={};if("remote"===d.type){e.initBySort||this.sort({initByRemote:!0});var w=this.iSort.getQueryStringSort();w&&(g={pq_sort:w})}"remote"===h.type&&(m={pq_curpage:h.curPage,pq_rpp:h.rPP}),"local"!==c.type&&(p=this.iFilterData.getQueryStringFilter())&&(a=!0,v={pq_filter:p});var x=l.postData,y=l.postDataOnce;x&&"function"==typeof x&&(x=x.call(this,{colModel:s,dataModel:l})),r=t.extend({pq_datatype:l.dataType},v,m,g,x,y)}n&&(this.loading=!0,this.showLoading(),this.xhr=t.ajax({url:n,dataType:l.dataType,async:null===l.async||l.async,cache:l.cache,contentType:l.contentType,type:l.method,data:r,beforeSend:function(t,e){if("function"==typeof l.beforeSend)return l.beforeSend.call(i,t,e)},success:function(t,n,r){i.onRemoteSuccess(t,n,r,a,e)},error:function(t,e,n){if(i.hideLoading(),i.loading=!1,"function"==typeof l.error)l.error.call(i,t,e,n);else if("abort"!==n)throw"Error : "+n}}))},r.onRemoteSuccess=function(t,e,i,n,r){var o,a=this.options,s=this.colModel,l=a.pageModel,d=a.dataModel;o="function"==typeof d.getData?d.getData.call(this,t,e,i):t,d.data=o.data,"remote"===l.type&&(null!==o.curPage&&(l.curPage=o.curPage),null!==o.totalRecords&&(l.totalRecords=o.totalRecords)),this.hideLoading(),this.loading=!1,this._trigger("load",null,{dataModel:d,colModel:s}),n&&(this._queueATriggers.filter={ui:{}}),r.callback&&r.callback()},r._refreshTitle=function(){this.$title.html(this.options.title)},r._destroyDraggable=function(){var t=this.element,e=t.parent(".pq-wrapper");e.length&&e.data("draggable")&&(e.draggable("destroy"),this.$title.removeClass("pq-draggable pq-no-capture"),t.unwrap(".pq-wrapper"))},r._refreshDraggable=function(){var t=this.options,e=this.element,i=this.$title;t.draggable?(i.addClass("pq-draggable pq-no-capture"),e.parent(".pq-wrapper").length||e.wrap("<div class='pq-wrapper' />"),e.parent(".pq-wrapper").draggable({handle:i})):this._destroyDraggable()},r._refreshResizable=function(){var e=this,i=this.element,n=this.options,r=(n.width+"").indexOf("%")>-1,o=(n.height+"").indexOf("%")>-1,a="auto"===n.width,s="flex"===n.width,l="flex"===n.height;if(!n.resizable||(l||o)&&(s||r||a))this._destroyResizable();else{var d="e,s,se";l||o?d="e":(s||r||a)&&(d="s");var c=!0;if(i.hasClass("ui-resizable"))d===i.resizable("option","handles")?c=!1:this._destroyResizable();c&&i.resizable({helper:"ui-state-default",handles:d,minWidth:n.minWidth,minHeight:n.minHeight?n.minHeight:100,delay:0,start:function(e,i){t(i.helper).css({opacity:.5,background:"#ccc",border:"1px solid steelblue"})},resize:function(t,e){},stop:function(i,r){var o=e.element,a=o[0],s=n.width,l=n.height,d=(s+"").indexOf("%")>-1,c=(l+"").indexOf("%")>-1,h="auto"===s,u="flex"===s,f="flex"===l,p=!1;a.style.width=a.offsetWidth+3+"px",a.style.height=a.offsetHeight+3+"px",c||f||(p=!0,n.height=a.offsetHeight),d||h||u||(p=!0,n.width=a.offsetWidth),e.refresh({soft:!0}),o.css("position","relative"),p&&t(window).trigger("resize")}})}},r.refresh=function(t){this.iRefresh.refresh(t)},r.refreshView=function(t){null!==this.options.editModel.indices&&this.blurEditor({force:!0}),this.refreshDataFromDataModel(t),this.refresh(t)},r._refreshPager=function(){var t=this.options,e=t.pageModel,i=!!e.type,n=e.rPP,r=e.totalRecords;if(i){var o=t.pageModel;this.pagerW||this._initPager(),this.pagerW.option(o),r>n?this.$bottom.css("display",""):t.showBottom||this.$bottom.css("display","none")}else this.pagerW&&this.pagerW.destroy(),t.showBottom?this.$bottom.css("display",""):this.$bottom.css("display","none")},r.getInstance=function(){return{grid:this}},r.refreshDataAndView=function(t){var e=this.options.dataModel;if(this.pdata=[],"remote"===e.location){var i=this;this.remoteRequest({callback:function(){i._onDataAvailable(t)}})}else this._onDataAvailable(t)},r.getColIndx=function(t){var e,i,n=t.dataIndx,r=t.column;if(r)i=!0;else{if(void 0===n)throw"dataIndx / column NA";!0}var o=this.colModel,a=o.length;if(i){for(var s=0;s<a;s++)if(o[s]===r)return s}else if(null!==(e=this.colIndxs[n]))return e;return-1},r.getColumn=function(t){var e=t.dataIndx;if(null===e)throw"dataIndx N/A";return this.columns[e]||this.iGroup.getColsPrimary()[e]},r._generateCellRowOutline=function(){var e=this.options.editModel;if(!this.$div_focus){var i=this.element;e.inline&&(i=this.getCell(e.indices)).css("padding",0).empty(),this.$div_focus=t(["<div class='pq-editor-outer'>","<div class='pq-editor-inner'>","</div>","</div>"].join("")).appendTo(i);var n=t.extend({all:!0},e.indices),r=this.getCell(n);r.css("height",r[0].offsetHeight),r.empty(),this.refreshEditorPos()}},r.refreshEditorPos=function(){},r._removeEditOutline=function(e){if(this.$div_focus){var i=this.$div_focus.find(".pq-editor-focus");if(function(t){t.hasClass("hasDatepicker")&&t.datepicker("hide").datepicker("destroy")}(i),i[0]===document.activeElement){var n=this._blurEditMode;this._blurEditMode=!0,i.blur(),this._blurEditMode=n}this.$div_focus.remove(),delete this.$div_focus;var r=this.options.editModel,o=t.extend({},r.indices);r.indices=null,o.rowData=void 0,this.refreshCell(o)}},r.scrollX=function(t,e){var i=this;return i.iRenderB.scrollX(t,function(){e&&e.call(i)})},r.scrollY=function(t,e){var i=this;return i.iRenderB.scrollY(t,function(){e&&e.call(i)})},r.scrollXY=function(t,e,i){var n=this;return n.iRenderB.scrollXY(t,e,function(){i&&i.call(n)})},r.scrollRow=function(t,e){var i=this;i.iRenderB.scrollRow(i.normalize(t).rowIndxPage,function(){e&&e.call(i)})},r.scrollColumn=function(t,e){var i=this;i.iRenderB.scrollColumn(i.normalize(t).colIndx,function(){e&&e.call(i)})},r.scrollCell=function(t,e){var i=this,n=i.normalize(t);i.iRenderB.scrollCell(n.rowIndxPage,n.colIndx,function(){e&&e.call(i),i._trigger("scrollCell")})},r.blurEditor=function(t){if(this.$div_focus){var e=this.$div_focus.find(".pq-editor-focus");if(!t||!t.blurIfFocus)return e.triggerHandler("blur",t);document.activeElement===e[0]&&e.blur()}},r.Selection=function(){return this.iSelection},r.goToPage=function(t){var e=this.options.pageModel;if("local"===e.type||"remote"===e.type){var i=t.rowIndx,n=e.rPP,r=null===t.page?Math.ceil((i+1)/n):t.page;r!==e.curPage&&(e.curPage=r,"local"===e.type?this.refreshView():this.refreshDataAndView())}},r.setSelection=function(t,e){if(null===t)return this.iSelection.removeAll(),this.iRows.removeAll({all:!0}),!0;var i=this,n=i.pdata,r=function(){null!==a&&!1!==t.focus&&i.focus({rowIndxPage:a,colIndx:null===s?i.getFirstVisibleCI():s}),e&&e.call(i)};n&&n.length||r();var o=(t=this.normalize(t)).rowIndx,a=t.rowIndxPage,s=t.colIndx;(null===o||o<0||s<0||s>=this.colModel.length)&&r(),this.goToPage(t),a=o-this.riOffset,i.scrollRow({rowIndxPage:a},function(){null===s?(i.iRows.add({rowIndx:o}),r()):i.scrollColumn({colIndx:s},function(){i.Range({r1:o,c1:s}).select(),r()})})},r.getColModel=function(){return this.colModel},r.getCMPrimary=function(){return this.iGroup.getCMPrimary()},r.getOCMPrimary=function(){return this.iGroup.getOCMPrimary()},r.saveEditCell=function(e){var i=this.options,n=i.editModel;if(!n.indices)return null;var r,o=t.extend({},n.indices),a=e?e.evt:null,s=this.riOffset,l=o.colIndx,d=o.rowIndxPage,c=d+s,h=this.colModel[l],u=h.dataIndx,f=this.pdata[d],p=i.dataModel;if(null===f)return null;if(null!==d){var g=this.getEditCellData();if(t.isPlainObject(g))for(var v in r={},g)r[v]=f[v];else r=this.readCell(f,h);"<br>"===g&&(g=""),null===r&&""===g&&(g=null);var m={rowIndx:c,rowIndxPage:d,dataIndx:u,column:h,newVal:g,value:g,oldVal:r,rowData:f,dataModel:p};if(!1===this._trigger("cellBeforeSave",a,m))return!1;var w={};return t.isPlainObject(g)?w=g:w[u]=g,!1===this.updateRow({row:w,rowIndx:c,silent:!0,source:"edit",checkEditable:!1})?!1:(this._trigger("cellSave",a,m),!0)}},r._addInvalid=function(t){},r._digestNewRow=function(t,e,i,n,r,o,a,s,l){var d,c,h,u=this.getValueFromDataType,f=this.columns,p=this.colIndxs;for(d in t)if(c=f[d],h=p[d],c){if(o&&!1===this.isEditable({rowIndx:i,rowData:n,colIndx:h,column:c})){delete t[d],e&&delete e[d];continue}var g=c.dataType,v=u(t[d],g),m=void 0!==(m=e?e[d]:void 0)?u(m,g):void 0;if(t[d]=v,a&&c.validations)if("edit"===l&&!1===s){if(!1===(w=this.isValid({focusInvalid:!0,dataIndx:d,rowIndx:i,value:v})).valid&&!w.warn)return!1}else{var w,x="add"===r?t:n;!1===(w=this.iValid.isValidCell({column:c,rowData:x,allowInvalid:s,value:v})).valid&&(!1!==s||w.warn||delete t[d])}if("update"===r&&v===m){delete t[d],delete e[d];continue}}return"update"!==r||(!pq.isEmpty(t)||void 0)},r._digestData=function(t){if(t.rowList)throw"not supported";if(D=t.addList=t.addList||[],t.updateList=t.updateList||[],t.deleteList=t.deleteList||[],D.length&&D[0].rowData)throw"rd in addList";if(!1===this._trigger("beforeValidate",null,t))return!1;var e,i,n,r,o=this.options,a=o.editModel,s=o.dataModel,l=s.data,d=o.colModel,c=o.pageModel,h=o.historyModel,u=d.map(function(t){return t.dataIndx}),f=null===t.validate?a.validate:t.validate,p="remote"===c.type,g=null===t.allowInvalid?a.allowInvalid:t.allowInvalid,v=o.trackModel,m=null===(m=t.track)?null===o.track?v.on:o.track:m,w=null===t.history?h.on:t.history,x=this.iHistory,y=this.iUCData,C=null===t.checkEditable||t.checkEditable,b=null===t.checkEditableAdd?C:t.checkEditableAdd,I=t.source,_=this.iRefresh,q=this.riOffset,D=t.addList,R=t.updateList,M=t.deleteList,T=[],k=[];for(!l&&(l=s.data=[]),n=0,r=R.length;n<r;n++){var E,S=(H=R[n]).newRow,P=H.rowData,$=H.checkEditable,A=H.rowIndx;if(null===$&&($=C),!(F=H.oldRow))throw"oldRow required while update";if(!1===(E=this._digestNewRow(S,F,A,P,"update",$,f,g,I)))return!1;E&&k.push(H)}for(n=0,r=D.length;n<r;n++){var H,F;S=(H=D[n]).newRow,$=H.checkEditable,A=H.rowIndx;if(null===$&&($=b),u.forEach(function(t){S[t]=S[t]}),!1===(E=this._digestNewRow(S,F,A,P,"add",$,f,g,I)))return!1;E&&T.push(H)}return D=t.addList=T,R=t.updateList=k,e=D.length,i=M.length,e||R.length||i?(w&&(x.increment(),x.push(t)),this._digestUpdate(R,y,m),i&&(this._digestDelete(M,y,m,l,c,p,q),_.addRowIndx()),e&&(this._digestAdd(D,y,m,l,c,p,q),_.addRowIndx()),this._trigger("change",null,t),!0):"edit"===I&&null},r._digestUpdate=function(t,e,i){for(var n,r=0,o=t.length,a=this.columns,s=this.saveCell;r<o;r++){var l=t[r],d=l.newRow,c=l.rowData;for(n in i&&e.update({rowData:c,row:d,refresh:!1}),d)s(c,a[n],d[n])}},r._digestAdd=function(t,e,i,n,r,o,a){var s,l=0,d=t.length;for(t.sort(function(t,e){return t.rowIndx-e.rowIndx});l<d;l++){var c=t[l],h=c.newRow,u=c.rowIndx;i&&e.add({rowData:h}),null===u?n.push(h):(s=o?u-a:u,n.splice(s,0,h)),c.rowData=h,o&&r.totalRecords++}},r._digestDelete=function(t,e,i,n,r,o,a){for(var s=0,l=t.length;s<l;s++){var d=(f=t[s]).rowData,c=this.getRowIndx({rowData:d,dataUF:!0}),h=c.uf,u=c.rowIndx;f.uf=h,f.rowIndx=u}for(t.sort(function(t,e){return e.rowIndx-t.rowIndx}),s=0;s<l;s++){var f;d=(f=t[s]).rowData,h=f.uf,u=f.rowIndx;i&&e.delete({rowIndx:u,rowData:d});var p=o?u-a:u;if(h)DM.dataUF.splice(u,1);else{var g=n.splice(p,1);g&&g.length&&o&&r.totalRecords--}}},r.refreshColumn=function(t){var e=this,i=e.normalize(t),n=e.iRenderB;i.skip=!0,n.eachV(function(t,n){i.rowIndxPage=n,e.refreshCell(i)}),e._trigger("refreshColumn",null,i)},r.refreshCell=function(t){var e=this.normalize(t),i=this._focusEle,n=e.rowIndxPage,r=e.colIndx;this.iRenderB.refreshCell(n,r,e.rowData,e.column)&&(i&&i.rowIndxPage===n&&this.focus(),e.skip||this._trigger("refreshCell",null,e))},r.refreshHeaderCell=function(t){var e=this.normalize(t),i=this.headerCells,n=i.length-1,r=i[n];this.iRenderHead.refreshCell(n,e.colIndx,r,e.column)},r.refreshRow=function(t){if(this.pdata){var e,i=this.normalize(t),n=i.rowIndx,r=i.rowIndxPage,o=i.rowData;return o?(this.iRenderB.refreshRow(r),this.refresh({soft:!0}),(e=this._focusEle)&&e.rowIndxPage===r&&this.focus(),this._trigger("refreshRow",null,{rowData:o,rowIndx:n,rowIndxPage:r}),!0):null}},r.quitEditMode=function(t){if(!this._quitEditMode){var e=!1,i=!1,n=!1,r=this.options.editModel,o=r.indices,a=void 0;this._quitEditMode=!0,t&&(e=t.old,i=t.silent,n=t.fireOnly,a=t.evt),o&&(i||e||this._trigger("editorEnd",a,o),n||(this._removeEditOutline(t),r.indices=null)),this._quitEditMode=null}},r.getViewPortRowsIndx=function(){return{beginIndx:this.initV,endIndx:this.finalV}},r.getViewPortIndx=function(){var t=this.iRenderB;return{initV:t.initV,finalV:t.finalV,initH:t.initH,finalH:t.finalH}},r.getRIOffset=function(){return this.riOffset},r.getEditCell=function(){var t=this.options.editModel;if(t.indices){var e=this.getCell(t.indices),i=this.$div_focus.children(".pq-editor-inner"),n=i.find(".pq-editor-focus");return{$td:e,$cell:i,$editor:n}}return{}},r.editCell=function(t){var e,i,n=this,r=n.normalize(t),o=n.iMerge,a=r.rowIndx,s=r.colIndx;if(o.ismergedCell(a,s)&&((e=o.getRootCellO(a,s)).rowIndx!==r.rowIndx||e.colIndx!==r.colIndx))return!1;n.scrollCell(r,function(){if((i=n.getCell(r))&&i.length)return n._editCell(r)})},r.getFirstEditableColIndx=function(t){if(null===t.rowIndx)throw"rowIndx NA";for(var e=this.colModel,i=0;i<e.length;i++)if(!e[i].hidden&&(t.colIndx=i,this.isEditable(t)))return i;return-1},r.editFirstCellInRow=function(t){var e=this.normalize(t).rowIndx,i=this.getFirstEditableColIndx({rowIndx:e});-1!==i&&this.editCell({rowIndx:e,colIndx:i})},r._editCell=function(e){var n=this.normalize(e),r=this,o=n.evt,a=n.rowIndxPage,s=n.colIndx,l=r.pdata;if(!l||a>=l.length)return!1;r=this;var d,c=this.options,h=c.editModel,u=l[a],f=n.rowIndx,p=this.colModel[s],g=p.dataIndx,v=r.readCell(u,p),m={rowIndx:f,rowIndxPage:a,cellData:v,rowData:u,dataIndx:g,colIndx:s,column:p},w=typeof(d=p.editor);if(void 0===(d="function"===w||"string"===w?this.callFn(d,m):d)&&"function"==typeof c.geditor&&(d=c.geditor.call(this,m)),!1!==d){d&&d.getData&&(h._getData=d.getData);var x=c.editor,y=d?t.extend({},x,d):x,C=!1;if(h.indices){var b=h.indices;if(b.rowIndxPage===a&&b.colIndx===s)return this.refreshEditorPos(),(U=this.$div_focus.find(".pq-editor-focus"))[0].focus(),document.activeElement!==U[0]&&window.setTimeout(function(){U.focus()},0),!1;if(!1===this.blurEditor({evt:o}))return!1;this.quitEditMode({evt:o})}h.indices={rowIndxPage:a,rowIndx:f,colIndx:s,column:p,dataIndx:g},this._generateCellRowOutline();var I=this.$div_focus.children(".pq-editor-inner");I.addClass("pq-align-"+(p.align||"left")),m.$cell=I;var _,q,D,R=y.type,M=null===n.select?y.select:n.select,T=y.init,k=y.valueIndx,E=y.dataMap,S=(S=y.mapIndices)||{},P="pq-editor-focus "+(q="function"==typeof(q=y.cls||"")?q.call(this,m):q),$=P+" pq-cell-editor ",A="function"==typeof(A=y.attr||"")?A.call(this,m):A,H=(D="function"==typeof(D=y.style||"")?D.call(this,m):D)?"style='"+D+"'":"",F=H,O=H;if(m.cls=P,m.attr=A,"function"==typeof R&&(_=R.call(this,m))&&(R=_),x._type=R,"checkbox"===R){var V=y.subtype;_="<input "+(v?"checked='checked'":"")+" class='"+$+"' "+A+" "+O+" type=checkbox name='"+g+"' />",I.html(_);var L=I.children("input");"triple"===V&&(L.pqval({val:v}),I.click(function(e){t(this).children("input").pqval({incr:!0})}))}else if("textarea"===R||"select"===R||"textbox"===R){if("textarea"===R)_="<textarea class='"+$+"' "+A+" "+F+" name='"+g+"' ></textarea>";else if("select"===R){var N=y.options||[];N.constructor!==Array&&(N=r.callFn(N,m));var B=[A," class='",$,"' ",F," name='",g,"'"].join("");_=i.select({options:N,attr:B,prepend:y.prepend,labelIndx:y.labelIndx,valueIndx:k,groupIndx:y.groupIndx,dataMap:E})}else _="<input class='"+$+"' "+A+" "+F+" type=text name='"+g+"' />";t(_).appendTo(I).val("select"===R&&null!==k&&(S[k]||this.columns[k])?S[k]?u[S[k]]:u[k]:v)}else R&&"contenteditable"!==R||(_="<div contenteditable='true' tabindx='0' "+H+" "+A+" class='"+$+"'></div>",I.html(_),I.children().html(v),C=!0);T&&(m.$editor=I.children(".pq-editor-focus"),this.callFn(T,m));var U=I.children(".pq-editor-focus"),z=h.filterKeys,j=p.editModel;j&&void 0!==j.filterKeys&&(z=j.filterKeys);var W={$cell:I,$editor:U,$td:r.getCell(h.indices),dataIndx:g,column:p,colIndx:s,rowIndx:f,rowIndxPage:a,rowData:u};if(h.indices=W,U.data({FK:z}).on("click",function(e){t(this).focus(),r._trigger("editorClick",null,W)}).on("keydown",function(t){r.iKeyNav.keyDownInEdit(t)}).on("keypress",function(t){return r.iKeyNav.keyPressInEdit(t,{FK:z})}).on("keyup",function(t){return r.iKeyNav.keyUpInEdit(t,{FK:z})}).on("blur",function(e,i){var n=r.options.editModel,o=n.onBlur,a="save"===o,s="validate"===o,l=n.cancelBlurCls,d=!!i&&i.force;if(!r._quitEditMode&&!r._blurEditMode&&n.indices){var c=t(e.target);if(!d){if(!1===r._trigger("editorBlur",e,W))return;if(!o)return;if(l&&c.hasClass(l))return;if(c.hasClass("hasDatepicker")){if(c.datepicker("widget").is(":visible"))return!1}else if(c.hasClass("ui-autocomplete-input")){if(c.autocomplete("widget").is(":visible"))return}else if(c.hasClass("ui-multiselect")){if(t(".ui-multiselect-menu").is(":visible")||t(document.activeElement).closest(".ui-multiselect-menu").length)return}else if(c.hasClass("pq-select-button")&&(t(".pq-select-menu").is(":visible")||t(document.activeElement).closest(".pq-select-menu").length))return}r._blurEditMode=!0;var h=d||a||!s;if(!r.saveEditCell({evt:e,silent:h})&&!d&&s)return r._deleteBlurEditMode(),!1;r.quitEditMode({evt:e}),r._deleteBlurEditMode()}}).on("focus",function(t){r._trigger("editorFocus",t,W)}),r._trigger("editorBegin",o,W),U.focus(),window.setTimeout(function(){!1===t(document.activeElement).hasClass("pq-editor-focus")&&(r.element?r.element.find(".pq-editor-focus"):t()).focus()}),M)if(C)try{var G=U[0],K=document.createRange();K.selectNodeContents(G);var Q=window.getSelection();Q.removeAllRanges(),Q.addRange(K)}catch(t){}else U.select()}},r._deleteBlurEditMode=function(t){var e=this;t=t||{};e._blurEditMode&&(t.timer?window.setTimeout(function(){delete e._blurEditMode},0):delete e._blurEditMode)},r.getRow=function(t){var e=this.normalize(t).rowIndxPage;return this.iRenderB.get$Row(e)},r.getCell=function(e){e.vci>=0&&(e.colIndx=this.iCols.getci(e.vci));var i=this.normalize(e),n=i.rowIndxPage,r=i.colIndx,o=this.iRenderB.getCell(n,r);return t(o)},r.getCellHeader=function(e){e.vci>=0&&(e.colIndx=this.iCols.getci(e.vci));var i=this.normalize(e),n=i.colIndx,r=i.ri,o=r>=0?r:this.headerCells.length-1,a=this.iRenderHead.getCell(o,n);return t(a)},r.getCellFilter=function(t){return t.ri=this.headerCells.length,this.getCellHeader(t)},r.getEditorIndices=function(){var e=this.options.editModel.indices;return e?t.extend({},e):null},r.getEditCellData=function(){var e=this.options,i=e.editModel,n=i.indices;if(!n)return null;var r,o=n.colIndx,a=n.rowIndxPage,s=n.rowIndx,l=this.colModel[o],d=l.editor,c=e.editor,h=d?t.extend({},c,d):c,u=h.valueIndx,f=h.labelIndx,p=(p=h.mapIndices)||{},g=l.dataIndx,v=this.$div_focus.children(".pq-editor-inner"),m=i._getData||h.getData;if(i._getData=void 0,m)r=this.callFn(m,{$cell:v,rowData:n.rowData,dataIndx:g,rowIndx:s,rowIndxPage:a,column:l,colIndx:o});else{var w=c._type;if("checkbox"===w){var x=v.children();r="triple"===h.subtype?x.pqval():!!x.is(":checked")}else if("contenteditable"===w)r=v.children().html();else{var y;if((y=v.find('*[name="'+g+'"]'))&&y.length)if("select"===w&&null!==u)if(p[u]||this.columns[u]){(r={})[p[u]?p[u]:u]=y.val(),r[p[f]?p[f]:f]=y.find("option:selected").text();var C=h.dataMap;if(C){var b=y.find("option:selected").data("map");if(b)for(var I=0;I<C.length;I++){var _=C[I];r[p[_]?p[_]:_]=b[_]}}}else r=y.val();else r=y.val();else(y=v.find(".pq-editor-focus"))&&y.length&&(r=y.val())}}return r},r.getCellIndices=function(t){var e,i=t.$td;return null===i||0===i.length||i.closest(".pq-grid")[0]!==this.element[0]?{}:(e=this.iRenderB.getCellIndx(i[0]))?this.iMerge.getRootCellO(e[0]+this.riOffset,e[1],!0):{}},r.getRowsByClass=function(t){var e=this.options,i=e.dataModel,n="remote"===e.pageModel.type,r=this.riOffset,o=i.data,a=[];if(null===o)return a;for(var s=0,l=o.length;s<l;s++){var d=o[s];if(d.pq_rowcls&&(t.rowData=d,this.hasClass(t))){var c={rowData:d},h=n?s+r:s,u=h-r;c.rowIndx=h,c.rowIndxPage=u,a.push(c)}}return a},r.getCellsByClass=function(t){var e=this.options,i=e.dataModel,n="remote"===e.pageModel.type,r=this.riOffset,o=i.data,a=[];if(null===o)return a;for(var s=0,l=o.length;s<l;s++){var d=o[s],c=n?s+r:s,h=d.pq_cellcls;if(h)for(var u in h){var f={rowData:d,rowIndx:c,dataIndx:u,cls:t.cls};if(this.hasClass(f)){var p=this.normalize(f);a.push(p)}}}return a},r.data=function(e){var i=e.dataIndx,n=e.colIndx,r=(i=null!==n?this.colModel[n].dataIndx:i,e.data),o=null===r||"string"==typeof r,a=e.rowData||this.getRowData(e);if(!a)return{data:null};if(null===i){var s=a.pq_rowdata;if(o)return null!==s&&(c=null===r?s:s[r]),{data:c};var l=t.extend(!0,a.pq_rowdata,r);a.pq_rowdata=l}else{var d=a.pq_celldata;if(o){var c;if(null!==d){var h=d[i];c=null===r||null===h?h:h[r]}return{data:c}}d||(a.pq_celldata={});l=t.extend(!0,a.pq_celldata[i],r);a.pq_celldata[i]=l}},r.attr=function(e){var i=e.rowIndx,n=e.dataIndx,r=e.colIndx,o=(n=null!==r?this.colModel[r].dataIndx:n,e.attr),a=null===o||"string"==typeof o,s=this.riOffset,l=e.refresh,d=e.rowData||this.getRowData(e);if(!d)return{attr:null};if(a||!1===l||null!==i||(i=this.getRowIndx({rowData:d}).rowIndx),null===n){var c=d.pq_rowattr;if(a)return null!==c&&(g=null===o?c:c[o]),{attr:g};var h=t.extend(!0,d.pq_rowattr,o);if(d.pq_rowattr=h,!1!==l&&null!==i){var u=this.getRow({rowIndxPage:i-s});if(u){var f=this.stringifyAttr(h);u.attr(f)}}}else{var p=d.pq_cellattr;if(a){var g;if(null!==p){var v=p[n];g=null===o||null===v?v:v[o]}return{attr:g}}p||(d.pq_cellattr={});h=t.extend(!0,d.pq_cellattr[n],o);if(d.pq_cellattr[n]=h,!1!==l&&null!==i){var m=this.getCell({rowIndxPage:i-s,dataIndx:n});if(m){f=this.stringifyAttr(h);m.attr(f)}}}},r.stringifyAttr=function(t){var e={};for(var i in t){var n=t[i];if(n)if("title"===i)n=n.replace(/\"/g,"&quot;"),e[i]=n;else if("style"===i&&"object"==typeof n){var r,o=[];for(var a in n)(r=n[a])&&o.push(a+":"+r);(n=o.join(";")+(o.length?";":""))&&(e[i]=n)}else"object"==typeof n&&(n=JSON.stringify(n)),e[i]=n}return e},r.removeData=function(e){var i,n=e.dataIndx,r=e.colIndx,o=(n=null!==r?this.colModel[r].dataIndx:n,"string"==typeof(i=null===(i=e.data)?[]:i)?i.split(" "):i),a=o.length,s=e.rowData||this.getRowData(e);if(s)if(null===n){var l=s.pq_rowdata;if(l){if(a)for(var d=0;d<a;d++){delete l[o[d]]}a&&!t.isEmptyObject(l)||delete s.pq_rowdata}}else{var c=s.pq_celldata;if(c&&c[n]){var h=c[n];if(a)for(d=0;d<a;d++){delete h[o[d]]}a&&!t.isEmptyObject(h)||delete c[n]}}},r.removeAttr=function(e){var i,n=e.rowIndx,r=e.dataIndx,o=e.colIndx,a=(r=null!==o?this.colModel[o].dataIndx:r,"string"==typeof(i=null===(i=e.attr)?[]:i)?i.split(" "):i),s=a.length,l=n-this.riOffset,d=e.refresh,c=e.rowData||this.getRowData(e);if(c)if(!1!==d&&null===n&&(n=this.getRowIndx({rowData:c}).rowIndx),null===r){var h=c.pq_rowattr;if(h){if(s)for(var u=0;u<s;u++){delete h[f=a[u]]}else for(var f in h)a.push(f);s&&!t.isEmptyObject(h)||delete c.pq_rowattr}if(!1!==d&&null!==n&&a.length){i=a.join(" ");var p=this.getRow({rowIndxPage:l});p&&p.removeAttr(i)}}else{var g=c.pq_cellattr;if(g&&g[r]){var v=g[r];if(s)for(u=0;u<s;u++){delete v[f=a[u]]}else for(var f in v)a.push(f);s&&!t.isEmptyObject(v)||delete g[r]}if(!1!==d&&null!==n&&a.length){i=a.join(" ");var m=this.getCell({rowIndxPage:l,dataIndx:r});m&&m.removeAttr(i)}}},r.normalize=function(t,e){var i,n,r,o={};for(r in t)o[r]=t[r];var a=o.rowIndx,s=o.rowIndxPage,l=o.dataIndx,d=o.colIndx;return null===s&&null===a||(i=this.riOffset,a=null===a?1*s+i:a,s=null===s?1*a-i:s,o.rowIndx=a,o.rowIndxPage=s,o.rowData=o.rowData||e&&e[a]||this.getRowData(o)),null===d&&null===l||(n=this.colModel,l=null===l?n[d]?n[d].dataIndx:void 0:l,d=null===d?this.colIndxs[l]:d,o.column=n[d],o.colIndx=d,o.dataIndx=l),o},r.normalizeList=function(t){var e=this,i=e.get_p_data();return t.map(function(t){return e.normalize(t,i)})},r.addClass=function(t){var e,i=this.normalize(t),n=i.rowIndxPage,r=i.dataIndx,o=pq.arrayUnique,a=i.cls,s=i.refresh,l=i.rowData;if(l)if(!1!==s&&null===n&&(n=this.getRowIndx({rowData:l}).rowIndxPage),null===r){var d=l.pq_rowcls;if(e=o((e=d?d+" "+a:a).split(/\s+/)).join(" "),l.pq_rowcls=e,!1!==s&&null!==n&&this.SelectRow().inViewRow(n)){var c=this.getRow({rowIndxPage:n});c&&c.addClass(a)}}else{var h=[];"function"!=typeof r.push?h.push(r):h=r;var u=l.pq_cellcls;u||(u=l.pq_cellcls={});for(var f=0,p=h.length;f<p;f++){var g=u[r=h[f]];if(e=o((e=g?g+" "+a:a).split(/\s+/)).join(" "),u[r]=e,!1!==s&&null!==n&&this.SelectRow().inViewRow(n)){var v=this.getCell({rowIndxPage:n,dataIndx:r});v&&v.addClass(a)}}}},r.removeClass=function(t){var e=this.normalize(t),i=e.rowIndx,n=e.rowData,r=e.dataIndx,o=e.cls,a=e.refresh;if(n){var s=n.pq_cellcls,l=n.pq_rowcls;if(!1!==a&&null===i&&(i=this.getRowIndx({rowData:n}).rowIndx),null===r){if(l&&(n.pq_rowcls=this._removeClass(l,o),null!==i&&!1!==a)){var d=this.getRow({rowIndx:i});d&&d.removeClass(o)}}else if(s){var c=[];"function"!=typeof r.push?c.push(r):c=r;for(var h=0,u=c.length;h<u;h++){var f=s[r=c[h]];if(f&&(n.pq_cellcls[r]=this._removeClass(f,o),null!==i&&!1!==a)){var p=this.getCell({rowIndx:i,dataIndx:r});p&&p.removeClass(o)}}}}},r.hasClass=function(t){var e,i=t.dataIndx,n=t.cls,r=this.getRowData(t),o=new RegExp("\\b"+n+"\\b");if(r){if(null===i)return!(!(e=r.pq_rowcls)||!o.test(e));var a=r.pq_cellcls;return!!(a&&a[i]&&o.test(a[i]))}return null},r._removeClass=function(t,e){if(t&&e){for(var i=t.split(/\s+/),n=e.split(/\s+/),r=[],o=0,a=i.length;o<a;o++){for(var s=i[o],l=!1,d=0,c=n.length;d<c;d++){if(s===n[d]){l=!0;break}}l||r.push(s)}return r.length>1?r.join(" "):1===r.length?r[0]:null}},r.getRowIndx=function(t){var e,i,n=t.$tr,r=t.rowData,o=this.riOffset;if(r){if(null!==(i=r.pq_ri))return{rowData:r,rowIndx:i,rowIndxPage:i-o};var a=this.get_p_data(),s=!1,l=t.dataUF?this.options.dataModel.dataUF:null,d=!1;if(a)for(var c=0,h=a.length;c<h;c++)if(a[c]===r){d=!0;break}if(!d&&l){s=!0;for(c=0,h=l.length;c<h;c++)if(l[c]===r){d=!0;break}}return d?(e=c-o,{rowIndxPage:s?void 0:e,uf:s,rowIndx:c,rowData:r}):{}}return null===n||0===n.length?{}:null===(e=this.iRenderB.getRowIndx(n[0])[0])?{}:{rowIndxPage:e,rowIndx:e+o}},r.search=function(t){for(var e=this.options,i=t.row,n=t.first,r=e.dataModel,o=e.pageModel.type,a=[],s=this.riOffset,l="remote"===o,d=r.data,c=0,h=d.length;c<h;c++){var u=d[c],f=!0;for(var p in i)i[p]!==u[p]&&(f=!1);if(f){var g=l?c+s:c,v=this.normalize({rowIndx:g});if(a.push(v),n)break}}return a},r.getFirstVisibleRIP=function(t){for(var e=this.pdata,i=t?this.iRenderB.initV:0,n=e.length;i<n;i++)if(!e[i].pq_hidden)return i},r.getLastVisibleRIP=function(){for(var t=this.pdata,e=t.length-1;e>=0;e--)if(!t[e].pq_hidden)return e;return null},r.getFirstVisibleCI=function(t){return this.iCols.getFirstVisibleCI()},r.getLastVisibleCI=function(){return this.iCols.getLastVisibleCI()},r.getNextVisibleCI=function(t){return this.iCols.getNextVisibleCI(t)},r.getPrevVisibleCI=function(t){return this.iCols.getPrevVisibleCI(t)},r.calcWidthCols=function(t,e,i){var n=0,r=this.options.numberCell,o=this.colModel;if(-1===t&&(r.show&&(n+=i?1*r.width:r.outerWidth),t=0),i)for(var a=t;a<e;a++){if((s=o[a])&&!s.hidden){if(!s._width)throw"assert failed";n+=s._width+0}}else for(a=t;a<e;a++){var s;(s=o[a])&&!s.hidden&&(n+=s.outerWidth)}return n}}(jQuery),function(t){(t.paramquery.cKeyNav=function(t){this.that=t}).prototype={bodyKeyPressDown:function(e){var i,n=this,r=n.that,o=r.riOffset,a=r.options,s=a.formulasModel,l=r.iMerge,d=r._focusEle,c=r.colModel,h=a.selectionModel,u=a.editModel,f=document.activeElement,p=pq.isCtrl(e),g=t.ui.keyCode,v=e.keyCode;if(u.indices)r.$div_focus.find(".pq-cell-focus").focus();else{if((i=t(e.target)).hasClass("pq-grid-cell"))d=r.getCellIndices({$td:i});else if("pq-grid-excel"!==f.id&&"pq-body-outer"!==f.className)return;if(v===g.SPACE&&i[0]===r.$cont[0])return!1;var m,w,x=r.normalize(d),y=x.rowIndxPage,C=x.rowIndx,b=x.colIndx,I=r.pdata,_=x,q=!0;if(null!==C&&null!==b&&null!==x.rowData){if(l.ismergedCell(C,b)&&(y=(x=_=l.getRootCellO(C,b)).rowIndxPage,C=x.rowIndx,b=x.colIndx,v!==g.PAGE_UP&&v!==g.PAGE_DOWN&&v!==g.HOME&&v!==g.END||(m=l.getData(C,b,"proxy_cell"))&&(I[w=m.rowIndx-o].pq_hidden||(C=(y=w)+o)),c[b].hidden&&(b=r.getNextVisibleCI(b))),!1===r._trigger("beforeCellKeyDown",e,_))return!1;if(r._trigger("cellKeyDown",e,_),v===g.LEFT||v===g.RIGHT||v===g.UP||v===g.DOWN||h.onTab&&v===g.TAB){var D=null;v===g.LEFT||v===g.TAB&&e.shiftKey?D=this.incrIndx(y,b,!1):v===g.RIGHT||v===g.TAB&&!e.shiftKey?D=this.incrIndx(y,b,!0):v===g.UP?D=this.incrRowIndx(y,b,!1):v===g.DOWN&&(D=this.incrRowIndx(y,b,!0)),D&&(C=D.rowIndxPage+o,this.select({rowIndx:C,colIndx:D.colIndx,evt:e}))}else if(v===g.PAGE_DOWN||v===g.PAGE_UP){var R=v===g.PAGE_UP?"pageUp":"pageDown";r.iRenderB[R](y,function(t){C=t+o,n.select({rowIndx:C,colIndx:b,evt:e})})}else if(v===g.HOME)p?C=r.getFirstVisibleRIP()+o:b=r.getFirstVisibleCI(),this.select({rowIndx:C,colIndx:b,evt:e});else if(v===g.END)p?C=r.getLastVisibleRIP()+o:b=r.getLastVisibleCI(),this.select({rowIndx:C,colIndx:b,evt:e});else if(v===g.ENTER){var M=r.getCell(_);if(M&&M.length>0)if(r.isEditable(_))r.editCell(_);else{var T=M.find("button");T.length&&t(T[0]).click()}}else if(p&&"65"===v){var k=r.iSelection;"row"===h.type&&"single"!==h.mode?r.iRows.toggleAll({all:h.all}):"cell"===h.type&&"single"!==h.mode&&k.selectAll({type:"cell",all:h.all})}else u.pressToEdit&&(this.isEditKey(v)||s.on&&187===v)&&!p?46===v?r.clear():(y=_.rowIndxPage,b=_.colIndx,(M=r.getCell(_))&&M.length&&r.isEditable(_)&&r.editCell({rowIndxPage:y,colIndx:b,select:!0}),q=!1):q=!1;q&&e.preventDefault()}}},getPrevVisibleRIP:function(t){for(var e=this.that.pdata,i=t-1;i>=0;i--)if(!e[i].pq_hidden)return i;return t},setDataMergeCell:function(t,e){var i,n=this.that.iMerge;n.ismergedCell(t,e)&&(i=n.getRootCellO(t,e),n.setData(i.rowIndx,i.colIndx,{proxy_cell:{rowIndx:t,colIndx:e}}))},getValText:function(e){var i=e[0].nodeName.toLowerCase(),n="text";return-1!==t.inArray(i,["input","textarea","select"])&&(n="val"),n},getNextVisibleRIP:function(t){for(var e=this.that.pdata,i=t+1,n=e.length;i<n;i++)if(!e[i].pq_hidden)return i;return t},incrEditIndx:function(t,e,i){var n,r=this.that,o=r.colModel,a=o.length,s=r.iMerge,l=r.riOffset,d=r[i?"getLastVisibleRIP":"getFirstVisibleRIP"]();do{var c,h=t+l;if(s.ismergedCell(h,e)){c=s.getRootCell(h,e);var u=s.getData(h,e,"proxy_edit_cell");u&&(t=(h=u.rowIndx)-l),e=i?e+c.o_cc:e-1}else e=i?e+1:e-1;if(i&&e>=a||!i&&e<0){if(t===d)return null;t=this[i?"getNextVisibleRIP":"getPrevVisibleRIP"](t),e=i?0:a-1}h=t+l,s.ismergedCell(h,e)&&(c=s.getRootCellO(h,e),s.setData(c.rowIndx,c.colIndx,{proxy_edit_cell:{rowIndx:h,colIndx:e}}),h=c.rowIndx,e=c.colIndx),n=o[e];var f=r.isEditable({rowIndx:h,colIndx:e}),p="function"==typeof(p=n.editor)?p.call(r,r.normalize({rowIndx:h,colIndx:e})):p;t=h-l}while(n&&(n.hidden||!1===f||!1===p));return{rowIndxPage:t,colIndx:e}},incrIndx:function(t,e,i){var n,r,o,a,s,l=this.that,d=l.iMerge,c=l.pdata,h=l.riOffset,u=l[i?"getLastVisibleRIP":"getFirstVisibleRIP"](),f=l[i?"getLastVisibleCI":"getFirstVisibleCI"](),p=l.colModel,g=p.length;if(null===e)return t===u?null:{rowIndxPage:t=this[i?"getNextVisibleRIP":"getPrevVisibleRIP"](t)};if(e===f)return{rowIndxPage:t,colIndx:e};do{o=t+h,d.ismergedCell(o,e)&&(n=d.getRootCell(o,e),!s&&(r=d.getData(n.o_ri,n.o_ci,"proxy_cell"))&&(c[a=r.rowIndx-h].pq_hidden||(t=a)),c[t].pq_hidden&&(t=d.getRootCellV(o,e).rowIndxPage),!s&&i&&(e=n.o_ci+(n.o_cc?n.o_cc-1:0))),i?e<g-1&&e++:e>0&&e--,s=p[e]}while(s&&s.hidden);return{rowIndxPage:t,colIndx:e}},incrRowIndx:function(t,e,i){var n,r,o=this.that,a=o.riOffset,s=t+a,l=o.iMerge;return l.ismergedCell(s,e)&&(n=l.getRootCell(s,e),r=l.getData(n.o_ri,n.o_ci,"proxy_cell"),i&&(t=n.o_ri-a+n.o_rc-1),e=r?r.colIndx:n.v_ci),{rowIndxPage:t=this[i?"getNextVisibleRIP":"getPrevVisibleRIP"](t),colIndx:e}},isEditKey:function(t){return t>=32&&t<=127||189===t||190===t},keyDownInEdit:function(e){var i=this.that,n=i.options,r=n.editModel.indices;if(r){var o=t(e.target),a=t.ui.keyCode,s=n.editModel,l=(p=t.extend({},r)).rowIndxPage,d=p.colIndx,c=p.column.editModel,h=c?t.extend({},s,c):s,u=this.getValText(o);if(o.data("oldVal",o[u]()),!1===i._trigger("editorKeyDown",e,p))return!1;if(e.keyCode===a.TAB||e.keyCode===h.saveKey){var f=e.keyCode===a.TAB?h.onTab:h.onSave,p={rowIndxPage:l,colIndx:d,incr:!!f,edit:"nextEdit"===f};return this.saveAndMove(p,e)}if(e.keyCode===a.ESCAPE)return i.quitEditMode({evt:e}),i.focus({rowIndxPage:l,colIndx:d}),e.preventDefault(),!1;if(e.keyCode===a.PAGE_UP||e.keyCode===a.PAGE_DOWN)return e.preventDefault(),!1;if(h.keyUpDown&&!e.altKey){if(e.keyCode===a.DOWN)return p=this.incrRowIndx(l,d,!0),this.saveAndMove(p,e);if(e.keyCode===a.UP)return p=this.incrRowIndx(l,d,!1),this.saveAndMove(p,e)}}},keyPressInEdit:function(e,i){var n=this.that,r=n.options.editModel.indices,o=(i||{}).FK,a=r.column,s=t.ui.keyCode,l=["BACKSPACE","LEFT","RIGHT","UP","DOWN","DELETE","HOME","END"].map(function(t){return s[t]}),d=a.dataType;if(t.inArray(e.keyCode,l)>=0)return!0;if(!1===n._trigger("editorKeyPress",e,t.extend({},r)))return!1;if(o&&("float"===d||"integer"===d)){var c=r.$editor.val(),h="float"===d?"0123456789.-=":"0123456789-=",u=e.charCode||e.keyCode,f=String.fromCharCode(u);if("="!==c[0]&&f&&-1===h.indexOf(f))return!1}return!0},keyUpInEdit:function(e,i){var n=this.that,r=n.options,o=(i||{}).FK,a=r.editModel,s=a.indices;n._trigger("editorKeyUp",e,t.extend({},s));var l=s.column.dataType;if(o&&("float"===l||"integer"===l)){var d=t(e.target),c="integer"===l?a.reInt:a.reFloat,h=this.getValText(d),u=d.data("oldVal"),f=d[h]();if(!1===c.test(f)&&"="!==f[0])if(c.test(u))d[h](u);else{var p="float"===l?parseFloat(u):parseInt(u);isNaN(p)?d[h](0):d[h](p)}}},saveAndMove:function(t,e){if(null===t)return e.preventDefault(),!1;var i,n,r=this,o=r.that,a=t.rowIndxPage,s=t.colIndx;return o._blurEditMode=!0,!1!==o.saveEditCell({evt:e})&&o.pdata?(o.quitEditMode(e),t.incr&&(n=r[t.edit?"incrEditIndx":"incrIndx"](a,s,!e.shiftKey),a=n?n.rowIndxPage:a,s=n?n.colIndx:s),o.scrollCell({rowIndxPage:a,colIndx:s},function(){i=a+o.riOffset,r.select({rowIndx:i,colIndx:s,evt:e}),t.edit&&o._editCell({rowIndxPage:a,colIndx:s})}),o._deleteBlurEditMode({timer:!0,msg:"saveAndMove"}),e.preventDefault(),!1):(o.pdata||o.quitEditMode(e),o._deleteBlurEditMode({timer:!0,msg:"saveAndMove saveEditCell"}),e.preventDefault(),!1)},select:function(e){var i=this.that,n=e.rowIndx,r=e.colIndx,o=n-i.riOffset,a=e.evt,s=(this.setDataMergeCell(n,r),i.options),l=i.iSelection,d=s.selectionModel,c=d.type,h="row"===c,u="cell"===c;i.scrollCell({rowIndx:n,colIndx:r},function(){var e=l.address();if(a.shiftKey&&a.keyCode!==t.ui.keyCode.TAB&&d.type&&"single"!==d.mode&&(e.length||h))if(h)i.iRows.extend({rowIndx:n,evt:a});else{var s=e[e.length-1],c=s.firstR,f=s.firstC,p=!1;"column"===s.type?(s.c1=f,s.c2=r,s.r1=s.r2=s.type=void 0):(e={_type:"block",r1:c,r2:n,c1:f,c2:r,firstR:c,firstC:f},p=!0),i.Range(e,p).select()}else h||u&&i.Range({r1:n,c1:r,firstR:n,firstC:r}).select();i.focus({rowIndxPage:o,colIndx:r})})}}}(jQuery),function(t){var e,i;(t.paramquery.cGenerateView=function(t){}).prototype={autoFitCols:function(){var t=this.that,e=t.colModel,i=e.length,n=this.dims,r=t.calcWidthCols(-1,i,!0),o=this.getSBWd(),a=n.wdCenter-o;if(r!==a){for(var s,l=r-a,d=[],c=0;c<i;c++){var h=(p=e[c])._percent,u=(p.resizable,p._resized);if(!p.hidden&&!h&&!u)l<0?(m=p._maxWidth-p._width)&&d.push({availWd:-1*m,colIndx:c}):(m=p._width-p._minWidth)&&d.push({availWd:m,colIndx:c});u&&(s=p,delete p._resized)}d.sort(function(t,e){return t.availWd>e.availWd?1:t.availWd<e.availWd?-1:0});c=0;for(var f=d.length;c<f;c++){var p,g,v=d[c],m=v.availWd,w=v.colIndx,x=Math.round(l/(f-c)),y=(p=e[w])._width;Math.abs(m)>Math.abs(x)?(g=y-x,l-=x):(g=y-m,l-=m),p.width=p._width=g}if(0!==l&&s)(g=s._width-l)>s._maxWidth?g=s._maxWidth:g<s._minWidth&&(g=s._minWidth),s.width=s._width=g}},computeOuterWidths:function(){for(var t=this.that,e=t.options.numberCell,i=t.colModel,n=i.length,r=0;r<n;r++){var o=i[r];o.outerWidth=o._width+0}e.show&&(e.outerWidth=e.width)},numericVal:function(t,e){var i;return i=(t+"").indexOf("%")>-1?parseInt(t)*e/100:parseInt(t),Math.round(i)},refreshColumnWidths:function(t){t=t||{};var e=this.that,i=e.options,n=i.numberCell,r="flex"===i.width,o=e.colModel,a=this.autoFit,s=this.dims.wdCenter,l=o.length,d=i.minColWidth,c=i.maxColWidth,h=0;n.show&&(n.width<n.minWidth&&(n.width=n.minWidth),h=n.outerWidth=n.width);var u=r?null:s-0-h,f=(d=Math.floor(this.numericVal(d,u)),c=Math.ceil(this.numericVal(c,u)),0);if(!r&&u<5||isNaN(u)){if(i.debug)throw"availWidth N/A"}else{delete e.percentColumn;for(var p=0;p<l;p++){var g=o[p];if(!g.hidden){var v=g.width,m=(v+"").indexOf("%")>-1||null,w=g.minWidth,x=g.maxWidth;w=w?this.numericVal(w,u):d;if((x=x?this.numericVal(x,u):c)<w&&(x=w),void 0!==v){var y,C=0;!r&&m?(e.percentColumn=!0,g.resizable=!1,g._percent=!0,(f+=(y=this.numericVal(v,u)-0)-(C=Math.floor(y)))>=1&&(C+=1,f-=1)):v&&(C=1*v),C<w?C=w:C>x&&(C=x),g._width=C}else g._width=w;m||(g.width=g._width),g._minWidth=w,g._maxWidth=r?1e3:x}}!1===r&&!1!==t.refreshWidth&&a&&this.autoFitCols(),this.computeOuterWidths()}},format:(e=t.datepicker,i=pq.formatNumber,function(t,n){if("function"==typeof n)return n(t);if(pq.isDateFormat(n)){if(t===parseInt(t))return pq.formulas.TEXT(t,pq.juiToExcel(n));if(isNaN(Date.parse(t)))return;return e.formatDate(n,new Date(t))}return t===parseFloat(t)?i(t,n):void 0}),renderCell:function(t){var e,i,n,r,o=this.that,a=t.attr||[],s=t.style||[],l=t.Export,d=o.options,c=t.cls||[],h=t.rowData,u=t.column,f=u.dataType,p=t.colIndx,g=u.dataIndx,v=d.freezeCols,m=d.columnBorders;if(h){l||(u.align&&c.push("pq-align-"+u.align),p===v-1&&m&&c.push("pq-last-frozen-col"),u.cls&&c.push(u.cls));var w,x,y="string"==typeof(y=h[g])&&"html"!==f?pq.escapeHtml(y):y,C=u.format||(x=h.pq_format)&&(x=x[g]),b=C?this.format(y,C,f):y;if(t.dataIndx=g,t.cellData=y,t.formatVal=b,(r=u.render)&&(w=o.callFn(r,t))&&"string"!=typeof w&&((e=w.attr)&&a.push(e),(n=w.cls)&&c.push(n),(i=w.style)&&s.push(i),w=w.text),null===w&&(r=u._render)&&(w=r.call(o,t)),w&&"string"!=typeof w&&((e=w.attr)&&a.push(e),(n=w.cls)&&c.push(n),(i=w.style)&&s.push(i),w=w.text),null===w&&(w=b||y),l)return[w,i];var I=h.pq_cellcls;if(I){var _=I[g];_&&c.push(_)}var q=h.pq_cellattr;if(q){var D=q[g];if(D){var R=o.stringifyAttr(D);for(var M in R){var T=R[M];"style"===M?s.push(T):a.push(M+'="'+T+'"')}}}return s=s.length?" style='"+s.join("")+"' ":"",""!==w&&void 0!==w||(w="&nbsp;"),w=pq.newLine(w),["<div class='",c.join(" "),"' ",a.join(" "),s," >",w,"</div>"].join("")}}}}(jQuery),function(t){var e=t.paramquery,i=e._pqGrid.prototype;i.getHeadCell=function(t){var e,i,n,r=this.iRenderHead.getCellIndx(t[0]),o=r[0],a=r[1];return null!==a&&null!==o&&((i=this.headerCells[o])&&(i=i[a]),i&&(n=i.colModel)),n&&n.length&&(e=!0),{col:i||this.colModel[a],ci:a,ri:o,isParent:e}},i.flex=function(t){this.iResizeColumns.flex(t)},e.cHeader=function(t,e){},e.cHeader.prototype={onBeforeRefreshH:function(e,i){return function(){var n=document.activeElement,r=n?n.className:"",o=e.focusUI,a=t(n);o&&(o.nofocus=-1===r.indexOf("pq-grid-col-leaf")||!a.closest(i.element).length)}},onRefreshH:function(t){return function(e){t.setTimer(function(){t.that.options&&t.focus()},100)}},colCollapse:function(t,e){var i=this.that,n={column:t},r=t.collapsible;!1!==i._trigger("beforeColumnCollapse",e,n)&&(r.on=!r.on,!1!==i._trigger("columnCollapse",e,n)&&i.refresh({colModel:!0}))},onHeaderClick:function(e){var i,n,r,o,a=this.that,s=a.iDragColumns;if(a._trigger("headerClick",e),!s||"stop"===s.status){if((o=t(e.target)).is("input,label"))return!0;if((i=o.closest(".pq-grid-col")).length)if(n=(r=a.getHeadCell(i)).col,o.hasClass("pq-col-collapse"))this.colCollapse(n,e);else if(!r.isParent)return this.onHeaderCellClick(n,r.ci,e)}},getTitle:function(t,e){var i=t.title;return"function"==typeof i?i.call(this.that,{column:t,colIndx:e,dataIndx:t.dataIndx}):i},createHeaderCell:function(t,e,i,n,r,o){var a,s=this.that.options,l=this.getSortSpaceSpans(s.sortModel),d=i.collapsible,c=i.halign||i.align,h=i.cls,u=i.colModel,f=this.hasMenuH(s,i),p=null!==(p=this.getTitle(i,e))?p:i.dataIndx;return i.pq_title=p,c&&r.push("pq-align-"+c),h&&r.push(h),r.push(i.clsHead),f&&r.push("pq-has-menu"),u&&u.length?d&&(r.push("pq-collapsible-th"),a=["<span class='pq-col-collapse pq-icon-hover ui-icon ui-icon-",d.on?"plus":"minus","'></span>"].join("")):r.push("pq-grid-col-leaf"),["<div ","pq-col-indx="+e," ","pq-row-indx="+t," ",""," ",n," "," class='",r.join(" "),"' style='",o.join(""),"' >","<div class='pq-td-div'>",a,"<span class='pq-title-span'>",p,"</span>",l,"</div>",f?"<span class='pq-menu-icon'></span>":"","</div>"].join("")},getSortSpaceSpans:function(t){var e=t.space?" pq-space":"";return["<span class='pq-col-sort-icon",e,"'></span>",t.number?"<span class='pq-col-sort-count"+e+"'></span>":""].join("")},hasMenuH:function(t,e){var i=e.colModel;if(i&&i.length)return!1;var n=t.menuIcon,r=e.menuIcon;return n&&!1!==r||!1!==n&&r},onHeaderCellClick:function(e,i,n){var r=this.that,o=r.options,a=o.sortModel,s=e.dataIndx;if(!1!==r._trigger("headerCellClick",n,{column:e,colIndx:i,dataIndx:s}))if(o.selectionModel.column&&-1===n.target.className.indexOf("pq-td-div")){var l={c1:i,firstC:i},d=r.iSelection.address();if(n.shiftKey){var c=d.length;if(c&&"column"===d[c-1].type){var h=d[c-1];h.c1=h.firstC,h.c2=i,h.r1=h.r2=h.type=void 0}l=d}r.Range(l,!1).select(),r.focus({rowIndxPage:r.getFirstVisibleRIP(!0),colIndx:i})}else if(a.on&&(a.wholeCell||t(n.target).hasClass("pq-title-span"))){if(!1===e.sortable)return;r.sort({sorter:[{dataIndx:s,sortIndx:e.sortIndx}],addon:!0,skipCustomSort:pq.isCtrl(n),tempMultiple:a.multiKey&&n[a.multiKey],evt:n})}},refreshHeaderSortIcons:function(){var e=this.that,i=e.options,n=i.bootstrap,r=i.ui,o=e.headerCells.length-1;if(e.$header){var a=e.iSort.getSorter(),s=a.length,l=!1;e.options.sortModel.number&&s>1&&(l=!0);for(var d=0;d<s;d++){var c=a[d],h=c.dataIndx,u=e.getColIndx({dataIndx:h}),f=c.dir;if(u>=0){var p=n.on?n.header_active:r.header_active+" pq-col-sort-"+("up"===f?"asc":"desc"),g=n.on?" glyphicon glyphicon-arrow-"+f:"ui-icon ui-icon-triangle-1-"+("up"===f?"n":"s"),v=t(e.iRenderHead.getCell(o,u));v.addClass(p),v.find(".pq-col-sort-icon").addClass(g),l&&v.find(".pq-col-sort-count").html(d+1)}}}}},e.cResizeColumns=function(e){this.that=e;var i=this;e.$header.mouse(),e.$header.on({mousedown:function(e){if(!e.pq_composed){var n=t(e.target);i.setDraggables(e),e.pq_composed=!0;var r=t.Event("mousedown",e);n.trigger(r)}},dblclick:function(t){i.doubleClick(t)}},".pq-grid-col-resize-handle");var n=e.options.flex;n.on&&n.one&&e.one("ready",function(){i.flex()})},e.cResizeColumns.prototype={doubleClick:function(e){var i=this.that.options,n=i.flex,r=t(e.target),o=parseInt(r.attr("pq-col-indx"));isNaN(o)||n.on&&this.flex(n.all&&!i.scrollModel.autoFit?null:o)},flex:function(t){this.that.iRenderB.flex(t)},setDraggables:function(e){var i,n,r=t(e.target),o=this;r.draggable({axis:"x",helper:function(e,i){var n=t(e.target),r=parseInt(n.attr("pq-col-indx"));return o._setDragLimits(r),o._getDragHelper(e,i),n},start:function(t,e){i=t.clientX,n=parseInt(o.$cl[0].style.left)},drag:function(t,e){var r=t.clientX-i;o.$cl[0].style.left=n+r+"px"},stop:function(t,e){return o.resizeStop(t,e,i)}})},_getDragHelper:function(e){var i=this.that,n=1*i.options.freezeCols,r=t(e.target),o=i.$grid_center,a=i.iRenderHead,s=1*r.attr("pq-col-indx"),l=s<n?0:a.scrollX(),d=o.outerHeight(),c=a.getLeft(s)-l,h=a.getLeft(s+1)-l,u="style='height:"+d+"px;left:";this.$clleft=t("<div class='pq-grid-drag-bar' "+u+c+"px;'></div>").appendTo(o),this.$cl=t("<div class='pq-grid-drag-bar' "+u+h+"px;'></div>").appendTo(o)},_setDragLimits:function(e){if(!(e<0)){var i=this.that,n=i.iRenderHead,r=i.colModel[e],o=n.getLeft(e)+r._minWidth,a=o+r._maxWidth-r._minWidth,s=t(n._resizeDiv(e));s.draggable("instance")&&s.draggable("option","containment",[o,0,a,0])}},resizeStop:function(e,i,n){var r=this.that,o=r.colModel,a=r.options.numberCell;this.$clleft.remove(),this.$cl.remove();var s,l=e.clientX-n,d=1*t(i.helper).attr("pq-col-indx");if(-1===d){s=null;var c=(h=parseInt(a.width))+l;a.width=c}else{s=o[d];var h;c=(h=parseInt(s.width))+l;s.width=c,s._resized=!0}r._trigger("columnResize",e,{colIndx:d,column:s,dataIndx:s?s.dataIndx:null,oldWidth:h,newWidth:s?s.width:a.width}),r.refresh({soft:!0})}},e.cDragColumns=function(e){this.that=e,this.$drag_helper=null;var i=e.options.dragColumns,n=i.topIcon,r=i.bottomIcon;this.status="stop",this.$arrowTop=t("<div class='pq-arrow-down ui-icon "+n+"'></div>").appendTo(e.element),this.$arrowBottom=t("<div class='pq-arrow-up ui-icon "+r+"' ></div>").appendTo(e.element),this.hideArrows(),i&&i.enabled&&e.$header.on("mousedown",".pq-grid-col",this.onColMouseDown(this,e))},e.cDragColumns.prototype={onColMouseDown:function(e,i){return function(n){var r,o,a,s,l=t(this);if(!n.pq_composed){if(t(n.target).is("input,select,textarea"))return;if(a=(o=(r=i.getHeadCell(l)).col)?o.parent:null,!o||o.nodrag||o._nodrag||a&&1===a.colSpan)return;e.setDraggable(n,o,r)&&(n.pq_composed=!0,s=t.Event("mousedown",n),t(n.target).trigger(s))}}},showFeedback:function(t,e){var i=this.that,n=t[0],r=n.offsetParent.offsetParent,o=i.$grid_center[0].offsetTop,a=n.offsetLeft-r.offsetParent.scrollLeft+(e?0:n.offsetWidth)-8,s=o+n.offsetTop-16,l=o+i.$header[0].offsetHeight;this.$arrowTop.css({left:a,top:s,display:""}),this.$arrowBottom.css({left:a,top:l,display:""})},showArrows:function(){this.$arrowTop.show(),this.$arrowBottom.show()},hideArrows:function(){this.$arrowTop.hide(),this.$arrowBottom.hide()},updateDragHelper:function(t){var e=this.that.options.dragColumns,i=e.acceptIcon,n=e.rejectIcon,r=this.$drag_helper;r&&(t?(r.children("span.pq-drag-icon").addClass(i).removeClass(n),r.removeClass("ui-state-error")):(r.children("span.pq-drag-icon").removeClass(i).addClass(n),r.addClass("ui-state-error")))},onStart:function(t,e,i,n){return function(r){if(!1===e._trigger("columnDrag",r.originalEvent,{column:i}))return!1;t.setDroppables(n)}},onDrag:function(e,i){return function(n,r){e.status="drag";var o=t(".pq-drop-hover",i.$header);if(o.length>0){e.showArrows(),e.updateDragHelper(!0);var a=o.width();n.clientX-o.offset().left+t(document).scrollLeft()<a/2?(e.leftDrop=!0,e.showFeedback(o,!0)):(e.leftDrop=!1,e.showFeedback(o,!1))}else{e.hideArrows(),t(".pq-drop-hover",i.$top).length?e.updateDragHelper(!0):e.updateDragHelper()}}},dragHelper:function(e,i,n){var r=i.options.dragColumns.rejectIcon;return function(){e.status="helper",i.$header.find(".pq-grid-col-resize-handle").hide();var o=t("<div class='pq-col-drag-helper ui-widget-content ui-corner-all panel panel-default' ><span class='pq-drag-icon ui-icon "+r+" glyphicon glyphicon-remove'></span>"+n.pq_title+"</div>");return e.$drag_helper=o,o[0]}},_columnIndexOf:function(t,e){for(var i=0,n=t.length;i<n;i++)if(t[i]===e)return i;return-1},setDraggable:function(e,i,n){var r=t(e.currentTarget),o=this,a=o.that;if(!r.hasClass("ui-draggable"))return r.draggable({distance:10,cursorAt:{top:-18,left:-10},zIndex:"1000",appendTo:a.element,revert:"invalid",helper:o.dragHelper(o,a,i),start:o.onStart(o,a,i,n),drag:o.onDrag(o,a),stop:function(){a.element&&(o.status="stop",a.$header.find(".pq-grid-col-resize-handle").show(),o.hideArrows())}}),!0},setDroppables:function(e){var i,n,r,o,a,s,l,d=this.that,c=e.col,h=e.ri,u=e.o_ci,f=u+c.o_colspan,p={hoverClass:"pq-drop-hover ui-state-highlight",accept:".pq-grid-col",tolerance:"pointer",drop:this.onDrop()},g=d.$header.find(":not(.pq-grid-header-search-row)>.pq-grid-col");for(l=g.length;l--;)s=(a=t(g[l])).hasClass("ui-droppable"),o=(i=d.getHeadCell(a)).col,n=i.ri,r=i.ci,o===c||o.nodrop||o._nodrop||h<n&&r>=u&&r<f?s&&a.droppable("destroy"):s||a.droppable(p)},onDrop:function(){var e=this,i=this.that;return function(n,r){if(!e.dropPending){var o=1*r.draggable.attr("pq-col-indx"),a=1*r.draggable.attr("pq-row-indx"),s=t(this),l=1*s.attr("pq-col-indx"),d=1*s.attr("pq-row-indx"),c=e.leftDrop;if(!1!==i._trigger("beforeColumnOrder",null,{colIndxDrag:o,colIndxDrop:l,left:c})){var h=e.moveColumn(o,l,c,a,d);e.dropPending=!0,window.setTimeout(function(){i.iCols.init(),!1!==i._trigger("columnOrder",null,{dataIndx:h.dataIndx,column:h,oldcolIndx:o,colIndx:i.getColIndx({column:h})})&&i.refresh(),e.dropPending=!1})}}}},getRowIndx:function(t,e,i){for(;i&&t[i][e]===t[i-1][e];)i--;return i},moveColumn:function(t,e,i,n,r){var o=this.that,a=o.options.colModel,s=o.headerCells,l=o.depth-1,d=(n=null===n?this.getRowIndx(s,t,l):n,r=null===r?this.getRowIndx(s,e,l):r,s[n][t]),c=s[r][e],h=n?s[n-1][t].colModel:a,u=r?s[r-1][e].colModel:a,f=this._columnIndexOf(h,d),p=i?1:0,g=h.splice(f,1)[0],v=this._columnIndexOf(u,c)+1-p;return u.splice(v,0,g),g}}}(jQuery),function(t){var e=t.paramquery;e.cHeaderSearch=function(t){},e.cHeaderSearch.prototype={_bindFocus:function(){var e=this.that,i=this;function n(n){var r=t(n.target).closest(".pq-grid-hd-search-field").attr("name");if(e.scrollColumn({dataIndx:r})){var o=e.getColIndx({dataIndx:r});i.get$Ele(o,r).focus()}}for(var r=e.$header.find(".pq-grid-header-search-row"),o=0;o<r.length;o++)t(r[o]).on("focusin",n)},_input:function(t,e,i,n,r,o){return["<input ",' value="',e=pq.formatEx(t,e,o),"\" name='",t.dataIndx,"' type=text style='",n,"' class='",i,"' ",r," />"].join("")},_onKeyDown:function(e,i,n){var r,o=this,a=this.that;if(e.keyCode!==t.ui.keyCode.TAB)return!0;var s,l=o.getCellIndx(n.closest(".pq-grid-col")[0])[1],d=a.colModel,c=e.shiftKey;if("textbox2"===((h=d[l]).filterUI||{}).type&&(a.scrollColumn({colIndx:l}),(r=o.getCellEd(l)[1])[0]===n[0]?c||(s=r[1]):c&&(s=r[0]),s))return s.focus(),e.preventDefault(),!1;for(;;){if(c?l--:l++,l<0||l>=d.length)break;var h,u=(h=d[l]).filter;if(!h.hidden&&u){a.scrollColumn({colIndx:l},function(){var i=o.getCellEd(l)[1];if("textbox2"===(h.filterUI||{}).type&&(i=t(c?i[1]:i[0])),i)return i.focus(),e.preventDefault(),!1});break}}},_textarea:function(t,e,i,n,r){return["<textarea name='",t,"' style='"+n+"' class='"+i+"' "+r+" >",e,"</textarea>"].join("")},bindListener:function(e,i,n,r){var o=this.that,a=r.filter,s=pq.filter.getVal(a),l=s[0],d=s[1];pq.fakeEvent(e,i,o.options.filterModel.timeout),e.off(i).on(i,function(i){var a,s,c=r.filterUI,h=c.type,u=c.condition;if("checkbox"===h?a=e.pqval({incr:!0}):"textbox2"===h?(a=t(e[0]).val(),s=t(e[1]).val()):a=e.val(),a=""===a?void 0:pq.deFormat(r,a,u),s=""===s?void 0:pq.deFormat(r,s,u),l!==a||d!==s)return l=a,d=s,(n=pq.getFn(n)).call(o,i,{column:r,dataIndx:r.dataIndx,value:a,value2:s})})},betweenTmpl:function(t,e){return["<div class='pq-from-div'>",t,"</div>","<span class='pq-from-to-center'>-</span>","<div class='pq-to-div'>",e,"</div>"].join("")},createListener:function(t){var e={},i=this.that;return e[t]=function(t,e){var n=e.column;i.filter({rules:[{dataIndx:n.filterIndx||e.dataIndx,condition:n.filter.condition,value:e.value,value2:e.value2}]})},e},getCellEd:function(e){var i=this.data.length-1,n=t(this.getCell(i,e)),r=n.find(".pq-grid-hd-search-field");return[n,r]},onCreateHeader:function(){var t=this;t.that.options.filterModel.header&&t.eachH(function(e){e.filter&&t.postRenderCell(e)})},onHeaderKeyDown:function(e,i){var n=t(e.originalEvent.target);return!n.hasClass("pq-grid-hd-search-field")||this._onKeyDown(e,i,n)},postRenderCell:function(e){var i=e.dataIndx,n=e.filterUI||{},r=e.filter,o=this.that,a=o.colIndxs[i],s=this.getCellEd(a),l=s[0],d=s[1];if(0!==d.length){var c=n.type,h={button:"click",select:"change",checkbox:"change",textbox:"timeout",textbox2:"timeout"},u=pq.filter.getVal(r)[0];"checkbox"===c?d.pqval({val:u}):"select"===c&&(u=u||[],t.isArray(u)||(u=[u]),e.format&&(u=u.slice(0,25).map(function(t){return pq.format(e,t)})),d.val(u.join(", ")));var f=n.init,p=r.listener,g=r.listeners||[p||h[c]];f&&f.find(function(t){return o.callFn(t,{dataIndx:i,column:e,filter:r,filterUI:n,$cell:l,$editor:d})});for(var v=0;v<g.length;v++){var m=g[v],w=typeof m,x={};for(var y in"string"===w?m=this.createListener(m):"function"===w&&(x[h[c]]=m,m=x),m)this.bindListener(d,y,m[y],e)}}},getControlStr:function(t){var e=this.that,i=t.dataIndx,n=t.filter,r=pq.filter.getVal(n),o=r[0],a=r[1],s=r[2],l={column:t,dataIndx:i,condition:s,indx:0},d=t.filterUI=pq.filter.getFilterUI(l,e),c=d.type,h="";"textbox2"===c&&(a=null!==a?a:"");var u="pq-grid-hd-search-field "+(d.cls||""),f=d.style||"",p=d.attr||"";if(c&&c.indexOf("textbox")>=0)o=o||"",u+=" pq-search-txt ui-corner-all",h="textbox2"===c?this.betweenTmpl(this._input(t,o,u+" pq-from",f,p,s),this._input(t,a,u+" pq-to",f,p,s)):this._input(t,o,u,f,p,s);else if("select"===c){h="<input type='text' "+["name='",i,"' class='",u+=" ui-corner-all","' style='",f,"' ",p].join("")+" ><span style='position:absolute;right:0;top:3px;' class='ui-icon ui-icon-arrowthick-1-s'></span>"}else if("checkbox"===c){h=["<input ",null===o||!1===o?"":"checked=checked"," name='",i,"' type=checkbox class='"+u+"' style='"+f+"' "+p+"/>"].join("")}else"string"==typeof c&&(h=c);return h},renderFilterCell:function(t,e,i){var n,r,o=this.that.options.filterModel,a=t.cls,s=t.halign||t.align;return s&&i.push("pq-align-"+s),a&&i.push(a),i.push(t.clsHead),t.filter&&(r=this.getControlStr(t))&&i.push("pq-col-"+e),(n=this.hasMenu(o,t))&&i.push("pq-has-menu"),["<div class='pq-td-div' style='overflow:hidden;'>","",r,"</div>",n?"<span class='pq-filter-icon'></span>":""].join("")},hasMenu:function(t,e){var i=t.menuIcon,n=(e.filter||{}).menuIcon;return i&&!1!==n||!1!==i&&n}}}(jQuery),function(t){var e=t.paramquery.cRefresh=function(e){var i=this;i.vrows=[],i.that=e,e.on("dataReadyDone",function(){i.addRowIndx(!0)}),t(window).on("resize"+e.eventNamespace+" orientationchange"+e.eventNamespace,i.onWindowResize.bind(i))};t.extend(e,{Z:function(){return(window.outerWidth-8)/window.innerWidth},cssZ:function(){return document.body.style.zoom},isFullScreen:function(){return document.fullScreen||document.mozFullScreen||document.webkitIsFullScreen||window.innerHeight===screen.height},isSB:function(){return t(document).height()>t(window).height()}}),t(function(){var i=e.Z,n=e.cssZ,r=i(),o=n();e.isZoom=function(){var t=i(),e=n();if(r!==t||o!==e)return r=t,o=e,!0};var a=e.isSB,s=a();t.paramquery.onResize(document.body,function(){var e=a();e!==s&&(s=e,t(window).trigger("resize",{SB:!0}))})}),t(window).on("resize",function(){e.isZoom&&(e.ISZOOM=e.isZoom())}),e.prototype={addRowIndx:function(t){for(var e,i=this.that,n=i.options.dataModel.dataUF,r=i.get_p_data(),o=r.length;o--;)(e=r[o])&&(e.pq_ri=o);if(t)for(o=n.length;o--;)delete n[o].pq_ri},setGridAndCenterHeightForFlex:function(){var t=this.that;t.element.height(""),t.$grid_center.height(""),t.dims.htGrid=t.element.height()},setGridWidthForFlex:function(){var t=this.that,e=t.options,i=this.maxWidthPixel,n=t.element,r=t.$toolPanel[0].offsetWidth+t.iRenderB.getFlexWidth();e.maxWidth&&r>=this.maxWidthPixel&&(r=i),t._trigger("contWd"),n.width(r+"px"),t.dims.wdGrid=r},_calcOffset:function(t){var e=/(-|\+)([0-9]+)/.exec(t);return e&&3===e.length?parseInt(e[1]+e[2]):0},setMax:function(t){var e=this.that,i=e.element,n=e.options[t];n?(n===parseInt(n)&&(n+="px"),i.css(t,n)):i.css(t,"")},refreshGridWidthAndHeight:function(){var e,i,n=this.that,r=n.options,o=n.dims,a=(r.width+"").indexOf("%")>-1,s=(r.height+"").indexOf("%")>-1,l=(r.maxHeight+"").indexOf("%")>-1,d="flex"===r.height,c=l&&d,h=(r.maxWidth+"").indexOf("%")>-1,u="flex"===r.width,f=h&&u,p=n.element;if(a||s||c||f){var g,v,m=p.parent();if(!m.length)return;m[0]===document.body||"fixed"===p.css("position")?(g=t(window).width(),v=window.innerHeight||t(window).height()):(g=m.width(),v=m.height());var w=this._calcOffset,x=a?w(r.width):0,y=s?w(r.height):0;f?e=parseInt(r.maxWidth)*g/100:a&&(e=parseInt(r.width)*g/100+x),c?i=parseInt(r.maxHeight)*v/100:s&&(i=parseInt(r.height)*v/100+y)}e||(u&&r.maxWidth?h||(e=r.maxWidth):a||(e=r.width)),r.maxWidth&&(this.maxWidthPixel=e),i||(d&&r.maxHeight?l||(i=r.maxHeight):s||(i=r.height)),parseFloat(e)===e?(e=e<r.minWidth?r.minWidth:e,p.css("width",e)):"auto"===e&&p.width(e),parseFloat(i)===i&&(i=i<r.minHeight?r.minHeight:i,p.css("height",i)),o.wdGrid=Math.round(p.width()),o.htGrid=Math.round(p.height())},isReactiveDims:function(){var t=this.that.options,e=t.width,i=t.height,n=t.maxWidth,r=t.maxHeight,o=function(t){return-1!==(t+"").indexOf("%")},a=o(e),s="auto"===e,l=o(i),d=o(n),c=o(r);return a||s||l||d||c},getParentDims:function(){var e,i,n=this.that.element,r=n.parent();return r.length?(r[0]===document.body||"fixed"===n.css("position")?(i=window.innerHeight||t(window).height(),e=t(window).width()):(i=r.height(),e=r.width()),[e,i]):[]},onWindowResize:function(i,n){var r,o,a,s,l,d=this,c=d.that,h=c.dims||{},u=h.htParent,f=h.wdParent,p=c.options,g=c.element;if(!e.isFullScreen()&&!(t.support.touch&&p.editModel.indices&&t(document.activeElement).is(".pq-editor-focus")||n&&(l=n.$grid)&&(l===g||0===g.closest(l).length))){if(s=d.isReactiveDims(),e.ISZOOM)return d.setResizeTimer(function(){d.refresh({soft:!0})});s&&d.setResizeTimer(function(){if(a=d.getParentDims(),o=a[0],(r=a[1])===u&&o===f){if(parseInt(g.width())===parseInt(h.wdGrid))return}else h.htParent=r,h.wdParent=o;d.refresh({soft:!0})})}},setResizeTimer:function(t){var e=this,i=e.that;clearTimeout(e._autoResizeTimeout),e._autoResizeTimeout=window.setTimeout(function(){i.element&&(t?t():e.refreshAfterResize())},i.options.autoSizeInterval||100)},refresh:function(t){t=t||{};var e,i=this.that,n=null===t.header||t.header,r=t.pager,o=!t.soft,a=i.element,s=i.$toolPanel,l=i.dims=i.dims||{htCenter:0,htHead:0,htSum:0,htBody:0,wdCenter:0,htTblSum:0};if(t.colModel&&i.refreshCM(),a[0].offsetWidth){s.css("height","1px"),t.toolbar&&i.refreshToolbar(),(e=i.options).collapsible._collapsed=!1,this.setMax("maxHeight"),this.setMax("maxWidth"),this.refreshGridWidthAndHeight(),o&&!1!==r&&i._refreshPager(),l.htCenter=this.setCenterHeight(),l.wdCenter=l.wdGrid-s[0].offsetWidth,i.iRenderB.init({header:n,soft:t.soft,source:t.source}),"flex"===e.height&&this.setGridAndCenterHeightForFlex(),"flex"===e.width&&this.setGridWidthForFlex();var d=this.getParentDims();l.wdParent=d[0],l.htParent=d[1],o&&i._createCollapse(),e.dataModel.postDataOnce=void 0,i._trigger("refreshFull")}else a.addClass("pq-pending-refresh")},setCenterHeight:function(){var t,e=this.that,i=e.$top,n=e.options;return("flex"!==n.height||n.maxHeight)&&(t=(t=e.dims.htGrid-(n.showTop?i[0].offsetHeight+parseInt(i.css("marginTop")):0)-e.$bottom[0].offsetHeight+1)>=0?t:"",e.$grid_center.height(t)),t}},t(function(){})}(jQuery),function(t){(t.paramquery.cCheckBoxColumn=function(e,i){var n,r,o=this;o.that=e,o.options=e.options,i.cbId?(r=o.colUI=i,n=o.colCB=e.columns[i.cbId]):n=r=o.colCB=o.colUI=i;var a=n.cb=t.extend({},{all:!1,header:!1,select:!1,check:!0,uncheck:!1},n.cb),s=n.dataIndx;r._render=o.cellRender(n,r),e.on("dataAvailable",function(){e.one("dataReady",function(){return o.oneDataReady()})}).on("dataReady",o.onDataReady.bind(o)).on("valChange",o.onCheckBoxChange(o)).on("cellKeyDown",o.onCellKeyDown.bind(o)).on("refreshHeader",o.onRefreshHeader.bind(o)).on("change",o.onChange(o,e,s,a.check,a.uncheck)),a.select&&e.on("rowSelect",o.onRowSelect(o,e)).on("beforeRowSelectDone",o.onBeforeRowSelect(o,e,s,a.check,a.uncheck)),e.on("beforeCheck",o.onBeforeCheck.bind(o))}).prototype=t.extend({cellRender:function(t,e){var i=this;return function(n){var r,o,a,s=n.rowData,l=t.dataIndx,d=t.cb,c=e.renderLabel,h=e.useLabel;if(!(s.pq_gtitle||s.pq_gsummary||n.Export))return r=d.check===s[l]?"checked":"",o=i.isEditable(s,t,n.rowIndx,n.colIndx,l)?"":"disabled",c&&(a=c.call(this,n)),null===a&&(a=t===e?"":n.formatVal||n.cellData),[h?" <label style='width:100%;'>":"","<input type='checkbox' ",r," ",o," />",a,h?"</label>":""].join("")}},checkAll:function(t,e){t=null===t||t;var i=this.that,n=this.colCB.cb.all?i.options.dataModel.data:i.pdata;return this.checkNodes(n,t,e)},checkNodes:function(t,e,i){if(t.length){null===e&&(e=!0);var n=this.that,r=this.colUI.dataIndx,o=this.colCB,a=o.cb,s=e?a.check:a.uncheck,l=o.dataIndx,d=t[0],c=d.pq_ri,h=function(){return n.refreshCell({rowIndx:c,dataIndx:r}),!1},u=t.map(function(t){var e={},i={};return e[l]=t[l],i[l]=s,{rowIndx:t.pq_ri,rowData:t,oldRow:e,newRow:i}}),f={rowIndx:c,rowData:d,dataIndx:r,check:e,rows:u},p={source:"checkbox"};if(!1===n._trigger("beforeCheck",i,f))return h();if(p.updateList=f.rows,p.history=p.track=!a.select&&null,!1===n._digestData(p))return h();a.maxCheck||1!==p.updateList.length?n.refresh({header:!1}):n.refreshRow({rowIndx:c})}},isEditable:function(t,e,i,n,r){var o={rowIndx:i,rowData:t,column:e,colIndx:n,dataIndx:r};return this.that.isEditable(o)},onBeforeRowSelect:function(t,e,i,n,r){return function(o,a){if("checkbox"!==a.source){var s=function(o){for(var a,s,l,d=o.length,c=e.columns[i],h=e.colIndxs[i];d--;)a=(l=o[d]).rowIndx,s=l.rowData,t.isEditable(s,c,a,h,i)?s[i]=s.pq_rowselect?r:n:o.splice(d,1)};s(a.addList),s(a.deleteList)}}},onCellKeyDown:function(e,i){if(i.dataIndx===this.colUI.dataIndx&&(13===e.keyCode||32===e.keyCode))return t(e.originalEvent.target).find("input").click(),!1},onChange:function(t,e,i,n,r){return function(r,o){var a=[],s=[],l=t.colUI.dataIndx,d=function(t,i){t.length&&e._trigger("check",r,{rows:t,dataIndx:l,rowIndx:t[0].rowIndx,rowData:t[0].rowData,check:i})},c=function(t){t.forEach(function(t){var e=t.newRow,r=t.oldRow;e.hasOwnProperty(i)&&(e[i]===n?a.push(t):r&&r[i]===n&&s.push(t))})};t.setValCBox(),c(o.addList),c(o.updateList),t.colCB.cb.select&&e.SelectRow().update({addList:a,deleteList:s,source:"checkbox"}),d(a,!0),d(s,!1)}},onCheckBoxChange:function(t){return function(e,i){if(i.dataIndx===t.colUI.dataIndx)return t.checkNodes([i.rowData],i.input.checked,e)}},onDataReady:function(){this.setValCBox()},oneDataReady:function(){var t,e=this.that.get_p_data(),i=0,n=e.length,r=this.colCB,o=r.cb,a=r.dataIndx;if(null!==a&&e&&o.select)for(;i<n;i++)(t=e[i])&&(t[a]===o.check?t.pq_rowselect=!0:t.pq_rowselect&&(t[a]=o.check))},onRowSelect:function(t,e){return function(i,n){"checkbox"!==n.source&&(n.addList.length||n.deleteList.length)&&(t.setValCBox(),e.refresh({header:!1}))}}},pq.mixin.ChkGrpTree)}(jQuery),function(t){var e=t.paramquery,i={options:{stateColKeys:{width:1,filter:["crules","mode"],hidden:1},stateKeys:{height:1,width:1,freezeRows:1,freezeCols:1,groupModel:["dataIndx","collapsed","grandSummary"],pageModel:["curPage","rPP"],sortModel:["sorter"]},detailModel:{cache:!0,offset:100,expandIcon:"ui-icon-triangle-1-se glyphicon glyphicon-minus",collapseIcon:"ui-icon-triangle-1-e glyphicon glyphicon-plus",height:180},dragColumns:{enabled:!0,acceptIcon:"ui-icon-check glyphicon-ok",rejectIcon:"ui-icon-closethick glyphicon-remove",topIcon:"ui-icon-circle-arrow-s glyphicon glyphicon-circle-arrow-down",bottomIcon:"ui-icon-circle-arrow-n glyphicon glyphicon-circle-arrow-up"},flex:{on:!0,one:!1,all:!0},track:null,mergeModel:{flex:!1},realFocus:!0,sortModel:{on:!0,type:"local",multiKey:"shiftKey",number:!0,single:!0,cancel:!0,sorter:[],useCache:!0,ignoreCase:!1},filterModel:{on:!0,newDI:[],type:"local",mode:"AND",header:!1,timeout:400}},_create:function(){var t=this,i=t.options;t.listeners={},t._queueATriggers={},t.iHistory=new e.cHistory(t),t.iGroup=new e.cGroup(t),t.iMerge=new e.cMerge(t),t.iFilterData=new e.cFilterData(t),t.iSelection=new n.Selection(t),t.iHeaderSearch=new e.cHeaderSearch(t),t.iUCData=new e.cUCData(t),t.iMouseSelection=new e.cMouseSelection(t),t._super(),new e.cFormula(t),t.iDragColumns=new e.cDragColumns(t),t.refreshToolbar(),"remote"===i.dataModel.location&&t.refresh(),t.on("dataAvailable",function(){t.one("refreshDone",function(){t._trigger("ready"),setTimeout(function(){t.element&&t._trigger("complete")},0)})}),t.refreshDataAndView({header:!0})}};t.widget("paramquery.pqGrid",e._pqGrid,i),t.widget.extend=function(){var e,i,n=Array.prototype.shift,r=t.isPlainObject,o=t.isArray,a=t.widget.extend,s=n.apply(arguments);"boolean"==typeof s&&(e=s,s=n.apply(arguments));var l,d,c,h=arguments,u=0,f=h.length;for(null===e&&(e=f>1);u<f;u++)for(d in l=h[u])void 0!==(c=l[d])&&(i=!(u>0),r(c)?(s[d]=s[d]||{},a(i,s[d],c)):o(c)?s[d]=e&&i?c.slice():c:s[d]=c);return s};var n=window.pq=window.pq||{};n.grid=function(e,i){var n=t(e).pqGrid(i);return n.data("paramqueryPqGrid")||n.data("paramquery-pqGrid")},n.grid.render={},e.pqGrid.regional={};var r=e.pqGrid.prototype;function o(t,e,i){for(var n=0,r=t.length;n<r;n++){for(var o,a=t[n],s={},l=0,d=e.length;l<d;l++)s[o=e[l]]=a[o];i.push(s)}}e.pqGrid.defaults=r.options,r.focus=function(e){var i,n,r,o,a,s,l,d,c=e||{},h=this.options,u=c.$td,f=document.activeElement,p=this.$cont,g=p[0],v=c.rowIndxPage,m=c.colIndx;if(u)null!==v&&null!==m||(v=(r=this.getCellIndices({$td:u})).rowIndxPage,m=r.colIndx);else{if(null===v||null===m){if(n=this._focusEle,f&&f!==document.body&&"pq-grid-excel"!==f.id&&"pq-body-outer"!==f.className)return void(o=!0);n?(v=n.rowIndxPage,m=n.colIndx):o=!0}null!==v&&(l=this.iMerge,s=v+this.riOffset,l.ismergedCell(s,m)&&(v=(d=l.getRootCellO(s,m)).rowIndxPage,m=d.colIndx),u=this.getCell({rowIndxPage:v,colIndx:m}))}null!==v&&null!==m&&(u[0]&&this.iRenderB.inViewport(v,m,u[0])?(f!==document.body&&t(f).blur(),p.find(".pq-focus").removeAttr("tabindex").removeClass("pq-focus"),p.removeAttr("tabindex"),n=this._focusEle=this._focusEle||{},u&&(i=u[0])&&u.hasClass("pq-grid-cell")&&!i.edited?(n.$ele&&n.$ele.length&&n.$ele[0].removeAttribute("tabindex"),n.$ele=u,n.rowIndxPage=v,n.colIndx=m,i.setAttribute("tabindex","-1"),o||(u.addClass("pq-focus"),i.focus())):(a=h.dataModel.data)&&a.length||g.setAttribute("tabindex",0)):((n=this._focusEle)&&p.find(".pq-focus").removeClass("pq-focus"),u&&(u.addClass("pq-focus"),this._focusEle={$ele:u,rowIndxPage:v,colIndx:m}),document.activeElement!==g&&(p.attr("tabindex",0),g.focus())))},r.onfocus=function(t){var e=this._focusEle;e&&this.getCell(e).addClass("pq-focus")},r.onblur=function(){var t=this._focusEle;if(t){t.rowIndxPage,t.colIndx;var e=document.activeElement;this.$cont.find(".pq-focus").removeClass("pq-focus"),e&&e!==document.body&&"pq-grid-excel"!==e.id&&"pq-body-outer"!==e.className&&(this._focusEle={})}},r.callFn=function(t,e){return n.getFn(t).call(this,e)},r.rowExpand=function(t){this.iHierarchy.rowExpand(t)},r.rowInvalidate=function(t){this.iHierarchy.rowInvalidate(t)},r.rowCollapse=function(t){this.iHierarchy.rowCollapse(t)},r._saveState=function(e,i,n){var r,o,a,s;for(r in n)(o=n[r])&&(a=e[r],t.isArray(o)?null!==a&&(s=i[r]=t.isPlainObject(i[r])?i[r]:{},o.forEach(function(t){s[t]=a[t]})):i[r]=a)},r.saveState=function(t){t=t||{};for(var e,i,n,r=this.element,o=this.options,a=o.stateColKeys,s=o.stateKeys,l=this.colModel,d=[],c=0,h=l.length,u=r[0].id;c<h;c++)i={dataIndx:(e=l[c]).dataIndx},this._saveState(e,i,a),d[c]=i;return n={colModel:d,datestamp:Date.now()},this._saveState(o,n,s),!1!==t.stringify&&(n=JSON.stringify(n),!1!==t.save&&"undefined"!=typeof Storage&&localStorage.setItem("pq-grid"+(u||""),n)),n},r.getState=function(){if("undefined"!=typeof Storage)return localStorage.getItem("pq-grid"+(this.element[0].id||""))},r.loadState=function(e){e=e||{};var i,n=t.widget.extend,r=e.state||this.getState();if(!r)return!1;"string"==typeof r&&(r=JSON.parse(r));for(var o,a,s,l=r.colModel,d=[],c=[],h=this.options,u=h.stateColKeys,f=this.depth>1,p=f?this.colModel:h.colModel,g=0,v=l.length;g<v;g++)d[s=(o=l[g]).dataIndx]=o,c[s]=g;for(f||p.sort(function(t,e){return c[t.dataIndx]-c[e.dataIndx]}),g=0,v=p.length;g<v;g++)(o=d[s=(a=p[g]).dataIndx])&&this._saveState(o,a,u);return this.iCols.init(),n(h.sortModel,r.sortModel),n(h.pageModel,r.pageModel),this.Group().option(r.groupModel,!1),i={freezeRows:r.freezeRows,freezeCols:r.freezeCols},isNaN(1*h.height)||isNaN(1*r.height)||(i.height=r.height),isNaN(1*h.width)||isNaN(1*r.width)||(i.width=r.width),this.option(i),!1!==e.refresh&&this.refreshDataAndView(),!0},r.refreshToolbar=function(){var e,i=this.options,r=i.toolbar;if(this._toolbar&&(e=this._toolbar).destroy(),r){var o=(o=r.cls)||"",a=(a=r.style)||"",s=(s=r.attr)||"",l=r.items,d=t("<div class='"+o+"' style='"+a+"' "+s+" ></div>");e?e.widget().replaceWith(d):this.$top.append(d),e=n.toolbar(d,{items:l,gridInstance:this,bootstrap:i.bootstrap}),i.showToolbar||d.css("display","none"),this._toolbar=e}},r.isLeftOrRight=function(t){this.options;return t>this.freezeCols?"right":"left"},r.ovCreateHeader=function(t){this.options.filterModel.header&&this.iHeaderSearch.createDOM(t)},r.filter=function(t){return this.iFilterData.filter(t)},r.Checkbox=function(t){return this.iCheckBox[t]},r._initTypeColumns=function(){for(var t=this.colModel,i=0,n=t.length,r=this.iCheckBox={};i<n;i++){var o=t[i],a=o.type;"checkbox"===a||"checkBoxSelection"===a?(o.type="checkbox",r[o.dataIndx]=new e.cCheckBoxColumn(this,o)):"detail"===a&&(o.dataIndx="pq_detail",this.iHierarchy=new e.cHierarchy(this,o))}},r.refreshHeader=function(){this.iRenderHead.refreshHS()},r.refreshHeaderFilter=function(t){var e=this.normalize(t),i=e.colIndx,n=e.column,r=this.iRenderHead,o=r.rows-1;this.options.filterModel.header&&(r.refreshCell(o,i,{},n),r.postRenderCell(n,i,o))},r._refreshHeaderSortIcons=function(){this.iHeader.refreshHeaderSortIcons()},r.pageData=function(){return this.pdata},r.getData=function(t){var e=(t=t||{}).dataIndx,i=e?e.length:0,n=t.data,r=!i,a=this.columns,s=this.options.dataModel,l=s.dataPrimary||s.data||[],d=s.dataUF||[],c=[];if(!i)return d.length?l.concat(d):l;n?o(n,e,c):(o(l,e,c),o(d,e,c));for(var h=[],u=e.reduce(function(t,e){var i=a[e];return i&&t.push({dataIndx:e,dir:"up",dataType:i.dataType,sortType:i.sortType}),t},[]),f={},p=0,g=c.length;p<g;p++){var v=c[p],m=JSON.stringify(v);f[m]||(h.push(v),f[m]=1)}return h=this.iSort._sortLocalData(u,h,r)},r.getPlainOptions=function(e,i){var n=e[0];if(t.isPlainObject(n)){var r=Object.keys(n);r[0]!==i&&1===r.length&&(e=e.map(function(t){var e,n={};for(e in t)n[i]=e,n.pq_label=t[e];return n}))}else e=e.map(function(t){var e={};return e[i]=t,e});return e},r.getDataCascade=function(t,e,i){var n,r,o=this,a=o.options.filterModel,s=a.newDI.slice(),l=e?[e,t]:[t],d=s.indexOf(t);return"AND"===a.mode&&s.length&&"remote"!==a.type&&(d>=0&&s.splice(d,s.length),s.length&&(n=s.map(function(t){var e=o.getColumn({dataIndx:t}).filter;return{dataIndx:t,crules:e.crules||[e],mode:e.mode}}),r=o.filter({data:o.getData(),mode:"AND",rules:n}))),l=l.concat(i||[]),o.getData({data:r,dataIndx:l})},r.removeNullOptions=function(t,e,i){var n;return null===i?t.filter(function(t){var i=t[e];return null!==i&&""!==i||(n?void 0:(n=!0,t[e]="",!0))}):t.filter(function(t){var i=t[e];return null!==i&&""!==i})},r.get_p_data=function(){var t,e,i,n,r=this.options,o=r.pageModel,a=o.type,s=r.dataModel.data,l=this.pdata,d=[];return a?(e=o.rPP,i=this.riOffset,!l.length&&s.length&&(l=s.slice(i,i+e)),d=(t="remote"===a)?new Array(i):s.slice(0,i),n=t?[]:s.slice(i+e),d.concat(l,n)):l.length?l:s},r._onDataAvailable=function(t){t=t||{},this.pdata=[];var e=this.options,i=!t.data,n=t.source,r=t.sort,o=[],a=e.filterModel,s=e.dataModel,l=e.sortModel;if(!1!==i&&!1!==t.trigger&&this._trigger("dataAvailable",t.evt,{source:n}),o=a&&a.on&&"local"===a.type?this.iFilterData.filterLocalData(t).data:s.data,"local"===l.type&&!1!==r&&(i?this.sort({refresh:!1}):o=this.iSort.sortLocalData(o,!0)),!1===i)return o;this.refreshView(t)},r.reset=function(e){var i,n,r=(e=e||{}).sort,o=this.options,a=!1!==e.refresh,s=t.extend,l=e.filter,d=e.group;(r||l||d)&&(r&&(i=!0===r?{sorter:[]}:r,s(o.sortModel,i)),l&&!a&&this.iFilterData.clearFilters(this.colModel),d&&(n=!0===d?{dataIndx:[]}:d,this.groupOption(n,!1)),a&&(l?(this.filter({oper:"replace",rules:[]}),this.refreshHeader()):r?this.sort():this.refreshView()))},r._trigger=e._trigger,r.on=e.on,r.one=e.one,r.off=e.off,r.pager=function(){return this.pagerW=this.pagerW||this.widget().find(".pq-pager").pqPager("instance"),this.pagerW},r.toolbar=function(){return this._toolbar.element},r.Columns=function(){return this.iCols}}(jQuery),function(t){var e=t.paramquery;e.cColModel=function(t){this.that=t,this.vciArr,this.ciArr,this.init()},e.cColModel.prototype={alter:function(t){var e=this.that;t.call(e),e.refreshCM(),e.refresh()},assignRowSpan:function(){for(var t,e,i,n,r=this.that,o=r.colModel.length,a=r.headerCells,s=r.depth,l=0;l<o;l++)for(e=0;e<s;e++)if(t=a[e][l],!(l>0&&t===a[e][l-1]||e>0&&t===a[e-1][l])){for(n=1,i=e+1;i<s;i++)t===a[i][l]&&n++;t.rowSpan=n}return a},autoGenColumns:function(){var e=this.that.options,i=e.columnTemplate||{},n=i.dataType,r=i.title,o=i.width,a=e.dataModel.data,s=pq.validation,l=[];if(a&&a.length){var d=a[0];t.each(d,function(t,e){var i="string";s.isInteger(e)?i=e+"".indexOf(".")>-1?"float":"integer":s.isDate(e)?i="date":s.isFloat(e)&&(i="float"),l.push({dataType:n||i,dataIndx:t,title:r||t,width:o||100})})}e.colModel=l},cacheIndices:function(){for(var t,e=this.that,i="JSON"===this.getDataType(),n={},r={},o={},a=e.colModel,s=0,l=a.length,d=0,c=this.vciArr=[],h=this.ciArr=[];s<l;s++){var u=a[s],f=u.dataIndx;null===f&&("pq_detail"===(f="detail"===u.type?"pq_detail":i?"dataIndx_"+s:s)&&(u.dataType="object"),u.dataIndx=f),n[f]=u,r[f]=s,u.validations&&(o[f]=o),u.hidden||(h[d]=s,c[s]=d,d++),u.align||!(t=u.dataType)||"integer"!==t&&"float"!==t||(u.align="right")}e.columns=n,e.colIndxs=r,e.validations=o},collapse:function(t){var e,i,n,r=t.collapsible,o=r.on||!1,a=t.colModel||[],s=a.length,l=s,d=0,c=r.last,h=c?s-1:0;if(s){for(;l--;)e=a[l],null===c?(n=e.showifOpen===o)&&d++:n=h!==l&&o,e.hidden=n,n||!(i=e.colModel)||e.collapsible||this.each(function(t){t.hidden=n},i);d===s&&this.each(function(t){t.hidden=!1},[a[0]])}},each:function(t,e){var i=this.that;(e||i.options.colModel).forEach(function(e){t.call(i,e),e.colModel&&this.each(t,e.colModel)},this)},extend:function(e,i){for(var n,r,o=t.extend,a=e.length;a--;){var s=e[a];for(n in i)void 0===s[n]&&(r=i[n],s[n]=r&&"object"==typeof r?o(!0,{},r):r)}},find:function(t,e){for(var i,n,r=this.that,o=e||r.options.colModel,a=0,s=o.length;a<s;a++){if(i=o[a],t.call(r,i))return i;if(i.colModel&&(n=this.find(t,i.colModel)))return n}},getHeaderCells:function(){for(var t=this.that,e=t.options.colModel,i=t.colModel.length,n=t.depth,r=[],o=0;o<n;o++){r[o]=[];for(var a=0,s=0,l=0;l<i;l++){var d;if(0===o)d=e[a];else{var c=r[o-1][l],h=c.colModel;if(h&&0!==h.length){for(var u=l-c.leftPos,f=0,p=0,g=0;g<h.length;g++)if(u<(f+=h[g].childCount>0?h[g].childCount:1)){p=g;break}d=h[p]}else d=c}var v=d.childCount?d.childCount:1;l===s?(d.leftPos=l,r[o][l]=d,s+=v,e[a+1]&&a++):r[o][l]=r[o][l-1]}}return t.headerCells=r,r},getDataType:function(){var t=this.colModel;if(t&&t[0])return"string"==typeof t[0].dataIndx?"JSON":"ARRAY"},getci:function(t){return this.ciArr[t]},getvci:function(t){return this.vciArr[t]},getNextVisibleCI:function(t){for(var e=this.vciArr,i=this.that.colModel.length;t<i;t++)if(null!==e[t])return t},getPrevVisibleCI:function(t){var e=this.vciArr;for(this.that.colModel.length;t>=0;t--)if(null!==e[t])return t},getFirstVisibleCI:function(){return this.ciArr[0]},getLastVisibleCI:function(){var t=this.ciArr;return t[t.length-1]},getVisibleTotal:function(){return this.ciArr.length},init:function(t){var e,i,n=this.that,r=n.options,o=r.columnTemplate,a=r.colModel;a||(this.autoGenColumns(),a=r.colModel),e=this.nestedCols(a),n.depth=e.depth,(i=n.colModel=e.colModel).length,o&&this.extend(i,o),this.getHeaderCells(),this.assignRowSpan(),this.cacheIndices(),n._trigger("CMInit",null,t)},nestedCols:function(t,e,i,n){var r=t.length,o=[];null===e&&(e=1);for(var a=e,s=0,l=0,d=0,c=0;c<r;c++){var h,u=t[c],f=u.colModel;n&&(u.parent=n),!0===i&&(u.hidden=i),f&&f.length?(u.collapsible&&this.collapse(u),h=this.nestedCols(f,e+1,u.hidden,u),o=o.concat(h.colModel),h.colSpan>0?(h.depth>a&&(a=h.depth),u.colSpan=h.colSpan,s+=h.colSpan):u.colSpan=0,d+=h.o_colspan,u.o_colspan=h.o_colspan,u.childCount=h.childCount,l+=h.childCount):(u.hidden?u.colSpan=0:(u.colSpan=1,s++),d++,u.o_colspan=1,u.childCount=0,l++,o.push(u))}return{depth:a,colModel:o,colSpan:s,width:0,childCount:l,o_colspan:d}},reduce:function(t,e){var i=this.that,n=[];return(e||i.options.colModel).forEach(function(e,r){var o,a,s=t.call(i,e,r);s&&((a=s.colModel)&&a.length?(o=this.reduce(t,a)).length&&(s.colModel=o,n.push(s)):n.push(s))},this),n},hide:function(t){var e=this.that,i=e.columns;t.diShow=t.diShow||[],t.diHide=t.diHide||[],!1!==e._trigger("beforeHideCols",null,t)&&(t.diShow=t.diShow.filter(function(t){var e=i[t];if(e.hidden)return delete e.hidden,!0}),t.diHide=t.diHide.filter(function(t){var e=i[t];if(!e.hidden)return e.hidden=!0,!0}),e.refresh({colModel:!0}),e._trigger("hideCols",null,t))}}}(jQuery),function(t){function e(e,i){var n=this,r=e.options;n.that=e,n.type="detail",n.refreshComplete=!0,n.rowHtDetail=r.detailModel.height,e.on("cellClick",n.toggle.bind(n)).on("cellKeyDown",function(e,i){if(e.keyCode===t.ui.keyCode.ENTER)return n.toggle(e,i)}).on("beforeViewEmpty",n.onBeforeViewEmpty.bind(n)).on("autoRowHeight",n.onAutoRowHeight.bind(n)).one("render",function(){e.iRenderB.removeView=n.removeView(n,e),e.iRenderB.renderView=n.renderView(n,e)}).one("destroy",n.onDestroy.bind(n)),i._render=n.renderCell.bind(n)}t.extend(t.paramquery.pqGrid.prototype,{parent:function(){return this._parent},child:function(t){return((this.normalize(t).rowData||{}).pq_detail||{}).child}}),t.paramquery.cHierarchy=e,e.prototype={detachCells:function(t){t.children().detach(),t.remove()},getCls:function(){return"pq-detail-cont-"+this.that.uuid},getId:function(t){return"pq-detail-"+t+"-"+this.that.uuid},getRip:function(t){return 1*t.id.split("-")[2]},onAutoRowHeight:function(){var e=this,i=this.that.iRenderB;i.$ele.find("."+e.getCls()).each(function(n,r){var o=e.getRip(r),a=i.getHeightCell(o);t(r).css("top",a)})},onBeforeViewEmpty:function(t,e){var i=e.rowIndxPage,n=this.that.iRenderB,r=e.region,o=i>=0?"#"+this.getId(i):"."+this.getCls(),a=i>=0?n.$ele.find(o):n["$c"+r].find(o);this.detachCells(a)},onDestroy:function(){(this.that.getData()||[]).forEach(function(t){t.child&&t.child.remove()})},onResize:function(t,e){var i,n=[];e.resize(function(){n.push(e[0]),clearTimeout(i),i=setTimeout(function(){var e=t.that.pdata,i=[];n.forEach(function(n){if(document.body.contains(n)){var r=t.getRip(n),o=n.offsetHeight,a=e[r],s=a.pq_detail.height||t.rowHtDetail;s!==o&&(a.pq_detail.height=o,i.push([r,o-s]))}}),n=[],i.length&&(t.that._trigger("onResizeHierarchy"),t.softRefresh(i))},150)})},removeView:function(e,i){var n=i.iRenderB.removeView;return function(i,r,o){var a,s,l,d=n.apply(this,arguments),c=e.getCls(),h=this.getCellRegion(i,o);for(a=i;a<=r;a++)(s=this.getRow(a,h))&&1===s.children.length&&1===(l=t(s).children("."+c)).length&&(e.detachCells(l),s.parentNode.removeChild(s));return d}},renderView:function(e,i){var n=i.iRenderB.renderView;return function(r,o,a,s){var l,d,c=n.apply(this,arguments),h=i.iRenderB,u=e.getCls()+" pq-detail",f=i.options,p=f.freezeRows,g=f.detailModel.init,v=this.data;if(e.refreshComplete){for(e.refreshComplete=!1,l=r;l<=o;l++)if((d=v[l])&&!d.pq_hidden){var m=d.pq_detail=d.pq_detail||{},w=m.show,x=m.child;if(!w)continue;x||"function"==typeof g&&(x=g.call(i,{rowData:d}),m.child=x);var y=x.parent(),C=h.getHeightCell(l),b="position:absolute;left:0;top:"+C+"px;padding:5px;width:100%;overflow:hidden;padding-left:"+(i.dims.wdContLeft+5)+"px;";if(y.length){if(!document.body.contains(y[0]))throw"incorrectly detached detail";y.css({top:C})}else y=t("<div role='gridcell' id='"+e.getId(l)+"' class='"+u+"' style='"+b+"'></div>").append(x),t(h.getRow(l,l<p?"tr":"right")).append(y),e.onResize(e,y);for(var I,_,q=y.find(".pq-grid"),D=0,R=q.length;D<R;D++)(_=(I=t(q[D])).pqGrid("instance"))._parent=i,I.hasClass("pq-pending-refresh")&&I.is(":visible")&&(I.removeClass("pq-pending-refresh"),_.refresh())}return e.refreshComplete=!0,c}}},renderCell:function(t){var e=this.that.options.detailModel,i=t.cellData,n=t.rowData;return n.pq_gsummary||n.pq_gtitle?"":"<div class='ui-icon "+(i&&i.show?e.expandIcon:e.collapseIcon)+"'></div>"},rowExpand:function(t){var e,i=this.that,n=i.normalize(t),r=i.options,o=n.rowData,a=n.rowIndxPage,s=r.detailModel;if(o){if(!1===i._trigger("beforeRowExpand",null,n))return;(e=o.pq_detail=o.pq_detail||{}).show=!0,s.cache||this.rowInvalidate(n),this.softRefresh([[a,e.height||this.rowHtDetail]],n)}},rowInvalidate:function(t){var e=this.that.getRowData(t),i=e.pq_detail,n=i?i.child:null;n&&(n.remove(),e.pq_detail.child=null)},rowCollapse:function(t){var e=this.that,i=e.options,n=e.normalize(t),r=n.rowData,o=n.rowIndxPage,a=i.detailModel,s=r?r.pq_detail:null;if(s&&s.show){if(n.close=!0,!1===e._trigger("beforeRowExpand",null,n))return;a.cache||this.rowInvalidate(n),s.show=!1,this.softRefresh([[o,-(s.height||this.rowHtDetail)]],n)}},softRefresh:function(t,e){var i=this.that,n=i.iRenderB;n.initRowHtArrDetailSuper(t),n.setPanes(),n.setCellDims(!0),e&&i.refreshRow(e),n.refresh()},toggle:function(t,e){var i=this.that,n=e.column,r=e.rowData,o=e.rowIndx,a=this.type;r.pq_gtitle||r.pq_gsummary||n&&n.type===a&&i[(r.pq_detail=r.pq_detail||{}).show?"rowCollapse":"rowExpand"]({rowIndx:o})}}}(jQuery),function(t){var e=function(t){this.that=t,this.class="pq-grid-overlay",this.ranges=[],t.on("assignTblDims",this.onRefresh(this,t))};t.paramquery.cCells=e,e.prototype={addBlock:function(t,e){if(t&&this.addUnique(this.ranges,t)){var i=this.that,n=t.r1,r=t.c1,o=t.r2,a=t.c2,s=this.serialize(n,r,o,a),l=s+" "+t.type,d=s+" pq-number-overlay",c=s+" pq-head-overlay",h=i.iRenderB,u=function(t,e){return h.getCellCont(t,e)},f=this.shiftRC(n,r,o,a);if(f){n=f[0],r=f[1],o=f[2],a=f[3];var p,g,v,m,w,x,y,C,b,I,_=u(n,r),q=u(o,a);if(w=(f=h.getCellXY(n,r))[0]-1,x=f[1]-1,y=(f=h.getCellCoords(o,a))[2],b=(C=f[3])-x,I=y-w,_===q?this.addLayer(w,x,b,I,l,_):(p=u(n,a),g=u(o,r),v=_[0].offsetWidth,m=_[0].offsetHeight,g===_?(this.addLayer(w,x,b,v-w,l,_,"border-right:0;"),this.addLayer(0,x,b,y,l,q,"border-left:0;")):_===p?(this.addLayer(w,x,m-x,I,l,_,"border-bottom:0;"),this.addLayer(w,0,C,I,l,q,"border-top:0;")):(this.addLayer(w,x,m-x,v-w,l,_,"border-right:0;border-bottom:0"),this.addLayer(0,x,m-x,y,l,p,"border-left:0;border-bottom:0"),this.addLayer(w,0,C,v-w,l,g,"border-right:0;border-top:0"),this.addLayer(0,0,C,y,l,q,"border-left:0;border-top:0"))),I=i.options.numberCell.outerWidth||0,this.addLayer(0,x,b,I,d,h.$clt,""),this.addLayer(0,x,b,I,d,h.$cleft,""),!1!==i.options.showHeader){w=(f=(h=i.iRenderHead).getCellXY(0,r))[0],x=f[1],y=(f=h.getCellCoords(i.headerCells.length-1,a))[2],b=(C=f[3])-x,I=y-w;var D=h.$cright;this.addLayer(w,x,b,I,c,D,""),D=h.$cleft,this.addLayer(w,x,b,I,c,D,"")}}}},addLayer:function(e,i,n,r,o,a,s){var l="left:"+e+"px;top:"+i+"px;height:"+n+"px;width:"+r+"px;"+(s||"");t("<svg class='"+this.class+" "+o+"' style='"+l+"'></svg>").appendTo(a)},addUnique:function(t,e){if(!t.filter(function(t){return e.r1===t.r1&&e.c1===t.c1&&e.r2===t.r2&&e.c2===t.c2})[0])return t.push(e),!0},getLastVisibleFrozenCI:function(){for(var t=this.that,e=t.colModel,i=t.options.freezeCols-1;i>=0;i--)if(!e[i].hidden)return i},getLastVisibleFrozenRIP:function(){for(var t=this.that,e=t.get_p_data(),i=t.riOffset,n=t.options.freezeRows+i-1;n>=i;n--)if(!e[n].pq_hidden)return n-i},getSelection:function(){var t=this.that,e=t.get_p_data(),i=t.colModel,n=[];return this.ranges.forEach(function(t){var r,o,a,s=t.r1,l=t.r2,d=t.c1,c=t.c2;for(o=s;o<=l;o++)for(r=e[o],a=d;a<=c;a++)n.push({dataIndx:i[a].dataIndx,colIndx:a,rowIndx:o,rowData:r})}),n},isSelected:function(t){var e=this.that.normalize(t),i=e.rowIndx,n=e.colIndx;return null===n||null===i?null:!!this.ranges.find(function(t){var e=t.r1,r=t.r2,o=t.c1,a=t.c2;if(i>=e&&i<=r&&n>=o&&n<=a)return!0})},onRefresh:function(t,e){var i;return function(){clearTimeout(i),i=setTimeout(function(){e.element&&(t.removeAll(),e.Selection().address().forEach(function(e){t.addBlock(e)}))},50)}},removeAll:function(){var t=this.that,e=t.$cont,i=t.$header;e&&(e.children().children().children("svg").remove(),i.children().children().children("svg").remove()),this.ranges=[]},removeBlock:function(t){if(t){var e,i=t.r1,n=t.c1,r=t.r2,o=t.c2,a=this.that,s=this.ranges.findIndex(function(t){return i===t.r1&&n===t.c1&&r===t.r2&&o===t.c2});s>=0&&(this.ranges.splice(s,1),e="."+this.class+"."+this.serialize(i,n,r,o),a.$cont.find(e).remove(),a.$header.find(e).remove())}},serialize:function(t,e,i,n){return"r1"+t+"c1"+e+"r2"+i+"c2"+n},shiftRC:function(t,e,i,n){var r,o=this.that,a=o.iMerge,s=o.options,l=o.pdata.length,d=s.freezeRows,c=o.riOffset;if(i-=c,!((t=(t-=c)<d?Math.max(t,Math.min(0,i)):t)>=l||i<0))return i=Math.min(i,l-1),t+=c,i+=c,a.ismergedCell(t,e)&&(t=(r=a.getRootCell(t,e)).o_ri,e=r.o_ci),a.ismergedCell(i,n)&&(i=(r=a.getRootCell(i,n)).o_ri+r.o_rc-1,n=r.o_ci+r.o_cc-1),t-=c,i-=c,[t=Math.max(t,0),e,i=Math.min(i,l-1),n=Math.min(n,o.colModel.length-1)]}}}(jQuery),function(t){t.paramquery.pqGrid.prototype.Range=function(t,i){return new e.Range(this,t,"range",i)};var e=window.pq=window.pq||{};e.extend=function(t,e,i){var n=function(){};n.prototype=t.prototype;var r=e.prototype=new n,o=t.prototype;for(var a in i){var s=o[a],l=i[a];r[a]=s?function(t,e){return function(){var i,n=this._super;return this._super=function(){return t.apply(this,arguments)},i=e.apply(this,arguments),this._super=n,i}}(s,l):l}r.constructor=e,r._base=t,r._bp=function(t){var e=arguments;return Array.prototype.shift.call(e),o[t].apply(this,e)}};var i=e.Range=function(t,e,n,r){if(null===t)throw"invalid param";if(this.that=t,this._areas=[],this instanceof i==!1)return new i(t,e,n,r);this._type=n||"range",this.init(e,r)};function n(t){t.shiftKey&&"pqGrid:mousePQUp"!==t.type||(this._trigger("selectEnd",null,{selection:this.Selection()}),this.off("mousePQUp",n),this.off("keyUp",n))}i.prototype=t.extend({add:function(t){this.init(t)},address:function(){return this._areas},addressLast:function(){var t=this.address();return t[t.length-1]},clear:function(){return this.copy({copy:!1,cut:!0,source:"clear"})},clearOther:function(t){var e,i=this._normal(t,!0),n=this.address();for(e=n.length-1;e>=0;e--){var r=n[e];r.r1===i.r1&&r.c1===i.c1&&r.r2===i.r2&&r.c2===i.c2||n.splice(e,1)}},newLine:function(t){return'"'+t.replace(/"/g,'""')+'"'},_copyArea:function(t,e,i,n,r,o,a,s,l,d,c){var h,u,f,p,g,v,m,w,x=this.that,y=x.readCell,C=this.getRenderVal,b=x.iMerge,I=[],_=x.riOffset,q=x.iRenderB;for(g=i;g<=n;g++)w=(m=r[g]).dataType,I[g]=!w||"string"===w||"html"===w;for(p=t;p<=e;p++){var D=[],R=s[p],M={},T={},k={rowIndx:p,rowIndxPage:p-_,rowData:R,Export:!0,exportClip:!0};for(g=i;g<=n;g++)v=(m=r[g]).dataIndx,!1!==m.copy&&(h=R[v],d&&((u=y(R,m,b,p,g))===h&&(k.colIndx=g,k.column=m,k.dataIndx=v,u=C(k,c,q)[0],I[g]&&/(\r|\n)/.test(u)&&(u=this.newLine(u))),D.push(u)),l&&void 0!==h&&(M[v]=void 0,T[v]=h));l&&a.push({rowIndx:p,rowData:R,oldRow:T,newRow:M}),f=D.join("\t"),D=[],o.push(f||" ")}},copy:function(t){t=t||{};var e,i,n,r,o,a=this.that,s=t.dest,l=!!t.cut,d=null===t.copy||t.copy,c=t.source||(l?"cut":"copy"),h=t.history,u=t.allowInvalid,f=[],p=[],g=a.get_p_data(),v=a.colModel,m=t.render,w=this.address();if(h=null===h||h,u=null===u||u,m=null===m?a.options.copyModel.render:m,w.length){if(w.forEach(function(t){e=t.type,i=t.r1,n=t.c1,r="cell"===e?i:t.r2,o="cell"===e?n:t.c2,this._copyArea(i,r,n,o,v,p,f,g,l,d,m)},this),d){var x=p.join("\n");if(t.clip){var y=t.clip;y.val(x),y.select()}else a._setGlobalStr(x)}if(s)a.paste({dest:s,rowList:f,history:h,allowInvalid:u});else if(l){!1!==a._digestData({updateList:f,source:c,history:h,allowInvalid:u})&&a.refresh({source:"cut",header:!1})}}},_countArea:function(t){var e=t,i=t.type,n=e.r1,r=e.c1,o=e.r2,a=e.c2;return"cell"===i?1:"row"===i?0:(o-n+1)*(a-r+1)},count:function(){for(var t="range"===this._type,e=this.address(),i=0,n=e.length,r=0;r<n;r++)i+=t?this._countArea(e[r]):1;return i},cut:function(t){return(t=t||{}).cut=!0,this.copy(t)},getIndx:function(t){return null===t?this._areas.length-1:t},getValue:function(){var t,e,i,n,r,o,a,s,l,d,c=this.address(),h=[],u=this.that;if(c.length){for(n=(t=c[0]).r1,r=t.c1,o=t.r2,a=t.c2,d=u.get_p_data(),s=n;s<=o;s++)for(e=d[s],l=r;l<=a;l++)i=e[u.colModel[l].dataIndx],h.push(i);return h}},hide:function(t){t=t||{};var e,i=this.that,n=i.colModel,r=i.get_p_data();this._areas.forEach(function(t){var i=t.type,o=t.r1,a=t.r2,s=t.c1,l=t.c2;if("column"===i)for(e=s;e<=l;e++)n[e].hidden=!0;else if("row"===i)for(e=o;e<=a;e++)r[e].pq_hidden=!0}),!1!==t.refresh&&i.refreshView()},indexOf:function(t){for(var e,i=(t=this._normal(t)).r1,n=t.c1,r=t.r2,o=t.c2,a=this.address(),s=0,l=a.length;s<l;s++)if("row"!==(e=a[s]).type&&i>=e.r1&&r<=e.r2&&n>=e.c1&&o<=e.c2)return s;return-1},index:function(t){for(var e,i=(t=this._normal(t)).type,n=t.r1,r=t.c1,o=t.r2,a=t.c2,s=this.address(),l=0,d=s.length;l<d;l++)if(i===(e=s[l]).type&&n===e.r1&&o===e.r2&&r===e.c1&&a===e.c2)return l;return-1},init:function(t,e){if(e=!1!==e,t)if("function"==typeof t.push)for(var i=0,n=t.length;i<n;i++)this.init(t[i],e);else{var r=this._normal(t,e),o=this._areas=this._areas||[];r&&o.push(r)}},merge:function(t){t=t||{};var e,i,n=this.that,r=n.options.mergeCells,o=this._areas[0];o&&(e=o.r2-o.r1+1,i=o.c2-o.c1+1,(e>1||i>1)&&(o.rc=e,o.cc=i,r.push(o),!1!==t.refresh&&n.refreshView()))},replace:function(t,e){var i=this._normal(t),n=this._areas,r=this.getIndx(e);n.splice(r,1,i)},remove:function(t){var e=this._areas,i=this.indexOf(t);i>=0&&e.splice(i,1)},resize:function(t,e){var i=this._normal(t),n=this._areas[this.getIndx(e)];return["r1","c1","r2","c2","rc","cc","type"].forEach(function(t){n[t]=i[t]}),this},rows:function(t){var i=this.that,n=[],r=this.addressLast();if(r)for(var o=r.r1,a=r.c1,s=r.r2,l=r.c2,d=r.type,c=null===t?s:o+t,h=null===t?o:o+t;h<=c;h++)n.push({r1:h,c1:a,r2:h,c2:l,type:d});return e.Range(i,n,"row")},_normal:function(t,e){if(t.type)return t;var i;if("function"==typeof t.push){i=[];for(var n=0,r=t.length;n<r;n++){var o=this._normal(t[n],e);o&&i.push(o)}return i}var a,s,l,d,c=this.that,h=c.get_p_data().length-1,u=c.colModel.length-1,f=(f=t.r1)>h?h:f,p=(p=t.c1)>u?u:p,g=t.rc,v=t.cc;return g=(a=(a=g?f+g-1:t.r2)>h?h:a)-f+1,v=(s=(s=v?p+v-1:t.c2)>u?u:s)-p+1,u<0||h<0?null:(f>a&&(l=f,f=a,a=l),p>s&&(l=p,p=s,s=l),null!==f||null!==p?(null===f?(f=0,a=h,s=null===s?p:s,d="column"):null===p?(t._type,p=0,a=null===a?f:a,s=u,d=t._type||"row"):null===a||f===a&&p===s?(d="cell",a=f,s=p):d="block",e&&(f=(i=c.iMerge.inflateRange(f,p,a,s))[0],p=i[1],a=i[2],s=i[3]),t.r1=f,t.c1=p,t.r2=a,t.c2=s,t.rc=g,t.cc=v,t.type=t.type||d,t):void 0)},select:function(){var t=this.that.iSelection,e=this._areas;return e.length&&(t.removeAll({trigger:!1}),e.forEach(function(e){t.add(e,!1)}),t.trigger()),this},unhide:function(t){t=t||{};var e,i=this.that,n=i.colModel,r=i.get_p_data();this._areas.forEach(function(t){var i=t.type,o=t.r1,a=t.r2,s=t.c1,l=t.c2;if("column"===i)for(e=s;e<=l;e++)n[e].hidden=!1;else if("row"===i)for(e=o;e<=a;e++)r[e].pq_hidden=!1}),!1!==t.refresh&&i.refreshView()},unmerge:function(t){t=t||{};var e=this.that,i=e.options.mergeCells,n=this._areas[0];if(n){for(var r=0;r<i.length;r++){var o=i[r];if(o.r1===n.r1&&o.c1===n.c1){i.splice(r,1);break}}!1!==t.refresh&&e.refreshView()}},value:function(t){var e,i,n,r,o,a=0,s=this.that,l=s.colModel,d=[],c=this.address();if(void 0===t)return this.getValue();for(var h=0;h<c.length;h++){i=(e=c[h]).r1,n=e.c1,r=e.r2,o=e.c2;for(var u=i;u<=r;u++){for(var f=s.normalize({rowIndx:u}),p=f.rowData,g=f.rowIndx,v={},m={},w=n;w<=o;w++){var x=l[w].dataIndx;m[x]=t[a++],v[x]=p[x]}d.push({rowData:p,rowIndx:g,newRow:m,oldRow:v})}}return d.length&&(s._digestData({updateList:d,source:"range"}),s.refresh({header:!1})),this}},e.mixin.render);var r=e.Selection=function(e,i){if(null===e)throw"invalid param";if(this instanceof r==!1)return new r(e,i);this._areas=[],this.that=e,this.iCells=new t.paramquery.cCells(e),this._base(e,i)};e.extend(i,r,{add:function(t,e){var i=this._normal(t,!0),n=this.iCells;this.indexOf(i)>=0||(n.addBlock(i),this._super(i),!1!==e&&this.trigger())},clearOther:function(t){var e=this.iCells,i=this._normal(t,!0);this.address().forEach(function(t){t.r1===i.r1&&t.c1===i.c1&&t.r2===i.r2&&t.c2===i.c2||e.removeBlock(t)}),this._super(i),this.trigger()},getSelection:function(){return this.iCells.getSelection()},isSelected:function(t){return this.iCells.isSelected(t)},removeAll:function(t){t=t||{},this._areas.length&&(this.iCells.removeAll(),this._areas=[],!1!==t.trigger&&this.trigger())},resizeOrReplace:function(t,e){this.resize(t,e)||this.replace(t,e)},replace:function(t,e){var i=this.iCells,n=this._normal(t),r=this._areas,o=this.getIndx(e),a=r[o];i.removeBlock(a),i.addBlock(n),this._super(n,o),this.trigger()},resize:function(t,e){var i=this._normal(t,!0),n=i.r1,r=i.c1,o=i.r2,a=i.c2,s=this._areas||[];if(!s.length)return!1;var l=s[this.getIndx(e)],d=l.r1,c=l.c1,h=l.r2,u=l.c2;return!(d!==n||c!==r||d!==n||u!==a||h!==o||c!==r||(h!==o||u!==a))||void 0},selectAll:function(t){var e,i=(t=t||{}).type,n=this.that,r=n.colModel,o=t.all,a=o?0:n.riOffset,s=o?n.get_p_data().length:n.pdata.length,l=r.length-1,d=a+s-1;return"row"===i?(e={r1:a,r2:d},n.Range(e).select()):((e={r1:a,c1:0}).r2=d,e.c2=l,n.Range(e).select()),this},trigger:function(){var t=this.that;t._trigger("selectChange",null,{selection:this}),t.off("mousePQUp",n),t.off("keyUp",n),t.on("mousePQUp",n),t.on("keyUp",n)}})}(jQuery),function(t){var e=t.paramquery;t.widget("paramquery.pqToolbar",{options:{items:[],gridInstance:null,events:{button:"click",select:"change",checkbox:"change",textbox:"change",file:"change"}},_create:function(){var i,n=this.options,r=n.gridInstance,o=n.events,a=n.bootstrap,s=a.on,l=r.colModel,d=r.options.filterModel.timeout,c=n.items,h=this.element,u=0,f=c.length;for(h.addClass("pq-toolbar");u<f;u++){var p,g,v,m,w=c[u],x=w.type,y=w.value,C=w.icon,b=w.options||{},I=w.label,_=(_=(p=w.listener)?[p]:w.listeners)||[function(){}],q=w.cls,D=q||"",R=(D=(D=s&&"button"===x?a.btn+" "+D:D)?"class='"+D+"'":"",w.style),M=R?"style='"+R+"'":"",T=w.attr,k=T||"",E=I?"<label "+M+">"+I:"",S=I?"</label>":"",P=(P=I&&"button"!==x&&"file"!==x?[D,k]:[D,k,M]).join(" ");if(w.options=b,"textbox"===x)v=t([E,"<input type='text' "+P+">",S].join(""));else if("textarea"===x)v=t([E,"<textarea "+P+"></textarea>",S].join(""));else if("select"===x)"function"==typeof b&&(b=b.call(r,{colModel:l})),b=b||[],g=e.select({options:b,attr:P,prepend:w.prepend,groupIndx:w.groupIndx,valueIndx:w.valueIndx,labelIndx:w.labelIndx}),v=t([E,g,S].join(""));else if("file"===x)v=t(["<label class='btn btn-default' "+P+">",I||"File","<input type='file' style='display:none;'>","</label>"].join(""));else if("checkbox"===x)v=t([I?"<label "+M+">":"","<input type='checkbox' ",y?"checked='checked' ":"",P,">",I?I+"</label>":""].join(""));else if("separator"===x)v=t("<span class='pq-separator' "+[k,M].join(" ")+"></span>");else if("button"===x){var $="";s&&($=C?"<span class='glyphicon "+C+"'></span>":""),v=t("<button type='button' "+P+">"+$+I+"</button>"),t.extend(b,{label:I||!1,icon:C,icons:{primary:s?"":C}}),v.button(b)}else"string"==typeof x?v=t(x):"function"==typeof x&&(g=x.call(r,{colModel:l,cls:D}),v=t(g));v.appendTo(h),m=this.getInner(v,I,x),"checkbox"!==x&&void 0!==y&&m.val(y);for(var A=0,H=_.length;A<H;A++){p=_[A];var F={};for(i in"function"==typeof p?F[o[x]]=p:F=p,F)pq.fakeEvent(m,i,d),m.on(i,this._onEvent(r,F[i],w))}}}}),t.extend(e.pqToolbar.prototype,{getInner:function(e,i,n){var r=e[0];return"LABEL"===r.nodeName.toUpperCase()?t(r.children[0]):e},refresh:function(){this.element.empty(),this._create()},_onEvent:function(e,i,n){return function(r){"checkbox"===n.type?n.value=t(r.target).prop("checked"):n.value=t(r.target).val(),i.call(e,r)}},_destroy:function(){this.element.empty().removeClass("pq-toolbar").enableSelection()},_disable:function(){null===this.$disable&&(this.$disable=t("<div class='pq-grid-disable'></div>").css("opacity",.2).appendTo(this.element))},_enable:function(){this.$disable&&(this.element[0].removeChild(this.$disable[0]),this.$disable=null)},_setOption:function(t,e){"disabled"===t&&(!0===e?this._disable():this._enable())}}),pq.toolbar=function(e,i){var n=t(e).pqToolbar(i);return n.data("paramqueryPqToolbar")||n.data("paramquery-pqToolbar")}}(jQuery),function(t){var e=t.paramquery,i=e.pqGrid.prototype;i.options.trackModel={on:!1,dirtyClass:"pq-cell-dirty"},e.cUCData=function(t){this.that=t,this.udata=[],this.ddata=[],this.adata=[],this.options=t.options,t.on("dataAvailable",this.onDA(this))},e.cUCData.prototype={add:function(t){for(var e=this.that,i=this.adata,n=this.ddata,r=t.rowData,o=this.options.trackModel.dirtyClass,a=e.getRecId({rowData:r}),s=0,l=i.length;s<l;s++){var d=i[s];if(null!==a&&d.recId===a)throw"primary key violation";if(d.rowData===r)throw"same data can't be added twice."}for(s=0,l=n.length;s<l;s++)if(r===n[s].rowData)return void n.splice(s,1);var c=[];for(var h in r)c.push(h);e.removeClass({rowData:r,dataIndx:c,cls:o});t={recId:a,rowData:r};i.push(t)},commit:function(t){var e=this.that;if(null===t)this.commitAddAll(),this.commitUpdateAll(),this.commitDeleteAll();else{var i=t.history,n=[],r=e.options.dataModel.recIndx,o=t.type,a=t.rows;i=null!==i&&i,"add"===o?a?n=this.commitAdd(a,r):this.commitAddAll():"update"===o?a?this.commitUpdate(a,r):this.commitUpdateAll():"delete"===o&&(a?this.commitDelete(a,r):this.commitDeleteAll()),n.length&&(e._digestData({source:"commit",checkEditable:!1,track:!1,history:i,updateList:n}),e.refreshView({header:!1}))}},commitAdd:function(e,i){var n,r,o,a,s,l,d=this.that,c=d.colModel,h=c.length,u=this.adata,f=t.inArray,p=u.length,g=d.getValueFromDataType,v=[],m=e.length,w=[];for(r=0;r<m;r++)for(s=e[r],n=0;n<p;n++)if(l=!0,-1===f(a=u[n].rowData,w)){for(o=0;o<h;o++){var x=c[o],y=x.dataType,C=x.dataIndx;if(!x.hidden&&C!==i)if(g(a[C],y)!==g(s[C],y)){l=!1;break}}if(l){var b={},I={};b[i]=s[i],I[i]=a[i],v.push({rowData:a,oldRow:I,newRow:b}),w.push(a);break}}var _=[];for(n=0;n<p;n++)-1===f(a=u[n].rowData,w)&&_.push(u[n]);return this.adata=_,v},commitDelete:function(t,e){for(var i,n,r,o,a=this.ddata,s=a.length,l=this.udata;s--&&(n=(i=a[s].rowData)[e],r=t.length);)for(;r--;)if(n===t[r][e]){for(t.splice(r,1),a.splice(s,1),o=l.length;o--;)l[o].rowData===i&&l.splice(o,1);break}},commitUpdate:function(e,i){var n,r,o=this.that,a=this.options.trackModel.dirtyClass,s=this.udata,l=s.length,d=e.length,c=[];for(n=0;n<l;n++){var h=s[n],u=h.rowData,f=h.oldRow;if(-1===t.inArray(u,c))for(r=0;r<d;r++){var p=e[r];if(u[i]===p[i])for(var g in c.push(u),f)o.removeClass({rowData:u,dataIndx:g,cls:a})}}var v=[];for(n=0;n<l;n++)u=s[n].rowData,-1===t.inArray(u,c)&&v.push(s[n]);this.udata=v},commitAddAll:function(){this.adata=[]},commitDeleteAll:function(){for(var t,e=this.ddata,i=this.udata,n=i.length,r=e.length,o=0;n>0&&o<r;o++){for(t=e[o].rowData;n--;)i[n].rowData===t&&i.splice(n,1);n=i.length}e.length=0},commitUpdateAll:function(){for(var t=this.that,e=this.options.trackModel.dirtyClass,i=this.udata,n=0,r=i.length;n<r;n++){var o=i[n],a=o.oldRow,s=o.rowData;for(var l in a)t.removeClass({rowData:s,dataIndx:l,cls:e})}this.udata=[]},delete:function(t){for(var e=this.that,i=t.rowIndx,n=t.rowIndxPage,r=e.riOffset,o=(i=null===i?n+r:i,n=null===n?i-r:n,"remote"===e.options.pageModel.type?n:i),a=this.adata,s=this.ddata,l=e.getRowData(t),d=0,c=a.length;d<c;d++)if(a[d].rowData===l)return void a.splice(d,1);s.push({indx:o,rowData:l,rowIndx:i})},getChangesValue:function(e){e=e||{};for(var i=this.that,n=e.all,r=this.udata,o=this.adata,a=this.ddata,s=[],l=[],d=[],c=[],h=[],u=[],f=0,p=a.length;f<p;f++){var g=(x=a[f]).rowData,v={};for(var m in h.push(g),g)0!==m.indexOf("pq_")&&(v[m]=g[m]);u.push(v)}for(f=0,p=r.length;f<p;f++){var w=(x=r[f]).oldRow;g=x.rowData;if(-1===t.inArray(g,h)&&-1===t.inArray(g,s)){v={};if(!1!==n)for(var m in g)0!==m.indexOf("pq_")&&(v[m]=g[m]);else{for(var m in w)v[m]=g[m];v[i.options.dataModel.recIndx]=x.recId}s.push(g),l.push(v),d.push(w)}}for(f=0,p=o.length;f<p;f++){var x;g=(x=o[f]).rowData,v={};for(var m in g)0!==m.indexOf("pq_")&&(v[m]=g[m]);c.push(v)}return{updateList:l,addList:c,deleteList:u,oldList:d}},getChanges:function(){this.that;for(var e=this.udata,i=this.adata,n=this.ddata,r=t.inArray,o=[],a=[],s=[],l=[],d=0,c=n.length;d<c;d++){var h=(f=n[d]).rowData;l.push(h)}for(d=0,c=e.length;d<c;d++){var u=(f=e[d]).oldRow;-1===r(h=f.rowData,l)&&(-1===r(h,o)&&(o.push(h),a.push(u)))}for(d=0,c=i.length;d<c;d++){var f;h=(f=i[d]).rowData;s.push(h)}return{updateList:o,addList:s,deleteList:l,oldList:a}},getChangesRaw:function(){this.that;var t=this.udata,e=this.adata,i=this.ddata,n={updateList:[],addList:[],deleteList:[]};return n.updateList=t,n.addList=e,n.deleteList=i,n},isDirty:function(t){var e=this.that,i=this.udata,n=this.adata,r=this.ddata,o=!1,a=e.getRowData(t);if(a)for(var s=0;s<i.length;s++){if(a===i[s].rowData){o=!0;break}}else(i.length||n.length||r.length)&&(o=!0);return o},onDA:function(t){return function(e,i){"filter"!==i.source&&(t.udata=[],t.ddata=[],t.adata=[])}},rollbackAdd:function(t,e){for(var i=this.adata,n=[],r=(t.type,0),o=i.length;r<o;r++){var a=i[r].rowData;n.push({type:"delete",rowData:a})}return this.adata=[],n},rollbackDelete:function(t,e){for(var i=this.ddata,n=[],r=(t.type,i.length-1);r>=0;r--){var o=i[r],a=(o.indx,o.rowIndx),s=o.rowData;n.push({type:"add",rowIndx:a,newRow:s})}return this.ddata=[],n},rollbackUpdate:function(t,e){for(var i=this.that,n=this.options.trackModel.dirtyClass,r=this.udata,o=[],a=0,s=r.length;a<s;a++){var l=r[a],d=l.recId,c=l.rowData,h={},u=l.oldRow;if(null!==d){var f=[];for(var p in u)h[p]=c[p],f.push(p);i.removeClass({rowData:c,dataIndx:f,cls:n,refresh:!1}),o.push({type:"update",rowData:c,newRow:u,oldRow:h})}}return this.udata=[],o},rollback:function(t){var e=this.that,i=e.options.dataModel,n=e.options.pageModel,r=!t||null===t.refresh||t.refresh,o=t&&null!==t.type?t.type:null,a=[],s=[],l=[],d=i.data;null!==o&&"update"!==o||(s=this.rollbackUpdate(n,d)),null!==o&&"delete"!==o||(a=this.rollbackDelete(n,d)),null!==o&&"add"!==o||(l=this.rollbackAdd(n,d)),e._digestData({history:!1,allowInvalid:!0,checkEditable:!1,source:"rollback",track:!1,addList:a,updateList:s,deleteList:l}),r&&e.refreshView({header:!1})},update:function(e){var i=this.that,n=this.options.trackModel.dirtyClass,r=e.rowData||i.getRowData(e),o=i.getRecId({rowData:r}),a=e.dataIndx,s=e.refresh,l=i.columns,d=i.getValueFromDataType,c=e.row,h=this.udata,u=h.slice(0),f=!1;if(null!==o){for(var p=0,g=h.length;p<g;p++){var v=h[p],m=v.oldRow;if(v.rowData===r){for(var a in f=!0,c){var w=l[a].dataType,x=d(x=c[a],w),y=d(y=m[a],w);if(m.hasOwnProperty(a)&&y===x){var C={rowData:r,dataIndx:a,refresh:s,cls:n};i.removeClass(C),delete m[a]}else{C={rowData:r,dataIndx:a,refresh:s,cls:n};i.addClass(C),m.hasOwnProperty(a)||(m[a]=r[a])}}t.isEmptyObject(m)&&u.splice(p,1);break}}if(!f){m={};for(var a in c){m[a]=r[a];C={rowData:r,dataIndx:a,refresh:s,cls:n};i.addClass(C)}C={rowData:r,recId:o,oldRow:m};u.push(C)}this.udata=u}}},i.getChanges=function(t){if(this.blurEditor({force:!0}),t){var e=t.format;if(e){if("byVal"===e)return this.iUCData.getChangesValue(t);if("raw"===e)return this.iUCData.getChangesRaw()}}return this.iUCData.getChanges()},i.rollback=function(t){this.blurEditor({force:!0}),this.iUCData.rollback(t)},i.isDirty=function(t){return this.iUCData.isDirty(t)},i.commit=function(t){this.iUCData.commit(t)},i.updateRow=function(t){var e,i=t.rowList||[{rowIndx:t.rowIndx,newRow:t.newRow||t.row,rowData:t.rowData,rowIndxPage:t.rowIndxPage}],n=[];if(this.normalizeList(i).forEach(function(t){var e,i=t.newRow,r=t.rowData,o=t.oldRow={};if(r){for(e in i)o[e]=r[e];n.push(t)}}),n.length){var r={source:t.source||"update",history:t.history,checkEditable:t.checkEditable,track:t.track,allowInvalid:t.allowInvalid,updateList:n};if(!1===this._digestData(r))return!1;!1!==t.refresh&&((e=(n=r.updateList).length)>1?this.refresh({header:!1}):1===e&&this.refreshRow({rowIndx:n[0].rowIndx}))}},i.getRecId=function(t){var e=this.options.dataModel;t.dataIndx=e.recIndx;var i=this.getCellData(t);return null===i?null:i},i.getCellData=function(t){var e=t.rowData||this.getRowData(t),i=t.dataIndx;return e?e[i]:null},i.getRowData=function(t){if(!t)return null;var e,i=t.rowData;if(null!==i)return i;if(null===(e=t.recId)){var n=null!==(n=t.rowIndx)?n:t.rowIndxPage+this.riOffset;return d=this.get_p_data()[n]}for(var r=this.options.dataModel,o=r.recIndx,a=r.data,s=0,l=a.length;s<l;s++){var d;if((d=a[s])[o]===e)return d}return null},i.addNodes=function(t,e){e=null===e?this.options.dataModel.data.length:e,this._digestData({addList:t.map(function(t){return{rowIndx:e++,newRow:t}}),source:"addNodes"}),this.refreshView()},i.deleteNodes=function(t){this._digestData({deleteList:t.map(function(t){return{rowData:t}}),source:"deleteNodes"}),this.refreshView()},i.moveNodes=function(t,e){var i=this.options,n=this.riOffset,r=i.dataModel.data;e=null===e?r.length:e,this._trigger("beforeMoveNode"),t.forEach(function(t){e=pq.moveItem(t,r,r.indexOf(t),e)}),r!==this.pdata&&(this.pdata=r.slice(n,i.pageModel.rPP+n)),this._trigger("moveNode"),this.refresh()},i.deleteRow=function(t){var e=this.normalizeList(t.rowList||[{rowIndx:t.rowIndx,rowIndxPage:t.rowIndxPage,rowData:t.rowData}]);if(!e.length)return!1;this._digestData({source:t.source||"delete",history:t.history,track:t.track,deleteList:e}),!1!==t.refresh&&this.refreshView({header:!1})},i.addRow=function(t){var e,i,n=this.riOffset,r=this.options.dataModel,o=r.data=r.data||[];return t.rowData&&(t.newRow=t.rowData),null!==t.rowIndxPage&&(t.rowIndx=t.rowIndxPage+n),!(!(i=t.rowList||[{rowIndx:t.rowIndx,newRow:t.newRow}]).length||!1===this._digestData({source:t.source||"add",history:t.history,track:t.track,checkEditable:t.checkEditable,addList:i}))&&(!1!==t.refresh&&this.refreshView({header:!1}),null===(e=i[0].rowIndx)?o.length-1:e)}}(jQuery),window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){return setTimeout(t,10)},window.cancelAnimationFrame=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||function(t){clearTimeout(t)},function(t){var e=t.paramquery;function i(t){this.that=t,t.on("mousePQUp",this.onMousePQUp.bind(this)).on("cellClick",this.onCellClick.bind(this)).on("cellMouseDown",this.onCellMouseDown.bind(this)).on("cellMouseEnter",this.onCellMouseEnter.bind(this)).on("refresh refreshRow",this.onRefresh.bind(this))}e.cMouseSelection=i,i.prototype=t.extend({onCellMouseDown:function(t,e){if(!t.isDefaultPrevented()){var i=this.that,n=e.rowIndx,r=i.iSelection,o=e.colIndx,a=i.options.selectionModel,s=a.type,l=a.mode,d=r.addressLast();if("cell"===s){if(null!==o){if(-1===o){if(!a.row)return;o=void 0}if(t.shiftKey&&"single"!==l&&d&&null!==d.firstR){var c=d.firstR,h=d.firstC;r.resizeOrReplace({r1:c,c1:h,r2:n,c2:o,firstR:c,firstC:h})}else pq.isCtrl(t)&&"single"!==l?(this.mousedown={r1:n,c1:o},i.Selection().add({r1:n,c1:o,firstR:n,firstC:o})):(this.mousedown={r1:n,c1:o},r.clearOther({r1:n,c1:o}),r.resizeOrReplace({r1:n,c1:o,firstR:n,firstC:o}));return i.focus(e),!0}}else i.focus(e)}},onCellMouseEnter:function(t,e){var i=this.that,n=i.options.selectionModel,r=n.type,o=this.mousedown,a=n.mode;if(o&&"single"!==a){if("cell"===r){var s=o.r1,l=o.c1,d=e.rowIndx,c=e.colIndx,h=i.Selection();i.scrollCell({rowIndx:d,colIndx:c}),h.resizeOrReplace({r1:s,c1:l,r2:d,c2:c})}i.focus(e)}},onCellClick:function(t,e){var i,n=this.that,r=n.options.selectionModel,o="single"===r.mode,a=r.toggle,s=n.iRows;if("row"===r.type){if(!r.row&&-1===e.colIndx)return;i=s.isSelected(e),o&&!i||a||!pq.isCtrl(t)?!o&&t.shiftKey?s.extend(e):!o||i&&a?(e.isFirst=!0,s[a?"toggle":"replace"](e)):i||s.replace(e):(e.isFirst=!0,s.toggle(e))}},onMousePQUp:function(){this.mousedown=null},onRefresh:function(){var t=this.that;this.setTimer(function(){t.element&&t.focus()},300)}},new e.cClass)}(jQuery),function(t){var e=null,i=!1,n="pq-grid-excel",r=t.paramquery,o=r.pqGrid.prototype;t.extend(o.options,{copyModel:{on:!0,render:!1,header:!0,zIndex:1e4},cutModel:{on:!0},pasteModel:{on:!0,compare:"byVal",select:!0,validate:!0,allowInvalid:!0,type:"replace"}}),t.extend(o,{_setGlobalStr:function(t){a.clip=t},canPaste:function(){return!!r.cExcel.clip},clearPaste:function(){r.cExcel.clip=""},copy:function(){return this.iSelection.copy()},cut:function(){return this.iSelection.copy({cut:!0,source:"cut"})},paste:function(t){(e=new a(this)).paste(t),e=null},clear:function(){var t=this.iSelection;t.address().length?t.clear():this.iRows.toRange().clear()}});var a=r.cExcel=function(t,e){this.that=t};a.clip="",a.prototype={createClipBoard:function(){var e=this.that,i=t("#pq-grid-excel-div"),r=e.options.copyModel,o=t("#"+n);0===o.length&&(i=t("<div id='pq-grid-excel-div'  style='position:fixed;top:20px;left:20px;height:1px;width:1px;overflow:hidden;z-index:"+r.zIndex+";'/>").appendTo(document.body),(o=t("<textarea id='"+n+"' autocomplete='off' spellcheck='false' style='overflow:hidden;height:10000px;width:10000px;opacity:0' />").appendTo(i)).css({opacity:0}).on("keyup",function(t){pq.isCtrl(t)&&e.element&&e._trigger("keyUp",t)})),o.on("focusin",function(t){t.stopPropagation()}),o.select()},destroyClipBoard:function(){this.clearClipBoard();var e=this.that,i=t(window).scrollTop(),n=t(window).scrollLeft();e.focus();var r=t(window).scrollTop(),o=t(window).scrollLeft();i===r&&n===o||window.scrollTo(n,i)},clearClipBoard:function(){t("#"+n).val("")},copy:function(t){var e=this.that,i=e.iSelection;if(i.address().length)return i.copy(t);e.iRows.toRange().copy(t)},getRows:function(t){return(t=(t=t.replace(/\n$/,"")).replace(/(^|\t|\n)"(?=[^\t]*?[\r\n])([^"]|"")*"(?=$|\t|\n)/g,function(t){return t.replace(/(\r\n|\n)/g,"\r").replace(/^(\t|\n)?"/,"$1").replace(/"$/,"").replace(/""/g,'"')})).split("\n")},paste:function(e){e=e||{};var i=this.that,n=e.dest,r=e.clip,o=e.text||(r?r.length?r.val():"":a.clip),s=this.getRows(o),l=s.length,d=i.colModel,c=i.options,h=i.readCell,u=c.pasteModel,f="row",p=!1,g=d.length;if(u.on&&0!==o.length&&0!==l){for(var v=0;v<l;v++)s[v]=s[v].split("\t");var m,w,x,y,C,b,I=u.type,_=(n?i.Range(n):i.Selection()).address(),q=(_.length?_:i.iRows.toRange().address())[0],D={rows:s,areas:[q]};if(!1===i._trigger("beforePaste",null,D))return!1;q&&i.getRowData({rowIndx:q.r1})?(f="row"===q.type?"row":"cell",m=q.r1,x=q.r2,w=q.c1,y=q.c2):(f="cell",m=0,x=0,w=0,y=0),"replace"===I?(C=m,b=x-m+1<l?"extend":"repeat"):"append"===I?(C=x+1,b="extend"):"prepend"===I&&(C=m,b="extend");var R,M,T,k="extend"===b?l:x-m+1,E=0,S=[],P=[],$=0;for(v=0;v<k;v++){var A=s[E],H=v+C,F="replace"===I?i.getRowData({rowIndx:H}):null,O=F?{}:null,V={};void 0===A&&"repeat"===b&&(A=s[E=0]),E++;var L=A,N=L.length;if(!M)if("cell"===f){if(M="extend"===(R=y-w+1<N?"extend":"repeat")?N:y-w+1,isNaN(M))throw"lenH NaN. assert failed.";M+w>g&&(M=g-w)}else M=g,w=0;var B=0,U=0,z=0;for(T=M,U=0;U<T;U++){B>=N&&(B=0);var j=d[U+w],W=L[B],G=j.dataIndx;!1!==j.copy?(B++,V[G]=W,O&&(O[G]=h(F,j))):(z++,"extend"===R&&T+w<g&&T++)}!1===t.isEmptyObject(V)&&(null===F?(p=!0,S.push({newRow:V,rowIndx:H})):P.push({newRow:V,rowIndx:H,rowData:F,oldRow:O}),$++)}var K={addList:S,updateList:P,source:"paste",allowInvalid:u.allowInvalid,validate:u.validate};i._digestData(K),i[p?"refreshView":"refresh"]({header:!1}),u.select&&i.Range({r1:C,c1:w,r2:C+$-1,c2:"extend"===R?w+M-1+z:y}).select(),i._trigger("paste",null,D)}}},t(document).unbind(".pqExcel").bind("keydown.pqExcel",function(r){if(pq.isCtrl(r)){var o=t(r.target);if(!o.hasClass("pq-grid-cell")&&!o.is("#"+n)&&!o.hasClass("pq-body-outer"))return;var l,d=o.closest(".pq-grid");if(e||o.length&&d.length){if(!e){try{if((l=d.pqGrid("instance")).options.selectionModel.native)return!0}catch(t){return!0}(e=new a(l,o)).createClipBoard()}if("67"===r.keyCode||"99"===r.keyCode)e.copy({clip:t("#"+n)});else if("88"===r.keyCode)e.copy({cut:!0,clip:t("#"+n)});else if("86"===r.keyCode||"118"===r.keyCode)i=!0,e.clearClipBoard(),window.setTimeout(function(){e&&(e.paste({clip:t("#"+n)}),e.destroyClipBoard(),e=null),i=!1},3);else{var c=t("#"+n);if(c.length)document.activeElement===c[0]&&e.that.onKeyPressDown(r)}}}else{var h=r.keyCode,u=t.ui.keyCode;if(h===u.UP||h===u.DOWN||h===u.LEFT||h===u.RIGHT||h===u.PAGE_UP||h===u.PAGE_DOWN){if(s)return!1;((o=t(r.target)).hasClass("pq-grid-row")||o.hasClass("pq-grid-cell"))&&(s=!0)}}}).bind("keyup.pqExcel",function(n){var r=n.keyCode;if(i||!e||pq.isCtrl(n)||-1===t.inArray(r,[17,91,93,224])||(e.destroyClipBoard(),e=null),s){var o=t(n.target);o.hasClass("pq-grid-row")||o.hasClass("pq-grid-cell")||(s=!1)}});var s=!1}(jQuery),function(t){var e=t.paramquery,i=e.pqGrid.prototype.options;i.historyModel=i.historyModel||{on:!0,checkEditable:!0,checkEditableAdd:!1,allowInvalid:!0},(e.cHistory=function(t){var e=this;this.that=t,this.options=t.options,this.records=[],this.counter=0,this.id=0,t.on("keyDown",function(t,i){return e.onKeyDown(t,i)}).on("dataAvailable",function(t,i){"filter"!==i.source&&e.reset()})}).prototype={onKeyDown:function(t,e){var i="90",n="89",r=pq.isCtrl(t);return r&&t.keyCode===i?(this.undo(),!1):r&&t.keyCode===n?(this.redo(),!1):void 0},resetUndo:function(){if(0===this.counter)return!1;this.counter=0,this.that._trigger("history",null,{type:"resetUndo",num_undo:0,num_redo:this.records.length-this.counter,canUndo:!1,canRedo:!0})},reset:function(){if(0===this.counter&&0===this.records.length)return!1;this.records=[],this.counter=0,this.id=0,this.that._trigger("history",null,{num_undo:0,num_redo:0,type:"reset",canUndo:!1,canRedo:!1})},increment:function(){var t=this.records,e=t.length;if(e){var i=t[e-1].id;this.id=i+1}else this.id=0},push:function(e){var i=this.canRedo(),n=this.records,r=this.counter;n.length>r&&n.splice(r,n.length-r),n[r]=t.extend({id:this.id},e),this.counter++;var o,a,s=this.that;1===this.counter&&(o=!0),i&&this.counter===n.length&&(a=!1),s._trigger("history",null,{type:"add",canUndo:o,canRedo:a,num_undo:this.counter,num_redo:0})},canUndo:function(){return this.counter>0},canRedo:function(){return this.counter<this.records.length},processCol:function(t,e){var i=this.that;if(t.length){var n="add"===t.type;i[(n=e?n:!n)?"addColumn":"deleteColumn"]({colList:t,history:!1})}},undo:function(){var t=this.canRedo(),e=this.that,i=this.options.historyModel,n=this.records;if(!(this.counter>0))return!1;this.counter--;var r,o,a=n[this.counter],s=a.colList||[],l=(a.id,a.updateList.map(function(t){return{rowIndx:e.getRowIndx({rowData:t.rowData}).rowIndx,rowData:t.rowData,oldRow:t.newRow,newRow:t.oldRow}})),d=a.addList.map(function(t){return{rowData:t.newRow}}),c=a.deleteList.map(function(t){return{newRow:t.rowData,rowIndx:t.rowIndx}});if(s.length)this.processCol(s);else{e._digestData({history:!1,source:"undo",checkEditable:i.checkEditable,checkEditableAdd:i.checkEditableAdd,allowInvalid:i.allowInvalid,addList:c,updateList:l,deleteList:d});e[c.length||d.length?"refreshView":"refresh"]({source:"undo",header:!1})}return!1===t&&(r=!0),0===this.counter&&(o=!1),e._trigger("history",null,{canUndo:o,canRedo:r,type:"undo",num_undo:this.counter,num_redo:this.records.length-this.counter}),!0},redo:function(){var t=this.canUndo(),e=this.that,i=this.options.historyModel,n=this.counter,r=this.records;if(n===r.length)return!1;var o,a,s=r[n],l=s.colList||[],d=(s.id,s.updateList.map(function(t){return{rowIndx:e.getRowIndx({rowData:t.rowData}).rowIndx,rowData:t.rowData,newRow:t.newRow,oldRow:t.oldRow}})),c=s.deleteList.map(function(t){return{rowData:t.rowData}}),h=s.addList.map(function(t){return{newRow:t.newRow,rowIndx:t.rowIndx}});if(l.length)this.processCol(l,!0);else{e._digestData({history:!1,source:"redo",checkEditable:i.checkEditable,checkEditableAdd:i.checkEditableAdd,allowInvalid:i.allowInvalid,addList:h,updateList:d,deleteList:c});e[h.length||c.length?"refreshView":"refresh"]({source:"redo",header:!1})}return this.counter<r.length&&this.counter++,!1===t&&(o=!0),this.counter===this.records.length&&(a=!1),e._trigger("history",null,{canUndo:o,canRedo:a,type:"redo",num_undo:this.counter,num_redo:this.records.length-this.counter}),!0}};var n=e.pqGrid.prototype;n.history=function(t){var e=t.method;return this.iHistory[e](t)},n.History=function(){return this.iHistory}}(jQuery),function(t){var e=t.paramquery;pq.filter={dpBeforeShow:function(e,i,n){return function(){var r,o,a=e.getDataCascade(i);a.length&&(r=""===a[0][i]?a[1][i]:a[0][i],o=a[a.length-1][i]),t(this).datepicker("option","defaultDate",new Date(1===n?o:r))}},datepicker:function(e){var i=e.column,n=i.dataIndx,r=this,o=e.filterUI,a=e.$editor,s=i.dataType,l={dateFormat:o.format||i.format,changeYear:!0,changeMonth:!0};if("date"===s)return a.each(function(e,i){var a=t.extend({},l,1===e&&o.dpOptions2||o.dpOptions);a.defaultDate||(a.beforeShow=a.beforeShow||pq.filter.dpBeforeShow(r,n,e)),t(i).datepicker(a)}),!0},filterFnEq:function(e,i){var n=(e.column||{}).dataType;return"date"===n?this.filterFnTD(e,i):"bool"===n?{type:"checkbox"}:t.extend({maxCheck:1},this.filterFnSelect(e,i))},filterFnSelect:function(t,e){var i=t.column.dataIndx,n=t.indx;return{type:"select",style:"padding-right:16px;cursor:default;",attr:"readonly",valueIndx:i,labelIndx:i,options:this.options,init:0===n?this.rangeInit.bind(e):function(){}}},filterFnT:function(){return{type:"textbox",attr:"autocomplete='off'"}},filterFnTD:function(){return{type:"textbox",attr:"autocomplete='off'",init:pq.filter.datepicker}},getVal:function(t){var e=(t.crules||[])[0]||{};return[e.value,e.value2,e.condition]},setVal:function(t,e){var i=t.crules=t.crules||[];return i[0]=i[0]||{},i[0].value=e,e}},t.extend(pq.filter,{conditions:{begin:{string:1,numberList:1,dateList:1,filterFn:pq.filter.filterFnT},between:{stringList:1,date:1,number:1,filter:{attr:"autocomplete='off'",type:"textbox2",init:pq.filter.datepicker}},contain:{string:1,numberList:1,dateList:1,filterFn:pq.filter.filterFnT},equal:{string:1,bool:1,date:1,number:1,filterFn:pq.filter.filterFnEq},empty:{string:1,bool:1,date:1,number:1,nr:1},end:{string:1,numberList:1,dateList:1,filterFn:pq.filter.filterFnT},great:{stringList:1,number:1,date:1,filterFn:pq.filter.filterFnTD},gte:{stringList:1,number:1,date:1,filterFn:pq.filter.filterFnTD},less:{stringList:1,number:1,date:1,filterFn:pq.filter.filterFnTD},lte:{stringList:1,number:1,date:1,filterFn:pq.filter.filterFnTD},notbegin:{string:1,numberList:1,dateList:1,filterFn:pq.filter.filterFnT},notcontain:{string:1,numberList:1,dateList:1,filterFn:pq.filter.filterFnT},notequal:{string:1,date:1,number:1,bool:1,filterFn:pq.filter.filterFnEq},notempty:{string:1,bool:1,date:1,number:1,nr:1},notend:{string:1,numberList:1,dateList:1,filterFn:pq.filter.filterFnT},range:{cascade:1,string:1,number:1,date:1,bool:1,filterFn:pq.filter.filterFnSelect},regexp:{string:1,numberList:1,dateList:1,filterFn:pq.filter.filterFnT}},getConditionsCol:function(t,e){var i=e.conditionList||function(e){var i=e.getConditionsDT(pq.getDataType(t));return i.sort(),i}(this),n=e.conditionExclude,r={};return n&&(n.forEach(function(t){r[t]=1}),i=i.filter(function(t){return!r[t]})),i},getConditionsDT:function(t){var e,i,n,r=[],o=this.conditions;for(e in o)n=(i=o[e])[t+"List"],(i[t]&&0!==n||n)&&r.push(e);return r},getFilterUI:function(e,i){var n=e.column,r=n.filterFn,o=(0===e.indx?n.filter:{})||{},a=this.conditions[e.condition]||{},s=a.filterFn,l=a.filter||{};delete o.type,r=r&&r.call(i,e)||{},s=s&&s.call(this,e,i)||{};var d=t.extend({},l,s,o,r);return d.condition=e.condition,d.init=[],d.options=[],[r,o,s,l].forEach(function(t){t.init&&d.init.push(t.init),t.options&&d.options.push(t.options)}),d},options:function(t){var e=t.column,i=t.filterUI,n=i.groupIndx,r=e.dataIndx;return this.getDataCascade(r,n,i.diExtra)},getOptions:function(t,e,i){for(var n,r,o=e.options,a=t.dataIndx,s={column:t,dataIndx:a,filterUI:e,condition:e.condition},l=0,d=o.length;l<d;l++)if((n=o[l])&&(r="function"==typeof n?n.call(i,s):n))return r=i.getPlainOptions(r,a),r=i.removeNullOptions(r,e.dataIndx||a,e.groupIndx);return[]},rangeInit:function(e){var i=this,n=e.column,r=e.$editor,o=e.headMenu,a=e.filterUI;o||r.parent().off("click keydown").on("click keydown",function(o){if("keydown"!==o.type||o.keyCode===t.ui.keyCode.DOWN){var s=i.uuid+"_"+n.dataIndx;if(!t("#"+s).length){var l=new pq.cFilterMenu.select(i,n),d=t("<div id='"+s+"' style='width:270px;' class='pq-theme'><div></div></div>").appendTo(document.body),c=d.children();pq.makePopup(d[0],r),l.create(c,a),d.position({my:"left top",at:"left bottom",of:e.$editor})}}})},getType:function(t,e){var i=this.conditions[t]||{},n=i.filterFn;return(i.filter||{}).type||(n?n.call(this,{condition:t,column:e}):{}).type}});var i=function(t){this.that=t,t.on("load",this.onLoad.bind(this)).on("filter clearFilter",this.onFilterChange.bind(this))};e.cFilterData=i;var n=i.conditions={equal:function(t,e){if(t===e)return!0},notequal:function(t,e){return!n.equal(t,e)},contain:function(t,e){if(-1!==(t+"").indexOf(e))return!0},notcontain:function(t,e){return!n.contain(t,e)},empty:function(t){if(0===t.length)return!0},notempty:function(t){return!n.empty(t)},begin:function(t,e){if(0===(t+"").indexOf(e))return!0},notbegin:function(t,e){return!n.begin(t,e)},end:function(t,e){var i=(t+="").lastIndexOf(e+="");if(-1!==i&&i+e.length===t.length)return!0},notend:function(t,e){return!n.end(t,e)},regexp:function(t,e){if(e.test(t))return e.lastIndex=0,!0},great:function(t,e){if(t>e)return!0},gte:function(t,e){if(t>=e)return!0},between:function(t,e,i){if(t>=e&&t<=i)return!0},range:function(e,i){if(-1!==t.inArray(e,i))return!0},less:function(t,e){if(t<e)return!0},lte:function(t,e){if(t<=e)return!0}};i.convert=function(t,e){return null===t||""===t?"":("string"===e?t=(t+"").trim().toUpperCase():"date"===e?t=Date.parse(t):"number"===e?1*t===t&&(t*=1):"bool"===e&&(t=String(t).toLowerCase()),t)},i.convertEx=function(t,e,i,n){var r=pq.getDataType({dataType:e}),o=pq.filter.conditions[i];return o[r]?this.convert(t,r):o.string?(n&&(t=pq.format(n,t)),"regexp"===i?t:this.convert(t,"string")):o.number?this.convert(t,"number"):void 0},i.prototype={addMissingConditions:function(t){var e=this.that;t.forEach(function(t){var i=e.getColumn({dataIndx:t.dataIndx}).filter||{};t.condition=void 0===t.condition?pq.filter.getVal(i)[2]:t.condition})},clearFilters:function(t){t.forEach(function(t){var e=t.filter,i=pq.filter.conditions;e&&(e.crules||[]).forEach(function(t){(i[t.condition]||{}).nr&&(t.condition=void 0),t.value=t.value2=void 0})})},compatibilityCheck:function(t){var e,i=t.data,n="Incorrect filter parameters. Please check upgrade guide";if(i)if(e=i[0]){if(e.hasOwnProperty("dataIndx")&&e.hasOwnProperty("value"))throw n}else if(!t.rules)throw n},copyRuleToColumn:function(t,e,i){var n=e.filter=e.filter||{},r=t.crules||[],o=r[0],a=o?o.condition:t.condition,s=o?o.value:t.value,l=o?o.value2:t.value2;"remove"===i?(n.on=!1,n.crules=a?[{condition:a,value:"range"===a?[]:void 0}]:void 0):(n.on=!0,n.mode=t.mode,n.crules=o?r:[{condition:a,value:s,value2:l}])},filter:function(t){t=t||{},this.compatibilityCheck(t);var e,i,n=this.that,r=n.options,o=!1,a=t.data,s=t.rules=t.rules||(t.rule?[t.rule]:[]),l=!a,d=r.dataModel,c=r.filterModel,h=t.mode||c.mode,u=t.oper,f="replace"===u,p=l?n.colModel:this.getCMFromRules(s),g=0,v=s.length;if("remove"!==u&&this.addMissingConditions(s),l){if(!1===n._trigger("beforeFilter",null,t))return;for(null!==t.header&&(o=t.header),f&&this.clearFilters(p);g<v;g++)e=s[g],i=n.getColumn({dataIndx:e.dataIndx}),this.copyRuleToColumn(e,i,u)}else for(;g<v;g++)e=s[g],i=p[g],this.copyRuleToColumn(e,i);var m={header:o,CM:p,data:a,rules:s,mode:h};if("remote"!==d.location||"local"===c.type)return m.source="filter",m.trigger=!1,n._onDataAvailable(m);n.remoteRequest({apply:l,CM:p,callback:function(){return n._onDataAvailable(m)}})},filterLocalData:function(t){t=t||{};var e,i,n=this.that,r=t.data,o=!r,a=o?n.colModel:t.CM,s=this.getRulesFromCM({CM:a,apply:o}),l=n.options,d=l.dataModel,c=n.iSort,h=r||d.data,u=d.dataUF=d.dataUF||[],f=[],p=[],g=l.filterModel,v=t.mode||g.mode;if(o)if(u.length){i=!0;for(var m=0,w=u.length;m<w;m++)h.push(u[m]);u=d.dataUF=[]}else{if(!s.length)return{data:h,dataUF:u};c.saveOrder()}if(g.on&&v&&s&&s.length){if(h.length)if(e={filters:s,mode:v,data:h},!1===n._trigger("customFilter",null,e))f=e.dataTmp,p=e.dataUF;else for(m=0,w=h.length;m<w;m++){var x=h[m];this.isMatchRow(x,s,v)?f.push(x):p.push(x)}h=f,u=p,0===c.readSorter().length&&(h=c.sortLocalData(h)),o&&(d.data=h,d.dataUF=u)}else i&&o&&(e={data:h},!1===n._trigger("clearFilter",null,e)&&(h=e.data),0===c.readSorter().length&&(h=c.sortLocalData(h)),d.data=h,n._queueATriggers.filter={ui:{type:"local"}});return o&&(n._queueATriggers.filter={ui:{type:"local",rules:s}}),{data:h,dataUF:u}},_getRulesFromCM:function(e,n,r,o,a,s,l){if("between"===r)""===o||null===o?o=l(a,s,r="lte"):""===a||null===a?o=l(o,s,r="gte"):(o=l(o,s,r),a=l(a,s,r));else if("regexp"===r){if("remote"===e)o=o.toString();else if("string"==typeof o)try{var d=n.modifiers||"gi";o=new RegExp(o,d)}catch(t){o=/.*/}}else if("range"===r||t.isArray(o)){if(null===o)return;if("function"==typeof o.push){if(0===o.length)return;for(var c=0,h=(o=o.slice()).length;c<h;c++)o[c]=l(o[c],s,r)}}else r&&(o=l(o,s,r),null!==a&&(a=l(a,s,r)));return[o,a,"remote"===e?"":((n.conditions||{})[r]||{}).compare||pq.filter.conditions[r].compare||i.conditions[r],r]},getRulesFromCM:function(t){var i=t.CM;if(!i)throw"CM N/A";for(var n=this,r=i.length,o=0,a=t.location,s="remote"===a,l=[],d=e.cFilterData,c=function(t,e,i){return s?(t=null===t?"":t).toString():d.convertEx(t,e,i)};o<r;o++){var h=i[o],u=h.filter;if(u){var f,p,g,v,m,w,x=h.dataIndx,y=h.dataType,C=u.crules||[u],b=[];y=y&&"stringi"!==y&&"function"!=typeof y?y:"string",C.forEach(function(t){v=t.condition,p=t.value,g=t.value2,v&&n.isCorrect(v,p,g)&&(w=n._getRulesFromCM(a,u,v,p,g,y,c))&&(p=w[0],g=w[1],m=w[2],b.push({condition:w[3],value:p,value2:g,cbFn:m}))}),b.length&&(f={dataIndx:x,dataType:y},s&&1===b.length?(f.value=b[0].value,f.value2=b[0].value2,f.condition=b[0].condition):(f.crules=b,f.mode=u.mode,s||(f.column=h)),l.push(f))}}return(t.apply||s)&&this.sortRulesAndFMIndx(l),l},getCMFromRules:function(t){var e=this.that;return t.map(function(t){var i=e.getColumn({dataIndx:t.dataIndx});return JSON.parse(JSON.stringify(i,function(t,e){if("parent"!==t)return e}))})},getQueryStringFilter:function(){var t,e=this.that,i=e.options,n=i.stringify,r=i.filterModel,o=r.mode,a=e.colModel,s=r.newDI||[],l=this.getRulesFromCM({CM:a,location:"remote"}),d="";return r&&r.on&&l&&(l.length?(t={mode:o,data:l},d=!1===n?t:JSON.stringify(t)):(d="",s.length&&e._trigger("clearFilter"))),d},isCorrect:function(t,e,i){var n=pq.filter.conditions[t];if(n)return!!(null!==e&&""!==e||null!==i&&""!==i||n.nr);throw"filter condition NA"},isMatchCell:function(t,e){for(var n,r,o,a,s,l,d=t.dataIndx,c=t.column,h=t.dataType,u=t.mode,f=[],p=t.crules,g=p.length,v=e[d],m=0;m<g;m++)o=(s=p[m]).condition,n=s.value,r=s.value2,a=s.cbFn,o&&(l="regexp"===o?null===v?"":v:i.convertEx(v,h,o,c),f.push(!!a(l,n,r)));if(g=f.length,"AND"===u){for(m=0;m<g;m++)if(!f[m])return!1;return!0}for(m=0;m<g;m++)if(f[m])return!0;return!1},isMatchRow:function(t,e,i){var n,r,o=0,a=e.length,s="AND"===i,l=!s;if(0===a)return!0;for(;o<a;o++){if(n=e[o],(r=this.isMatchCell(n,t))&&(n.found=!0),l&&r)return!0;if(s&&!r)return!1}return s},onFilterChange:function(){var t=this.that,e=t.options,i=t.columns,n=e.filterModel,r="remote"===n.type,o=n.oldDI||[],a=!e.dataModel.data.length,s="pq-col-filtered",l=r||a,d=(n.rules||[]).reduce(function(t,e){return(e.found||l)&&t.push(e.dataIndx),t},[]);o.forEach(function(e){var n=t.getCellHeader({dataIndx:e}),r=i[e];n.length&&(n.removeClass(s),t.getCellFilter({dataIndx:e}).removeClass(s)),r.clsHead=(r.clsHead||"").split(" ").filter(function(t){return t!==s}).join(" ")}),d.forEach(function(e){var n=t.getCellHeader({dataIndx:e}),r=i[e];n.length&&(n.addClass(s),t.getCellFilter({dataIndx:e}).addClass(s)),r.clsHead=(r.clsHead||"")+" "+s}),n.oldDI=n.newDI=d},onLoad:function(){var t=this.that.options.dataModel.dataUF;t&&(t.length=0)},sortRulesAndFMIndx:function(t){var e=this.that.options.filterModel,i=e.newDI;t.sort(function(t,e){var n=t.dataIndx,r=e.dataIndx,o=i.indexOf(n),a=i.indexOf(r);return o>=0&&a>=0?o-a:o>=0?-1:a>=0?1:0}),e.rules=t}}}(jQuery),function(t){var e=t.paramquery,i=e.cSort=function(t){this.that=t,this.sorters=[],this.tmpPrefix="pq_tmp_",this.cancel=!1};e.pqGrid.prototype.sort=function(t){if((t=t||{}).data)return this.iSort._sortLocalData(t.sorter,t.data);var e=this,i=this.options,n=i.dataModel,r=n.data,o=i.sortModel.type;if(r&&r.length||"local"!==o){var a,s=i.editModel,l=this.iSort,d=l.getSorter(),c=t.evt,h=null===t.single?l.readSingle():t.single,u=l.readCancel();if(t.sorter?t.addon?(t.single=h,t.cancel=u,a=l.addon(t)):a=t.sorter:a=l.readSorter(),a.length||d.length){s.indices&&e.blurEditor({force:!0});var f={dataIndx:a.length?a[0].dataIndx:null,oldSorter:d,sorter:a,source:t.source,single:h};!1!==e._trigger("beforeSort",c,f)?(l.resumeSort(),"local"===o&&l.saveOrder(),l.setSorter(a),l.setSingle(h),l.writeSorter(a),l.writeSingle(h),"local"===o?(n.data=l.sortLocalData(r,!t.skipCustomSort),this._queueATriggers.sort={evt:c,ui:f},!1!==t.refresh&&this.refreshView()):"remote"===o&&(this._queueATriggers.sort={evt:c,ui:f},t.initByRemote||this.remoteRequest({initBySort:!0,callback:function(){e._onDataAvailable()}}))):l.cancelSort()}}},i.prototype={addon:function(e){var i=(e=e||{}).sorter[0],n=i.dataIndx,r=i.dir,o=e.single,a=e.cancel,s=this.readSorter(),l=s[0];if(null===o)throw"sort single N/A";if(null!==n)if(o&&!e.tempMultiple)if((l=(s=s.length?[s[0]]:[])[0])&&l.dataIndx===i.dataIndx){var d=l.dir,c="up"===d?"down":a&&"down"===d?"":"up";""===c?s.length--:l.dir=c}else c=r||"up",s[0]=t.extend({},i,{dir:c});else{var h=this.inSorters(s,n);h>-1?"up"===(d=s[h].dir)?s[h].dir="down":a&&"down"===d?s.splice(h,1):1===s.length?s[h].dir="up":s.splice(h,1):s.push(t.extend({},i,{dir:"up"}))}return s},cancelSort:function(){this.cancel=!0},resumeSort:function(){this.cancel=!1},readSorter:function(){var t=this.that,e=t.columns,i=(t.options.sortModel.sorter||[]).filter(function(t){return!!e[t.dataIndx]});return i=pq.arrayUnique(i,"dataIndx")},setSingle:function(t){this.single=t},getSingle:function(){return this.single},readSingle:function(){return this.that.options.sortModel.single},setCancel:function(t){this.cancel=t},readCancel:function(){return this.that.options.sortModel.cancel},saveOrder:function(t){var e,i=this.that;if(!(i.options.dataModel.dataUF||[]).length&&!this.getSorter().length)for(var n=0,r=(t=i.get_p_data()).length;n<r;n++)(e=t[n])&&(e.pq_order=n)},getCancel:function(){return this.cancel},getQueryStringSort:function(){if(this.cancel)return"";var t=this.that,e=this.sorters,i=t.options.stringify;return e.length?!1===i?e:JSON.stringify(e):""},getSorter:function(){return this.sorters},setSorter:function(t){this.sorters=t.slice(0)},inSorters:function(t,e){for(var i=0;i<t.length;i++)if(t[i].dataIndx===e)return i;return-1},sortLocalData:function(t,e){var i=this.sorters;return i.length||t.length&&null!==t[0].pq_order&&(i=[{dataIndx:"pq_order",dir:"up",dataType:"integer"}]),this._sortLocalData(i,t,e)},compileSorter:function(t,e){var i=this.that,r=i.columns,o=i.options,a=[],s=[],l=[],d=this.tmpPrefix,c=o.sortModel,h=c.useCache,u=c.ignoreCase,f=t.length;e=e||o.dataModel.data;for(var p=0;p<f;p++){var g=t[p],v=g.sortIndx||g.dataIndx,m=r[v]||{},w="up"===(g.dir=g.dir||"up")?1:-1,x=m.sortType,y=(x=pq.getFn(x),"string"===(y=m.dataType||g.dataType||"string")&&u?"stringi":y),C=h&&"date"===y,b=C?d+v:v;s[p]=b,l[p]=w,a[p]=x?function(t,e){return function(i,n,r,o){return e(i,n,r,o,t)}}(x,n.sort_sortType):"integer"===y?n.sort_number:"float"===y?n.sort_number:"function"==typeof y?function(t,e){return function(i,n,r,o){return e(i,n,r,o,t)}}(y,n.sort_dataType):"date"===y?n["sort_date"+(C?"_fast":"")]:"bool"===y?n.sort_bool:"stringi"===y?n.sort_locale:n.sort_string,C&&this.addCache(e,y,v,b)}return this._composite(a,s,l,f)},_composite:function(t,e,i,n){return function(r,o){for(var a=0,s=0;s<n&&0===(a=t[s](r,o,e[s],i[s]));s++);return a}},_sortLocalData:function(t,e,i){if(!e)return[];if(!e.length||!t||!t.length)return e;var n=this.that,r=n.options.sortModel,o=this.compileSorter(t,e),a={sort_composite:o,data:e,sorter:t};return i&&!1===n._trigger("customSort",null,a)?e=a.data:e.sort(o),r.useCache&&this.removeCache(t,e)(),e},addCache:function(t,e,i,r){for(var o=n["get_"+e],a=t.length;a--;){var s=t[a];s[r]=o(s[i])}},removeCache:function(t,e){var i=this.tmpPrefix;return function(){for(var n=t.length;n--;){var r=t[n],o=i+r.dataIndx,a=e.length;if(a&&e[0].hasOwnProperty(o))for(;a--;)delete e[a][o]}}},writeCancel:function(t){this.that.options.sortModel.cancel=t},writeSingle:function(t){this.that.options.sortModel.single=t},writeSorter:function(t){this.that.options.sortModel.sorter=t}};var n={get_date:function(t){var e;return t?isNaN(e=Date.parse(t))?0:e:0},sort_number:function(t,e,i,n){var r=t[i],o=e[i];return((r=r?1*r:0)-(o=o?1*o:0))*n},sort_date:function(t,e,i,n){var r=t[i],o=e[i];return((r=r?Date.parse(r):0)-(o=o?Date.parse(o):0))*n},sort_date_fast:function(t,e,i,n){return(t[i]-e[i])*n},sort_dataType:function(t,e,i,n,r){return r(t[i],e[i])*n},sort_sortType:function(t,e,i,n,r){return r(t,e,i)*n},sort_string:function(t,e,i,n){var r=t[i]||"",o=e[i]||"",a=0;return r>o?a=1:r<o&&(a=-1),a*n},sort_locale:function(t,e,i,n){var r=t[i]||"",o=e[i]||"";return r.localeCompare(o)*n},sort_bool:function(t,e,i,n){var r=t[i],o=e[i],a=0;return r&&!o||!1===r&&null===o?a=1:(o&&!r||!1===o&&null===r)&&(a=-1),a*n}};pq.sortObj=n}(jQuery),function(t){function e(t,e,i){var n=0,r=e,o=t.length;for(i=i>o?o:i;r<i;r++)!0!==t[r].pq_hidden&&n++;return n}function i(t){this.that=t,this.mc=null;var e=this;t.on("dataReady columnOrder groupShowHide",function(i,n){t.options.mergeCells&&"pager"!==n.source&&e.init()})}t.paramquery.pqGrid.prototype.calcVisibleRows=e,t.paramquery.cMerge=i,i.prototype={calcVisibleColumns:function(t,e,i){var n=0,r=t.length;for(i=i>r?r:i;e<i;e++)!0!==t[e].hidden&&n++;return n},findNextVisibleColumn:function(t,e,i){for(var n,r=e;r<e+i;r++){if(!(n=t[r]))return-1;if(!n.hidden)return r}},findNextVisibleRow:function(t,e,i){for(var n,r=e;r<e+i;r++){if(!(n=t[r]))return-1;if(!n.pq_hidden)return r}},getData:function(t,e,i){var n,r=this.mc;if(r[t]&&(n=r[t][e])){var o=n.data;return o?o[i]:null}},inflateRange:function(t,e,i,n){var r=this.that,o=!1,a=r.options,s=a.groupModel.on?r.riOffset+r.pdata.length-1:a.dataModel.data.length-1,l=r.colModel.length-1,d=this.mc2;if(!d)return[t,e,i,n];t:for(var c=0,h=d.length;c<h;c++){var u=d[c],f=u.r1,p=u.c1,g=(g=f+u.rc-1)>s?s:g,v=(v=p+u.cc-1)>l?l:v;if((f<t&&g>=t||f<=i&&g>i)&&v>=e&&p<=n||(p<e&&v>=e||p<=n&&v>n)&&g>=t&&f<=i){o=!0,t=f<t?f:t,e=p<e?p:e,i=g>i?g:i,n=v>n?v:n;break t}}return o?this.inflateRange(t,e,i,n):[t,e,i,n]},init:function(){for(var t=this.that,i=this.findNextVisibleColumn,n=this.findNextVisibleRow,r=this.calcVisibleColumns,o=t.colModel,a=t.options.mergeCells||[],s=t.get_p_data(),l=[],d=[],c=0,h=a.length;c<h;c++){var u,f,p=a[c],g=p.r1,v=g,m=s[g],w=p.c1,x=w,y=o[w],C=p.rc,b=p.cc;if(y&&m&&(y.hidden&&(x=i(o,w,b)),u=r(o,w,w+b),m.pq_hidden&&(v=n(s,g,C)),!((f=e(s,g,g+C))<1||u<1))){l.push({r1:g,c1:w,rc:C,cc:b}),d[v]=d[v]||[],d[v][x]={show:!0,rowspan:f,colspan:u,o_rowspan:C,o_colspan:b,style:p.style,cls:p.cls,attr:p.attr,r1:g,c1:w,v_r1:v,v_c1:x};for(var I={show:!1,r1:g,c1:w,v_r1:v,v_c1:x},_=g;_<g+C;_++){d[_]=d[_]||[];for(var q=w;q<w+b;q++)_===v&&q===x||(d[_][q]=I)}}}t._mergeCells=d.length>0,this.mc=d,this.mc2=l},ismergedCell:function(t,e){var i,n=this.mc;if(n&&n[t]&&(i=n[t][e])){var r=i.v_r1,o=i.v_c1;return t!==r||e!==o||{o_ri:i.r1,o_ci:i.c1,v_rc:i.rowspan,v_cc:i.colspan,o_rc:i.o_rowspan,o_cc:i.o_colspan}}return!1},isRootCell:function(t,e,i){var n,r=this.mc;if(r&&r[t]&&(n=r[t][e])){if("o"===i)return t===n.r1&&e===n.c1;var o=n.v_r1,a=n.v_c1;if(o===t&&a===e){var s=r[o][a];return{rowspan:s.rowspan,colspan:s.colspan}}}},removeData:function(t,e,i){this.that;var n,r=this.mc;if(r&&r[t]&&(n=r[t][e])){var o=n.data;o&&(o[i]=null)}},getRootCell:function(t,e){var i,n,r,o=this.mc;if(o&&o[t]&&(r=o[t][e]))return i=r.v_r1,n=r.v_c1,{o_ri:(r=o[i][n]).r1,o_ci:r.c1,v_ri:i,v_ci:n,v_rc:r.rowspan,v_cc:r.colspan,o_rc:r.o_rowspan,o_cc:r.o_colspan}},getRootCellO:function(t,e,i,n){var r,o="o"===(n=n||"o"),a=this.getRootCell(t,e);return a?(r={rowIndx:a[o?"o_ri":"v_ri"],colIndx:a[o?"o_ci":"v_ci"]},this.that.normalize(r)):(i&&(r={rowIndx:t,colIndx:e}),r?this.that.normalize(r):null)},getRootCellV:function(t,e,i){return this.getRootCellO(t,e,i,"v")},getClsStyle:function(t,e){return this.mc[t][e]},getMergeCells:function(t,e,i){for(var n,r,o,a=this.that,s=a.options.mergeCells,l=a.riOffset,d=l+i,c=[],h=s?s.length:0,u=0;u<h;u++)r=(n=s[u]).r1,o=n.c1,(!e||r>=l&&r<d)&&(e&&(r-=l),r+=t,c.push({r1:r,c1:o,r2:r+n.rc-1,c2:o+n.cc-1}));return c},setData:function(t,e,i){var n,r=this.mc;r[t]&&(n=r[t][e])&&(n.data=i)}}}(jQuery),function(t){var e=t.paramquery;e.pqGrid.defaults.groupModel={agg:{},cascade:!0,cbId:"pq_group_cb",collapsed:[],dataIndx:[],fixCols:!0,groupCols:[],header:!0,headerMenu:!0,icon:["ui-icon-triangle-1-se","ui-icon-triangle-1-e"],id:"pq_gid",parentId:"parentId",childstr:"children",menuItems:["merge","fixCols","grandSummary"],on:!1,refreshOnChange:!0,pivotColsTotal:"after",separator:"_",source:"checkboxGroup",showSummary:[],summaryInTitleRow:"collapsed",summaryEdit:!0,title:[],titleDefault:"{0} ({1})"},pq.aggregate={sum:function(t){for(var e,i=0,n=t.length;n--;)null!==(e=t[n])&&(i+=e-0);return i},avg:function(t,e){try{var i=pq.formulas.AVERAGE(t)}catch(t){i=t}return isNaN(i)?null:i},flatten:function(t){return t.filter(function(t){return null!==t})},max:function(t,e){var i,n=e.dataType;if((t=this.flatten(t)).length)return"float"===n||"integer"===n?i=Math.max.apply(Math,t):"date"===n?(t.sort(function(t,e){return t=Date.parse(t),(e=Date.parse(e))-t}),i=t[0]):(t.sort(),i=t[t.length-1]),i},min:function(t,e){var i,n,r,o,a=e.dataType;if((t=this.flatten(t)).length){if("integer"===a||"float"===a)i=Math.min.apply(Math,t);else if("date"===a){for(o=t.length,n=[];o--;)r=t[o],n.push({dateO:r,dateP:Date.parse(r)});n.sort(function(t,e){return t.dateP-e.dateP}),i=n.length?n[0].dateO:void 0}else t.sort(),i=t[0];return i}},count:function(t){return this.flatten(t).length},stdev:function(t){try{var e=pq.formulas.STDEV(t)}catch(t){e=t}return isNaN(e)?null:e},stdevp:function(t){try{var e=pq.formulas.STDEVP(t)}catch(t){e=t}return isNaN(e)?null:e}};var i=e.cGroup=function(t){var e=t.options.groupModel;this.model="groupModel",this.cbId=e.cbId,this.childstr=e.childstr,this.id=e.id,this.parentId=e.parentId,this.cache=[],this.prop="pq_group_prop",this.that=t,e.on&&this.init()};function n(t,e,i,n){t.push("<li data-option='",i,"' class='pq-menu-item'>","<label>","<input type='checkbox' ",e[i]?"checked":"","/>",n["strGroup_"+i],"</label></li>")}i.beforeTrigger=function(t,e){return function(i){return!1===e._trigger("beforeGroupExpand",t,i)}},i.onGroupItemClick=function(e){return function(i){var n=t(i.target),r=t(this).data("indx");n.hasClass("pq-group-remove")?e.removeGroup(r):e.toggleLevel(r,i)}},i.prototype=t.extend({},pq.mixin.ChkGrpTree,pq.mixin.GrpTree,{addGroup:function(t,e){var i=this,n=i.that.options.groupModel.dataIndx||[],r=pq.objectify(n),o=n.slice();null===t||r[t]||(null===e?o.push(t):o.splice(e,0,t),i.option({dataIndx:o},"","",function(){i.triggerChange()}))},createHeader:function(){for(var e=this.that,n=this.$header,r=e.options,o=r.bootstrap,a=e.columns,s=o.on,l=r.groupModel,d=l.dataIndx,c=d.length;c--;)null===a[d[c]]&&d.splice(c,1);if(c=d.length,l.header&&l.on){if(n?n.empty():(n=this.$header=t("<div class='pq-group-header ui-helper-clearfix' ></div>").appendTo(e.$top)).on("click",".pq-group-item",i.onGroupItemClick(this)),c){for(var h=[],u=0;u<c;u++){var f=d[u],p=a[f],g=l.collapsed,v=s?o.groupModel.icon:l.icon,m=g[u]?v[1]:v[0];h.push("<div tabindex='0' class='pq-group-item' data-indx='",f,"' >","<span class='",this.toggleIcon,m,"' ></span>",p.pq_title||("string"==typeof p.title?p.title:f),"<span class='",this.groupRemoveIcon,"' ></span></div>")}n[0].innerHTML=h.join("")}this.initHeader(r,l)}else n&&(n.remove(),this.$header=null)},collapse:function(t){this.expand(t,!0)},collapseAll:function(t){this.expandAll(t,!0)},collapseTo:function(t){this.expandTo(t,!0)},concat:function(){var t=this.parentId,e=this.id,i=this.childstr;return function(n,r,o){var a=o[e];return r.forEach(function(e){e[t]=a,n.push(e)}),o[i]=r,n}},editorSummary:function(e,i){var n=this;return function(e){var r=e.rowData;if(r.pq_gsummary||r.pq_gtitle){var o,a=pq.aggregate,s=e.column,l=s.summary,d=l?l.edit:null,c=t.inArray,h=s.dataType,u=[""];if(c(e.dataIndx,i.dataIndx)>-1)return!1;if(!i.summaryEdit&&!d||!1===d)return!1;for(var f in o=n.getAggOptions(h),a)c(f,o)>-1&&u.push(f);return 1!==u.length&&{type:"select",prepend:i.prepend,options:i.options||u,valueIndx:i.valueIndx,labelIndx:i.labelIndx,init:i.init||n.editorInit,getData:i.getData||n.editorGetData}}}},editorInit:function(t){var e,i=t.column.summary,n=this.options.groupModel.dataIndx;i||(i=t.column.summary={}),e=i[n[t.rowData.pq_level]]||i.type,t.$cell.find("select").val(e)},editorGetData:function(t){var e=t.column,i=this.options.groupModel.dataIndx[t.rowData.pq_level],n=e.dataType,r=e.summary,o=t.$cell.find("select").val();return r[r[i]?i:"type"]=o,this.one("beforeValidate",function(t,i){i.allowInvalid=!0,i.track=!1,i.history=!1,e.dataType="string",this.one(!0,"change",function(t,i){e.dataType=n})}),o},expandTo:function(t,e){for(var i,n=this.that,r=!!e,o=t.split(","),a=o.length,s=this.childstr,l=this.getRoots(n.pdata),d=0;d<a&&(i=l[o[d]]);)r||(i.pq_close=r),l=i[s],d++;i&&(i.pq_close=r,!1!==n._trigger("group",null,{node:i,close:r})&&this.softRefresh())},expandAll:function(t,e){t=t||0,e=!!e,!1!==this.trigger({all:!0,close:e,level:t})&&(this.that.pdata.forEach(function(i){i.pq_level>=t&&(i.pq_close=e)}),this.createHeader(),this.softRefresh())},expand:function(t,e){t=t||0,!1!==this.trigger({close:!!e,level:t})&&(this.that.pdata.forEach(function(i){i.pq_level===t&&(i.pq_close=e)}),this.createHeader(),this.softRefresh())},firstCol:function(){return this.that.colModel[this.that.getFirstVisibleCI()]},flattenG:function(t,e,i,n){var r=i.dataIndx,o=i.titleInFirstCol,a=this.id,s=this.parentId,l=this.childstr,d=i.separator,c=o?this.firstCol().dataIndx:null,h=this.concat(),u=r.length,f=[];return function n(p,g,v,m){if(!u)return p;var w=g||0,x=(v=v||{})[l],y=r[w],C=i.collapsed[w];i.showSummary[w];return e(p,y,t[y]).forEach(function(t){var e,i=t[1],r=t[0],p=(m?m+d:"")+r,g=i.length;f.length;(e={pq_gtitle:!0,pq_level:w,pq_close:C,pq_items:g})[a]=p,e[s]=v[a],e[l]=[],e[y]=r,o&&(e[c]=r),f.push(e),x&&x.push(e),w+1<u?n(i,w+1,e,p):f=h(f,i,e)}),f}},getAggOptions:function(t){return"integer"===t||"float"===t?t="number":"date"!==t&&(t="string"),this.that.options.summaryOptions[t].split(",")},getVal:function(e){var i=t.trim;return function(t,n,r){var o=t[n],a=r.groupChange;return a?(a=pq.getFn(a))(o):(o=i(o),e?o.toUpperCase():o)}},getSumCols:function(){return this._sumCols},getSumDIs:function(){return this._sumDIs},group:function(t){return function(e,i,n){var r={},o=[];return e.forEach(function(e){e.pq_hidden=void 0;var a=t(e,i,n),s=r[a];null===s&&(r[a]=s=o.length,o[s]=[a,[]]),o[s][1].push(e)}),o}},groupData:function(){var t=this.that,e=t.options.groupModel,i=this.getVal(e.ignoreCase),n=e.dataIndx,r=t.pdata,o=t.columns;this.setSumCols(n);t.pdata=this.flattenG(o,this.group(i),e,function(){})(r),this.summaryT()},hideRows:function(t,e,i,n){for(var r,o=this.that.pdata,a=t,s=o.length;a<s;a++)if((r=o[a]).pq_gsummary)i||n?r.pq_level>=e&&(r.pq_hidden=!0):r.pq_level>e&&(r.pq_hidden=!0);else if(r.pq_gtitle){if(r.pq_level<=e)break;r.pq_hidden=!0}else r.pq_hidden=!0},init:function(){var t,e,i,n,r,o=this;o.onCMInit(),o._init||(o.mc=[],o.summaryData=[],e=(t=(r=o.that).options).groupModel,n=(i=t.bootstrap.on)?"glyphicon ":"ui-icon ",o.groupRemoveIcon="pq-group-remove "+n+(i?"glyphicon-remove":"ui-icon-close"),o.toggleIcon="pq-group-toggle "+n,r.on("cellClick",o.onCellClick(o)).on("cellKeyDown",o.onCellKeyDown(o,e)).on(!0,"cellMouseDown",o.onCellMouseDown()).on("change",o.onChange(o,e)).on("dataReady",o.onDataReady(o,r)).on("beforeFilterDone",function(){o.saveState()}).on("columnDragDone",o.onColumnDrag(o)).on("columnOrder",o.onColumnOrder(o,e)).on("customSort",o.onCustomSort.bind(o)).on("valChange",o.onCheckbox(o,e)).on("refresh refreshRow",o.onRefresh(o,e)).on("refreshHeader",o.onRefreshHeader.bind(o)),e.titleInFirstCol&&r.on("CMInit",o.onCMInit.bind(o)),r.on("beforeCheck",o.onBeforeCheck.bind(o)),o.setCascadeInit(!0),o._init=!0)},initHeadSortable:function(){var t=this.that,e=this.$header,i=t.options;e.sortable({axis:"x",distance:3,tolerance:"pointer",cancel:".pq-group-menu",stop:this.onSortable(this,i)})},initHeadDroppable:function(){var t=this,e=t.that,i=t.$header;i&&(i.droppable({accept:function(i){var n=1*i.attr("pq-col-indx");if(!isNaN(n)&&e.colModel[n])return t.acceptDrop},tolerance:"pointer",hoverClass:"pq-drop-hover",drop:t.onDrop(e,t)}),t.acceptDrop=!0)},initHeader:function(t,e){if(this.$header){var i=this.$header,n=i.find(".pq-group-item");i.data("uiSortable")||this.initHeadSortable(),n.length||i.append("<span class='pq-group-placeholder'>"+t.strGroup_header+"</span>"),e.headerMenu&&this.initHeaderMenu()}},initHeaderMenu:function(){for(var e,i=this,r=i.that,o=r.BS_on,a=r.options,s=i.$header,l=["<ul class='pq-group-menu'><li>",o?"<span class='glyphicon glyphicon-chevron-left'></span>":"","<ul>"],d=a.groupModel,c=d.menuItems,h=0,u=c.length;h<u;h++)n(l,d,c[h],a);l.push("</ul></li></ul>"),(e=t(l.join("")).appendTo(s)).menu({icons:{submenu:"ui-icon-carat-1-w"},position:{my:"right top",at:"left top"}}),e.change(function(e){if("INPUT"===e.target.nodeName){var n=t(e.target).closest("li").data("option"),r={};r[n]=!a.groupModel[n],i.option(r)}})},isOn:function(){var t=this.that.options.groupModel;return t.on&&(t.dataIndx||[]).length},getRC:function(t){var e=1,i=this;return(t[i.childstr]||[]).forEach(function(t){e+=i.getRC(t)}),e+(t.pq_child_sum?1:0)},initmerge:function(){var t,e=this,i=e.that,n=i.options,r=n.groupModel,o=r.merge,a=r.summaryInTitleRow,s=r.titleInFirstCol,l=i.colModel.length,d=[],c=r.dataIndx,h=(c.length,i.pdata||[]);o?c.forEach(function(i,n){h.forEach(function(i){i.pq_gtitle&&n===i.pq_level&&(t=e.getRC(i),d.push({r1:i.pq_ri,rc:t,c1:n,cc:1}))})}):c.length&&h.forEach(function(t){t.pq_gtitle&&(a&&(t.pq_close||"collapsed"!==a)||d.push({r1:t.pq_ri,rc:1,c1:s?0:t.pq_level,cc:l}))}),d.length?(e.mc=n.mergeCells=d,i.iMerge.init()):this.mc.length&&(e.mc.length=0,i.iMerge.init())},initcollapsed:function(){var t,e,i,n,r=this.that,o=r.options.groupModel,a=o.merge,s=o.summaryInTitleRow,l=this.cacheClose,d=r.pdata,c=this.id;if(d)for(var h=0,u=d.length;h<u;h++)(t=d[h]).pq_gtitle&&(i=t.pq_level,n=null,l&&null!==(e=l[t[c]])&&(delete l[t[c]],n=t.pq_close=e),null===n&&(n=t.pq_close),n?this.hideRows(h+1,i,a,s):a&&(t.pq_hidden=!0))},updateItems:function(t){var e,i,n=this,r=0,o=n.childstr;return(t||n.that.pdata).forEach(function(t){t.pq_gtitle&&(e=t[o],(i=e.length)&&e[0][o]?t.pq_items=n.updateItems(e):t.pq_items=i,r+=t.pq_items)}),r},removeEmptyParent:function(t){var e=this.that.pdata,i=this.childstr;if(!t[i].length){var n=this.getParent(t),r=n?n[i]:e,o=r.indexOf(t);r.splice(o,1),n&&this.removeEmptyParent(n)}},addNodes:function(t,e,i){this.moveNodes(t,e,i,!0)},deleteNodes:function(t){this.moveNodes(t,null,null,null,!0)},moveNodes:function(t,e,i,n,r){var o,a,s,l=this.that,d=this.childstr,c=l.options,h=c.groupModel,u=h.dataIndx,f=(this.id,c.dataModel.data),p=this.parentId,g=0,v=t.length;if(u.length,e){var m=e[d],w=m.length,x=m[0],y=(i=null===i||i>=w?w:i,f.indexOf(x)+i);if(x.pq_gtitle)throw"incorrect nodes"}if(t=t.slice(0),v){for(l._trigger("beforeMoveNode");g<v;g++)s=t[g],n?e[d].splice(i++,0,s):(a=(o=this.getParent(s))[d].indexOf(s),r?o[d].splice(a,1):o===e?i=pq.moveItem(s,e[d],a,i):(e[d].splice(i++,0,s),o[d].splice(a,1))),x&&(u.forEach(function(t){s[t]=x[t]}),s[p]=x[p],s.pq_hidden=x.pq_hidden),n?f.splice(y++,0,s):(a=f.indexOf(s),r?f.splice(a,1):y=pq.moveItem(s,f,a,y),this.removeEmptyParent(o));this.updateItems(),this.summaryT(),this.isCascade(h)&&(this.cascadeInit(),this.setValCBox()),l.iRefresh.addRowIndx(),this.initmerge(),l._trigger((n?"add":r?"delete":"move")+"Node"),l.refresh({header:!1})}},onCellClick:function(e){return function(i,n){if(n.rowData.pq_gtitle&&t(i.originalEvent.target).hasClass("pq-group-icon"))if(pq.isCtrl(i)){var r=n.rowData;e[r.pq_close?"expand":"collapse"](r.pq_level)}else e.toggleRow(n.rowIndxPage,i)}},onCellMouseDown:function(){return function(e,i){i.rowData.pq_gtitle&&t(e.originalEvent.target).hasClass("pq-group-icon")&&e.preventDefault()}},onCellKeyDown:function(e,i){return function(n,r){if(r.rowData.pq_gtitle&&t.inArray(r.dataIndx,i.dataIndx)>=0&&n.keyCode===t.ui.keyCode.ENTER)return e.toggleRow(r.rowIndxPage,n),!1}},onChange:function(t,e){return function(i,n){e.source===n.source||"checkbox"===n.source||(t.summaryT(),t.that.refresh())}},onColumnDrag:function(t){return function(e,i){var n=i.column,r=n.colModel;r&&r.length||!1===n.groupable||n.denyGroup?t.acceptDrop=!1:t.initHeadDroppable()}},onCustomSort:function(t,e){var i=this.that,n=i.options.groupModel,r=n.dataIndx,o=e.sorter,a=(o[0]||{}).dataIndx,s=i.columns[a],l=r.indexOf(a),d=i.colIndxs[a];if(r.length&&1===o.length){if(l>=0&&s.groupChange)return;if("pq_order"===a||(s.summary||{}).type)return this._delaySort(e);var c=r.map(function(t){return{dataIndx:t,dir:o[0].dir}}).concat(o);return c=pq.arrayUnique(c,"dataIndx"),this._delaySort(e,function(t){n.titleInFirstCol&&0===d?e.sort_composite=c.map(function(e){return i.iSort.compileSorter([e],t)}):e.sort_composite=c.map(function(e){if(e.dataIndx===a)return i.iSort.compileSorter([e],t)})})}},_delaySort:function(t,e){var i=this,n=i.that,r=n.pdata;if(r&&r.length)return n.one("skipGroup",function(){return e&&e(r),t.data=r,i.onCustomSortTree({},t),n.pdata=t.data,i.summaryRestore(),!1}),!1},summaryRestore:function(){var t=this.childstr;this.that.pdata=function e(i,n){var r=[];return i.forEach(function(i){r.push(i),e(i[t]||[],i).forEach(function(t){r.push(t)})}),n&&n.pq_child_sum&&r.push(n.pq_child_sum),r}(this.getRoots())},onDrop:function(t,e){return function(i,n){var r=1*n.draggable.attr("pq-col-indx"),o=t.colModel[r].dataIndx;e.addGroup(o),e.acceptDrop=!1}},onSortable:function(e,i){return function(){var n,r,o,a=[],s=i.groupModel.dataIndx;t(this).find(".pq-group-item").each(function(e,i){r=t(i),o=r.data("indx"),s[e]!==o&&(n=!0),a.push(o)}),n&&e.option({dataIndx:a},"","",function(){e.triggerChange()})}},onDataReady:function(t,e){return function(){var i=e.options.groupModel,n=i.dataIndx.length;i.on&&(n||i.grandSummary?(!1!==e._trigger("skipGroup")&&(t.groupData(),t.buildCache()),e.iRefresh.addRowIndx(),t.refreshColumns(),n&&(t.initcollapsed(),t.initmerge(),t.isCascade(i)&&t.cascadeInit())):t.refreshColumns(),t.setValCBox()),t.createHeader()}},onColumnOrder:function(t,e){return function(){if(e.titleInFirstCol)return t.that.refreshView(),!1;t.initmerge()}},option:function(e,i,n,r){var o,a=e.dataIndx,s=this.that,l=a?a.length:0,d=s.options.groupModel,c=d.dataIndx;d.on&&c.length&&(!1===e.on||0===l)&&this.showRows(),o=t.extend({},d),t.extend(d,e),r&&r(),this.init(),this.setOption(),s._trigger("groupOption",null,{source:n,oldGM:o}),!1!==i&&s.refreshView()},showRows:function(){this.that.options.dataModel.data.forEach(function(t){t.pq_hidden&&(t.pq_hidden=void 0)})},renderBodyCell:function(t,e){var i,n=this,r=e.checkbox,o=e.dataIndx.length-(n.isPivot()?1:0),a=e.titleInFirstCol,s=a?e.indent:0,l=s*o,d="";return o&&(l+=s),function(t){var o,s,c=t.rowData,h=t.column,u=h.renderLabel;return t.Export?void 0:(o=(o=u&&u.call(n.that,t))||t.formatVal||t.cellData,r&&a&&(i=n.renderCB(r,c,e.cbId))&&(d=i[0]),{text:((s=d&&(h.useLabel||e.useLabel))?"<label style='width:100%;'>":"")+d+(null===o?"":o)+(s?"</label>":""),style:"text-indent:"+l+"px;"})}},renderCell:function(t,e){var i=this.renderTitle(t,e),n=this.that,r=e.dataIndx,o=(pq.objectify(this.isPivot()?r.slice(0,r.length-1):r),this.renderBodyCell(t,e)),a=this.renderSummary(t);return function(t,r){t._render=t._renderG=function(t){var s=t.rowData,l=s.pq_gtitle;return r&&l?i(t):l||s.pq_gsummary?a(t):e.titleInFirstCol&&t.colIndx===n.getFirstVisibleCI()?o(t):void 0}}},renderSummary:function(t){var e=this.that,i=t.groupModel.dataIndx;return function(n){var r,o,a,s=n.rowData,l=n.column,d=l.summary;if(d&&(o=d[i[s.pq_level]]||d.type))return"function"==typeof(a=t.summaryTitle[o])?a.call(e,n):(null===(r=n.formatVal)&&(r=null===(r=n.cellData)?"":r),"number"!=typeof r||l.format||parseInt(r)===r||(r=r.toFixed(2)),a?a.replace("{0}",r):r)}},updateformatVal:function(t,e,i){var n=t.dataIndx[i],r=this.that.columns[n];r.format&&r!==e.column&&(e.formatVal=pq.format(r,e.cellData))},renderTitle:function(t,e){var i,n,r=this,o=r.that,a=e.checkbox,s=t.bootstrap,l=["pq-group-title-cell"],d=e.titleInFirstCol,c=e.indent,h=s.on,u=h?s.groupModel.icon:e.icon,f=h?["glyphicon "+u[0],"glyphicon "+u[1]]:["ui-icon "+u[0],"ui-icon "+u[1]];return function(t){var s,h,u,p,g=t.rowData,v=t.column,m=v.useLabel;if(null!==t.cellData)return s=g.pq_close,h=g.pq_level,u=e.title,r.updateformatVal(e,t,h),u=null===(u="function"==typeof(u=v.renderLabel||u[h]||e.titleDefault)?u.call(o,t):u.replace("{0}",t.formatVal||t.cellData).replace("{1}",g.pq_items))?t.formatVal||t.cellData:u,p="pq-group-icon "+f[s?1:0],t.Export?u:(a&&d&&r.isCascade(e)&&(i=r.renderCB(a,g,e.cbId))&&(n=i[0],i[1]&&l.push(i[1])),{text:[(m=n&&(null!==m?m:e.useLabel))?"<label style='width:100%;'>":"","<span class='",p,"'></span>",n,u,m?"</label>":""].join(""),cls:l.join(" "),style:"text-align:left;text-indent:"+c*h+"px;"})}},triggerChange:function(){this.that._trigger("groupChange")},removeGroup:function(t){var e=this;e.option({dataIndx:e.that.options.groupModel.dataIndx.filter(function(e){return e!==t})},"","",function(){e.triggerChange()})},refreshColumns:function(){for(var t,e,i,n=this.that,r=n.options,o=r.groupModel,a=o.on,s=o.fixCols,l=this.renderCell(r,o),d=o.dataIndx,c=d.length,h=n.colModel,u=h.length;u--;)(t=h[u])._renderG&&(delete t._render,delete t._renderG),t._nodrag&&(delete t._nodrag,delete t._nodrop),a&&(e=t.summary)&&e.type&&l(t);if(r.geditor=a?this.editorSummary(r,o):void 0,a)if(o.titleInFirstCol)l(t=this.firstCol(),!0);else for(u=c-1;u>=0;u--)l(t=n.getColumn({dataIndx:d[u]}),!0);if(s&&a)for(u=0;u<c;u++)(t=h[i=n.getColIndx({dataIndx:d[u]})])._nodrag=t._nodrop=!0,i!==u&&(n.iDragColumns.moveColumn(i,u,!0),n.refreshCM(null,{group:!0}))},saveState:function(t){var e=this.that,i=this.cacheClose=this.cacheClose||{},n=this.id,r=e.options.groupModel;r.on&&r.dataIndx.length&&(e.pdata.forEach(function(t){t.pq_gtitle&&(i[t[n]]=t.pq_close)}),t&&this.refreshView("group"))},setSumCols:function(t){var e=[],i=[];return t=pq.objectify(t),this.that.colModel.forEach(function(n){var r,o=n.summary;o&&o.type&&(r=n.dataIndx,t[r]||(e.push(n),i.push(r)))}),this._sumCols=e,this._sumDIs=i,[e,i]},setOption:function(){this._init&&(this.refreshColumns(),this.summaryData.length=0,this.initmerge())},softRefresh:function(){var t=this.that;this.pdata=null,t.pdata.forEach(function(t){delete t.pq_hidden}),this.initcollapsed(),this.initmerge(),t.refresh({header:!1})},toggleLevel:function(e,i){var n=this.that.options.groupModel,r=n.collapsed,o=t.inArray(e,n.dataIndx),a=pq.isCtrl(i)?"All":"";this[(r[o]?"expand":"collapse")+a](o)},trigger:function(t){var e,n,r,o=t.evt,a=t.rd,s=t.level,l=t.all,d=t.close,c=this.that,h=c.options.groupModel,u=h.dataIndx,f=h.collapsed,p=i.beforeTrigger(o,c),g={};if(a){if(n=a[u[e=a.pq_level]],p(g={level:e,close:d=!a.pq_close,group:n}))return!1;a.pq_close=d}else if(l){if(p(g={all:!0,close:d,level:s}))return!1;for(r=s;r<u.length;r++)f[r]=d}else if(null!==s){if(p(g={level:s,close:d}))return!1;f[s]=d}return c._trigger("group",null,g)},toggleRow:function(t,e){var i=this.that.pdata[t];!1!==this.trigger({evt:e,rd:i})&&this.softRefresh()}}),e.pqGrid.prototype.Group=function(t){var e=this.iGroup;if(null===t)return e;e.expandTo(t.indx)}}(jQuery),function(t){var e=t.paramquery,i=e.pqGrid.prototype,n=i.options;t(document).on("pqGrid:bootup",function(t,e){var i=e.instance;i.iDrag=new r(i)});var r=e.cDrag=function(t){var e=t.options,i=e.dragModel;i.on&&(this.that=t,e.postRenderInterval=e.postRenderInterval||-1,this.model=i,this.ns=".pq-drag",t.on("CMInit",this.onCMInit.bind(this)).on("create",this.onCreate.bind(this)))};i.Drag=function(){return this.iDrag},n.dragModel={afterDrop:function(){},beforeDrop:function(t,e){var i=this.Drag().getUI().nodes,n=this,r=this.Tree(),o=this.Group();r.isOn()?n=r:o.isOn()&&(n=o),n.deleteNodes(i)},diDrag:-1,dragNodes:function(t){return[t]},contentHelper:function(t,e){var i=e[0],n=e.length;return t.map(function(t){return i[t]}).join(", ")+(n>1?" ( "+e.length+" )":"")},clsHandle:"pq-drag-handle",clsDnD:"pq-dnd",iconAccept:"ui-icon ui-icon-check",iconReject:"ui-icon ui-icon-cancel",tmplDragN:"<span class='ui-icon ui-icon-grip-dotted-vertical pq-drag-handle' style='cursor:move;position:absolute;left:2px;top:4px;'>&nbsp;</span>",tmplDrag:"<span class='ui-icon ui-icon-grip-dotted-vertical pq-drag-handle' style='cursor:move;vertical-align:text-bottom;touch-action:none;float:left;'>&nbsp;</span>",cssHelper:{opacity:.7,position:"absolute",height:25,width:200,overflow:"hidden",background:"#fff",border:"1px solid",boxShadow:"4px 4px 2px #aaaaaa",zIndex:1001},tmplHelper:"<div class='pq-border-0 pq-grid-cell' style='pointer-events: none;'><span class='pq-icon' style='vertical-align:text-bottom;margin:0 5px;'></span><span></span></div>"},r.prototype={addIcon:function(t){this.$helper.find(".pq-icon").attr("class","").addClass("pq-icon "+t)},addAcceptIcon:function(){this.addIcon(this.model.iconAccept)},addRejectIcon:function(){this.addIcon(this.model.iconReject)},getHelper:function(e){var i=this.that,n=this.model,r=t(e.target).closest(".pq-grid-cell,.pq-grid-number-cell"),o=this.cellObj=i.getCellIndices({$td:r}),a=(r[0],n.diHelper||[n.diDrag]),s=o.rowData,l=o.nodes=n.dragNodes.call(i,s,e),d=n.contentHelper.call(i,a,l),c=this.$helper=t(n.tmplHelper);return c.find("span:eq(1)").html(d),this.addRejectIcon(),c.addClass("pq-theme pq-drag-helper").css(n.cssHelper).data("Drag",this),c[0]},getUI:function(){return this.cellObj},grid:function(){return this.that},isSingle:function(){return 1===this.getData().length},onCMInit:function(){var e=this.that,i=this.model,n=i.tmplDragN,r=i.isDraggable;(e.columns[i.diDrag]||e.options.numberCell).postRender=function(i){r&&!r.call(e,i)||t(i.cell).prepend(n)}},onCreate:function(){var e=this.model,i=-1===e.diDrag;this.that.on(!0,"cellMouseDown",this.onCellMouseDown.bind(this)),this.ele=this.that.$cont.children(":first").addClass(e.clsDnD+(i?" pq-drag-number":"")).draggable(t.extend({cursorAt:{left:2,top:20},containment:"document",appendTo:"body"},e.options,{handle:"."+e.clsHandle,helper:this.getHelper.bind(this),revert:this.revert.bind(this)}))},onDrop:function(t,e,i){this.model[t].call(this.that,e,i)},revert:function(e){e||this.$helper.hide("explode",function(){t(this).remove()})},onCellMouseDown:function(e){var i=this.model;t(e.originalEvent.target).closest("."+i.clsHandle+",.pq-grid-number-cell").length&&e.preventDefault()},over:function(t,e){this.addAcceptIcon()},out:function(t,e){this.addRejectIcon()}}}(jQuery),function(t){var e=t.paramquery,i=e.pqGrid.prototype,n=i.options;t(document).on("pqGrid:bootup",function(t,e){var i=e.instance;i.iDrop=new r(i)}),i.Drop=function(){return this.iDrop},n.dropModel={accept:".pq-dnd",drop:function(t,e){var i=e.helper.data("Drag"),n=this.Group(),r=this.Tree(),o=e.rowData,a=e.ratioY()<=.5,s=e.rowIndx+(a?0:1),l=function(t){var e;t.isFolder(o)?(e=o,a||(d=0)):(e=t.getParent(o),d=t.getChildren(e).indexOf(o)+(a?0:1)),h?t.moveNodes(u,e,d):t.addNodes(u,e,d)};if(i){var d,c=i.getUI(),h=i.grid()===this,u=c.nodes;n.isOn()?l(n):r.isOn()?l(r):h?this.moveNodes(u,s):this.addNodes(u,s)}}};var r=e.cDrop=function(t){var e=t.options.dropModel;this.model=e,e.on&&(this.that=t,this.ns=".pq-drop",t.on("create",this.onCreate.bind(this)))};r.prototype={addUI:function(e,i,n){var r=this;e.$cell=n,e.ratioY=function(){return r.ratioY(i,n)},t.extend(e,r.that.getCellIndices({$td:n}))},callFn:function(t,e,i){var n=this.model[t];if(n)return n.call(this.that,e,i)},feedback:function(t,e){if(e.length){var i=this.getCellY(e),n=i[0],r=this.that.$cont,o=this.ratioY(t,e),a=r.offset().left,s=i[1];this.$feedback=this.$feedback||this.newF(),this.$feedback.css({top:o<=.5?n-1:s-1,left:a,width:r[0].clientWidth,zIndex:1e4}),r.css("cursor","copy")}},getCell:function(t){return t.closest(".pq-grid-cell,.pq-grid-number-cell")},getCellY:function(t){var e=t.offset().top;return[e,e+t[0].offsetHeight]},getDrag:function(t){return t.helper.data("Drag")},isOn:function(){return this.model.on},isOver:function(){},newF:function(){return t("<svg class='pq-border-0' style='box-sizing: border-box;position:absolute;border-width:2px;border-style:solid;pointer-events:none;height:0;'></svg>").appendTo(document.body)},onCreate:function(){this.that.$cont.droppable(t.extend({tolerance:"pointer"},this.model.options,{accept:this.model.accept,over:this.onOver.bind(this),out:this.onOut.bind(this),drop:this.onDrop.bind(this)}))},onOver:function(t,e){var i=this.Drag=this.getDrag(e);e.draggable.on("drag.pq",this.onDrag.bind(this)),i&&i.over(t,e),this.isOver=function(){return!0},this.callFn("over",t,e)},onOut:function(t,e){e.draggable.off("drag.pq"),this.removeFeedback();var i=this.getDrag(e);i&&i.out(t,e),this.isOver=function(){},this.callFn("out",t,e)},onDrag:function(t,e){var i=this,n=pq.elementFromXY(t),r=i.getCell(n),o=i.Drag;(r.length||i.that.$cont[0].contains(n[0]))&&(i.addUI(e,t,r),e.rowData&&(i.denyDrop=!1===i.callFn("isDroppable",t,e),i.denyDrop?(o&&o.out(),i.removeFeedback()):(o&&o.over(),i.feedback(t,r))))},onDropX:function(t,e){var i=this.that,n=e.draggable,r=e.helper.data("Drag"),o=function(o){if(r&&r.grid()!==i)r.onDrop(o,t,e);else try{n.draggable("instance").options[o].call(n[0],t,e)}catch(t){}};o("beforeDrop"),this.callFn("drop",t,e),o("afterDrop")},onDrop:function(t,e){var i,n=pq.elementFromXY(t);this.onOut(t,e),this.denyDrop||((i=this.getCell(n)).length||this.that.$cont[0].contains(n[0]))&&(this.addUI(e,t,i),this.onDropX(t,e))},onMouseout:function(){this.removeFeedback()},onMouseup:function(){this.removeFeedback(),t(document).off(this.ns),this.that.$cont.off(this.ns)},ratioY:function(t,e){if(e.length){var i=t.pageY,n=this.getCellY(e),r=n[0];return(i-r)/(n[1]-r)}},removeFeedback:function(){this.$feedback&&(this.$feedback.remove(),this.$feedback=null),this.that.$cont.css("cursor","")}}}(jQuery),function(t){var e=t.paramquery;e.pqGrid.defaults.contextMenu={init:function(t,e){var i={r1:e.rowIndx,c1:e.colIndx,rc:1,cc:1},n=this.Selection();-1===n.indexOf(i)&&(n.removeAll(),this.Range(i).select()),this.focus(e)}},t(document).on("pqGrid:bootup",function(t,e){var n=e.instance;n.iContext=new i(n)});var i=e.cContext=function(t){var e=this.model=t.options.contextMenu;this.that=t,this.ns=".pq-cmenu",t.on("cellRightClick "+(e.head?"headRightClick":""),this.onContext.bind(this)).on("destroy",this.removeMenu.bind(this))};i.prototype={get$Item:function(e){return t(e.target).closest(".pq-cmenu-item")},getItem:function(t){return this.get$Item(t).data("item")},onContextDoc:function(t){this.getItem(t)||this.removeMenu()},onclickDoc:function(t){var e,i=this.getItem(t);i?(e=i.action)&&!1!==e.call(this.that,t,this.ui,i)&&this.removeMenu():this.removeMenu()},removeMenu:function(){this.$menu&&(this.$menu.remove(),delete this.$menu,t(document.body).off(this.ns))},removeSubMenu:function(t,e){e.subMenu&&(e.subMenu.remove(),delete e.subMenu)},onMouseOver:function(t){var e,i=this.getItem(t),n=this.get$Item(t),r=(i||{}).subItems;n.siblings().each(this.removeSubMenu),r&&r.length&&!n[0].subMenu&&((e=this.createMenu(r)).position({my:"left top",at:"right top",of:n,collision:"flipfit"}),n[0].subMenu=e)},onRemove:function(e){return function(){t(this).find(".pq-cmenu-item").each(e.removeSubMenu)}},getItemHtml:function(t,e){if("separator"===t)return"<tr class='pq-cmenu-item'><td colspan=4 class='pq-bg-0' style='height:2px;'></td></td>";var i=t.style,n=t.tooltip,r=i?'style="'+i+'"':"",o=n?'title="'+n+'"':"";return"<tr class='pq-cmenu-item "+(t.disabled?"pq_disabled":"")+" "+(t.cls||"")+"' indx="+e+"><td><span class='"+(t.icon||"")+"' /></td><td "+r+" "+o+">"+t.name+"</td><td>"+(t.shortcut||"")+"</td><td><span class='"+(t.subItems?"pq-submenu ui-icon ui-icon-carat-1-e":"")+"' /></td></tr>"},createMenu:function(e){e=e.filter(function(t){return null!==t});var i,n=this,r="";return e.forEach(function(t,e){r+=n.getItemHtml(t,e)}),(i=t("<div class='pq-cmenu pq-theme pq-popup'><table>"+r+"</table></div>").appendTo(document.body)).find(".pq-cmenu-item").each(function(i,n){t(n).data("item",e[i])}),i.on("mouseover",n.onMouseOver.bind(n)).on("remove",n.onRemove(n)),i},onContext:function(t,e){if(this.model.on)return this.showMenu(t,e)},showMenu:function(e,i){var n=this.model,r=this.that,o=this.$menu,a=n.items,s="function"==typeof a?a.call(r,e,i):a;if(o&&this.removeMenu(),s&&s.length)return n.init.call(r,e,i),this.ui=i,(o=this.$menu=this.createMenu(s)).css({position:"absolute",left:e.pageX,top:e.pageY}),t(document.body).on("click"+this.ns,this.onclickDoc.bind(this)).on("contextmenu"+this.ns,this.onContextDoc.bind(this)),!1}}}(jQuery),function(t){t(document).on("pqGrid:bootup",function(t,e){var n=e.instance;n.iAnim=new i(n)});var e=t.paramquery,i=e.cAnim=function(t){var e=this.model=t.options.animModel;this.grid=t,e.on&&t.on(e.events,this.onBefore.bind(this))},n=e.pqGrid.prototype,r=n.options;n.Anim=function(){return this.iAnim},r.animModel={duration:290,events:"beforeSortDone beforeFilterDone beforeRowExpandDone beforeGroupExpandDone beforeMoveNode beforeAutoRowHeight beforeValidateDone beforeTreeExpandDone onResizeHierarchy",eventsH:"beforeHideColsDone beforeColumnCollapseDone beforeColumnOrderDone beforeFlex columnResize"},i.prototype={cleanUp:function(){(this.data||[]).forEach(function(t){t.pq_top=t.pq_hideOld=void 0}),this.data=this.render=null},isActive:function(){return this._active},onBefore:function(t,e){if(!t.isDefaultPrevented()&&!this.data){var i,n=this,r=n.grid,o=r.iRenderB,a=n.data=o.data,s=n.render=[];try{n.htTbl=o.dims.htTbl,o.eachV(function(t,e){i=o.get$Row(e),t.pq_render=1,s.push([t,i.clone(),i.map(function(t,e){return e.parentNode})])}),a.forEach(function(t,e){t.pq_top=o.getTop(e),t.pq_hideOld=t.pq_hidden}),r.one("refresh",n.oneRefresh.bind(n)),setTimeout(function(){n.cleanUp()})}catch(t){n.data=null}}},oneRefresh:function(){if(this.data){var e,i=this,n=i.grid.iRenderB,r=i.model.duration,o=t([n.$tbl_left[0],n.$tbl_right[0]]),a=i.htTbl,s=n.dims.htTbl;i._active=!0,a>s&&o.css("height",a),setTimeout(function(){o.css("height",n.dims.htTbl),i._active=!1},r),n.eachV(function(t,i){delete t.pq_render;var o,a,s=n.getTop(i),l=t.pq_top;(l!==s||t.pq_hideOld)&&(e=n.get$Row(i),null===l||t.pq_hideOld?(o={opacity:0},a={opacity:1}):(o={top:l},a={top:s}),e.css(o).animate(a,r))}),i.render.forEach(i.removeRows.bind(i)),i.cleanUp()}},removeRows:function(e){var i,n=e[0],r=n.pq_ri,o=this.model.duration,a={opacity:1,top:n.pq_top};if(n.pq_render){if(delete n.pq_render,(i=e[1].each(function(i,n){t(n).removeAttr("id").appendTo(e[2][i]).children().removeAttr("id")})).css(a),null===r||n.pq_hidden)a={opacity:0};else try{a={top:this.grid.iRenderB.getTop(r)}}catch(t){a={opacity:0}}i.animate(a,o,function(){this.parentNode&&this.parentNode.removeChild(this)})}}}}(jQuery),function(t){t(document).on("pqGrid:bootup",function(t,e){var n=e.instance;n.iAnimH=new i(n)});var e=t.paramquery,i=e.cAnimH=function(t){var e=this.model=t.options.animModel;this.grid=t,e.on&&t.on(e.eventsH,this.onBeforeCol.bind(this))};e.pqGrid.prototype.AnimH=function(){return this.iAnimH},i.prototype={cleanUp:function(){(this.data||[]).forEach(function(t){t.pq_left=t.pq_hideOld=void 0}),this.data=this.render=null},get$Col:function(){var t=this.grid,e=t.iRenderB,i=t.iRenderHead,n=t.iRenderSum,r=e.getAllCells(),o=i.getAllCells(),a=n.getAllCells();return function(t){return e.get$Col(t,r).add(i.get$Col(t,o)).add(n.get$Col(t,a))}},onBeforeCol:function(t){if(!t.isDefaultPrevented()&&!this.data){var e,i=this.grid,n=this.data=i.getColModel(),r=this.get$Col(),o=i.iRenderB,a=this.render=[];n.forEach(function(t,e){t.pq_hideOld=t.hidden,t.pq_left=o.getLeft(e)}),o.eachH(function(t,i){e=r(i),t.pq_render=1,a.push([t,e.clone(),e.map(function(t,e){return e.parentNode.id})])}),i.one("softRefresh refresh",this.oneRefreshCol.bind(this))}},oneRefreshCol:function(){if(this.data){var t,e=this.grid.iRenderB,i=this.model.duration,n=this.get$Col();e.eachH(function(r,o){delete r.pq_render;var a=e.getLeft(o),s=r.pq_left;(s!==a||r.pq_hideOld)&&(t=n(o),null===s?t.css("opacity",0).animate({opacity:1},i):r.pq_hideOld?t.css({opacity:0,left:s}).animate({opacity:1,left:a},i):t.css("left",s).animate({left:a},i))}),this.render.forEach(this.removeCols.bind(this)),this.cleanUp()}},removeCols:function(e){var i,n,r=e[0],o=this.model.duration,a=this.grid,s=a.iRenderB,l=a.colIndxs[r.dataIndx];r.pq_render&&(delete r.pq_render,i=e[1].each(function(i,n){t(n).removeAttr("id").appendTo(document.getElementById(e[2][i]))}),null===l||r.hidden?(i.css("opacity",1),n={opacity:0}):n={left:s.getLeft(l)},i.animate(n,o,function(){this.parentNode&&this.parentNode.removeChild(this)}))}}}(jQuery),function(t){var e=t.paramquery;t(document).on("pqGrid:bootup",function(t,e){var n=e.instance;n.iFillHandle=new i(n)}),e.pqGrid.defaults.fillHandle="all",e.pqGrid.defaults.autofill=!0;var i=e.cFillHandle=function(t){this.$wrap,this.locked,this.sel,this.that=t,t.on("selectChange",this.onSelectChange(this)).on("selectEnd",this.onSelectEnd(this)).on("assignTblDims",this.onRefresh(this)).on("keyDown",this.onKeyDown.bind(this))};i.prototype={create:function(){if(!this.locked){this.remove();var e=this.that;if(1===(i=e.Selection().address()).length){var i,n=(i=i[0]).r2,r=i.c2,o=e.iMerge.getRootCellO(n,r,!0),a=e.getCell(o);if(a.length&&!1!==e._trigger("beforeFillHandle",null,o)){var s=a[0],l=s.parentNode.parentNode,d=l.parentNode,c=10,h=s.offsetLeft+s.offsetWidth-5,u=s.parentNode.offsetTop+s.offsetHeight-5,f=(h=Math.min(h+c,l.offsetWidth)-c,u=Math.min(u+c,l.offsetHeight)-c,t("<div class='pq-fill-handle'></div>").appendTo(d));f.css({position:"absolute",top:u,left:h,height:c,width:c,background:"#333",cursor:"crosshair",border:"2px solid #fff",zIndex:1}),this.$wrap=f}}}},onSelectChange:function(t){return function(){t.remove()}},onSelectEnd:function(t){return function(){this.options.fillHandle&&(t.create(),t.setDraggable(),t.setDoubleClickable())}},onRefresh:function(t){var e;return function(){this.options.fillHandle?(clearTimeout(e),e=setTimeout(function(){t.that.element&&(t.create(),t.setDraggable())},50)):t.remove()}},remove:function(){var t=this.$wrap;t&&t.remove()},setDoubleClickable:function(){var t=this.$wrap;t&&t.on("dblclick",this.onDblClick(this.that,this))},setDraggable:function(){var t=this,e=t.$wrap,i=t.that.$cont;e&&e.draggable({helper:function(){return"<div style='height:10px;width:10px;cursor:crosshair;'></div>"},appendTo:i,start:function(){t.onStart()},drag:function(e){t.onDrag(e)},stop:function(){t.onStop()}})},patternDate:function(t){var e=this;return function(i){var n=new Date(t);return n.setDate(n.getDate()+(i-1)),e.formatDate(n)}},formatDate:function(t){return t.getMonth()+1+"/"+t.getDate()+"/"+t.getFullYear()},patternDate2:function(t,e){var i,n=new Date(t),r=new Date(e),o=this,a=r.getDate()-n.getDate(),s=r.getMonth()-n.getMonth(),l=r.getFullYear()-n.getFullYear();return!s&&!l||!a&&!s||!l&&!a?function(e){var i=new Date(t);return a?i.setDate(i.getDate()+a*(e-1)):s?i.setMonth(i.getMonth()+s*(e-1)):i.setFullYear(i.getFullYear()+l*(e-1)),o.formatDate(i)}:(n=Date.parse(n),i=Date.parse(r)-n,function(t){var e=new Date(n+i*(t-1));return o.formatDate(e)})},getDT:function(t){for(var e,i,n,r=t.length,o=0;o<r;o++){if(e=t[o],parseFloat(e)===e?n="number":pq.validation.isDate(e)&&(n="date"),i&&i!==n)return"string";i=n}return n},pattern:function(t){var e=this.getDT(t);if("string"===e||!e)return!1;var i,n,r,o=t.length;return 2===o?"date"===e?this.patternDate2(t[0],t[1]):(i=t[1]-t[0],n=t[0]-i,function(t){return i*t+n}):3===o&&(i=(t[2]-2*t[1]+t[0])/2,n=t[1]-t[0]-3*i,r=t[0]-i-n,function(t){return i*t*t+n*t+r})},autofillVal:function(t,e,i,n){var r,o,a,s,l,d=this.that,c=t.r1,h=t.c1,u=t.r2,f=t.c2,p=e.r1,g=e.c1,v=e.r2,m=e.c2,w=[];if(n){for((s={r1:c,r2:u}).c1=g<h?g:f+1,s.c2=g<h?h-1:m,l=g-h,o=g;o<=m;o++)if(l++,o<h||o>f)for(r=0,a=c;a<=u;a++)w.push(i[r](l,o)),r++}else for((s={c1:h,c2:f}).r1=p<c?p:u+1,s.r2=p<c?c-1:v,l=p-c,o=p;o<=v;o++)if(l++,o<c||o>u)for(r=0,a=h;a<=f;a++)w.push(i[r](l,o)),r++;return d.Range(s).value(w),!0},autofill:function(t,e){var i,n,r,o,a,s,l,d,c=this.that,h=c.colModel,u=c.get_p_data(),f=[],p=t.r1,g=t.c1,v=t.r2,m=t.c2,w=e.c1!==g||e.c2!==m;if(w){for(a=p;a<=v;a++){if(l={sel:{r:a,c:g},x:!0},c._trigger("autofillSeries",null,l),!(d=l.series))return;f.push(d)}return this.autofillVal(t,e,f,w)}for(s=g;s<=m;s++){for(n=(i=h[s]).dataType,o=i.dataIndx,r=[],a=p;a<=v;a++)r.push(u[a][o]);if(l={cells:r,sel:{r1:p,c:s,r2:v,r:p}},c._trigger("autofillSeries",null,l),!(d=l.series||this.pattern(r,n)))return;f.push(d)}return this.autofillVal(t,e,f)},onKeyDown:function(e){if(!this.oldAF&&pq.isCtrl(e)){var i=this,n=i.that.options;i.oldAF=n.autofill,n.autofill=!1,t(document.body).one("keyup",function(){n.autofill=i.oldAF,delete i.oldAF})}},onStop:function(){var t=this.that,e=t.options.autofill,i=this.sel,n=t.Selection().address()[0];i.r1===n.r1&&i.c1===n.c1&&i.r2===n.r2&&i.c2===n.c2||(this.locked=!1,e&&this.autofill(i,n)||t.Range(i).copy({dest:n}))},onStart:function(){this.locked=!0,this.sel=this.that.Selection().address()[0]},onDrag:function(e){var i=this.that,n=i.options.fillHandle,r="all"===n,o=r||"horizontal"===n,a=r||"vertical"===n,s=e.clientX-10,l=e.clientY,d=document.elementFromPoint(s,l),c=t(d).closest(".pq-grid-cell");if(c.length){var h=i.getCellIndices({$td:c}),u=this.sel,f=u.r1,p=u.c1,g=u.r2,v=u.c2,m={r1:f,c1:p,r2:g,c2:v},w=function(t,e){m[t]=e,i.Range(m).select()},x=h.rowIndx,y=h.colIndx;r&&x<=g&&x>=f||o&&!a?y>v?w("c2",y):y<p&&w("c1",y):a&&(x>g?w("r2",x):x<f&&w("r1",x))}},onDblClick:function(t,e){return function(){var i=t.options,n=i.fillHandle;if("all"===n||"vertical"===n){for(var r,o=t.Selection().address()[0],a=o.c2,s=o.r2+1,l=i.dataModel.data,d=t.getColModel()[a].dataIndx;r=l[s];){if(null!==r[d]&&""!==r[d]){s--;break}s++}e.onStart(),t.Range({r1:o.r1,c1:o.c1,r2:s,c2:a}).select(),e.onStop()}}}}}(jQuery),function(t){t(document).on("pqGrid:bootup",function(t,i){new e(i.instance)});var e=t.paramquery.cScroll=function(t){this.that=t,this.ns=".pqgrid-csroll",t.on("create",this.onCreate.bind(this))};e.prototype={onCreate:function(){var e=this.that,i=e.iDrop&&e.iDrop.isOn();t(i?document:e.$cont).on("mousedown",this.onMouseDown.bind(this))},onMouseDown:function(e){var i=this.that,n=t(e.target),r=this.$draggable=n.closest(".ui-draggable"),o=this.ns;(r.length||n.closest(i.$cont).length)&&t(document).on("mousemove"+o,this[r.length?"onMouseMove":"process"].bind(this)).on("mouseup"+o,this.onMouseUp.bind(this))},onMouseMove:function(t){(this.capture||pq.elementFromXY(t).closest(this.that.$cont).length&&this.that.iDrop.isOver())&&(this.capture=!0,this.process(t))},onMouseUp:function(){t(document).off(this.ns),this.capture=!1},process:function(t){var e=this.that.$cont,i=e[0].offsetHeight,n=e[0].offsetWidth,r=e.offset(),o=r.top,a=r.left,s=o+i,l=a+n,d=t.pageY,c=t.pageX,h=d-s,u=c-l,f=o-d,p=a-c;c>a&&c<l&&(h>0||f>0)?h>0?this.scrollV(h,!0):f>0&&this.scrollV(f):d>o&&d<s&&(u>0?this.scrollH(u,!0):p>0&&this.scrollH(p))},scrollH:function(t,e){this.scroll(t,e,!0)},scrollV:function(t,e){this.scroll(t,e)},scroll:function(t,e,i){var n=this.that.iRenderB,r=n.getContRight()[0],o=r[i?"scrollWidth":"scrollHeight"],a=r[i?"scrollLeft":"scrollTop"],s=o<1e3?1:1+(o-1e3)/o;t=Math.pow(t,s);var l=a+(e?t:-t);n[i?"scrollX":"scrollY"](l)}}}(jQuery),function(t){var e=jQuery.paramquery;e.cFormula=function(t){var e=this;e.that=t,e.oldF=[],t.one("ready",function(){t.on("CMInit",e.onCMInit(e))}).on("dataAvailable",function(){e.onDA()}).on(!0,"change",function(t,i){e.onChange(i)})},e.cFormula.prototype={onCMInit:function(t){return function(e,i){t.isFormulaChange(t.oldF,t.formulas())&&t.calcMainData()}},callRow:function(t,e,i){var n=this.that,r=0;if(t)for(r=0;r<i;r++){var o=e[r],a=o[0],s=o[1];t[a.dataIndx]=s.call(n,t,a)}},onDA:function(){this.calcMainData()},isFormulaChange:function(t,e){var i=!1,n=0,r=t.length;if(r===e.length){for(;n<r;n++)if(t[n][1]!==e[n][1]){i=!0;break}}else i=!0;return i},calcMainData:function(){var t=this.formulaSave(),e=this.that,i=t.length;if(i){for(var n=e.options.dataModel.data,r=n.length;r--;)this.callRow(n[r],t,i);e._trigger("formulaComputed")}},onChange:function(t){var e=this.formulas(),i=e.length,n=this,r=function(t){n.callRow(t.rowData,e,i)};i&&(t.addList.forEach(r),t.updateList.forEach(r))},formulas:function(){var t,e,i=this.that,n=[];return(i.options.formulas||[]).forEach(function(r){(t=i.getColumn({dataIndx:r[0]}))&&(e=r[1])&&n.push([t,e])}),n},formulaSave:function(){var t=this.formulas();return this.oldF=t,t}}}(),function(t){var e=t.paramquery;e.pqGrid.defaults.treeModel={cbId:"pq_tree_cb",source:"checkboxTree",childstr:"children",iconCollapse:["ui-icon-triangle-1-se","ui-icon-triangle-1-e"],iconFolder:["ui-icon-folder-open","ui-icon-folder-collapsed"],iconFile:"ui-icon-document",id:"id",indent:18,parentId:"parentId",refreshOnChange:!0},e.pqGrid.prototype.Tree=function(){return this.iTree},t(document).on("pqGrid:bootup",function(t,e){var n=e.instance;n.iTree=new i(n)});var i=e.cTree=function(t){this.model="treeModel",this.that=t,this.fns={},this.init(),this.cache={},this.di_prev,this.chkRows=[]};i.prototype=t.extend({},pq.mixin.ChkGrpTree,pq.mixin.GrpTree,{addNodes:function(t,e,i){var n,r,o,a,s=this,l=s.that,d=l.options.dataModel.data,c=s.parentId,h=s.childstr,u=s.id,f={},p=[],g=0,v=s.cache,m=function(t){if(v[t])throw"duplicate id";f[t]=1},w=[];if(e?(r=e[u],n=d.indexOf(e)+(null===i?(e[h]||[]).length:i)+1):n=d.length,t.forEach(function(t){var e=t[u];if(!f[e]&&(p.push(t),m(e),null!==r&&(t[c]=r),t[h])){var i=s.getChildrenAll(t);i.forEach(function(t){m(t[u])}),s.copyArray(p,i)}}),o=p.length){for(;g<o;g++)a=p[g],w.push({newRow:a,rowIndx:n++});l._digestData({addList:w,checkEditable:!1,source:"addNodes"}),s.refreshView()}},collapseAll:function(t){this[t?"expandNodes":"collapseNodes"](this.that.options.dataModel.data)},collapseNodes:function(t,e,i){for(var n,r,o=0,a=this.that,s=t.length,l=[],d=!i;o<s;o++)n=t[o],this.isFolder(n)&&this.isCollapsed(n)!==d&&l.push(n);if(l.length&&(r={close:d,nodes:l},!1!==a._trigger("beforeTreeExpand",e,r))){for(s=l.length,o=0;o<s;o++)(n=l[o]).pq_close=d;a._trigger("treeExpand",e,r),this.setCascadeInit(!1),this.refreshView()}},deleteNodes:function(t){var e,i,n=this.that,r=0,o={},a=this.id,s=[];if(t){for(e=t.length;r<e;r++)i=t[r],this.eachChild(i,function(t){var e=t[a];o[e]||(o[e]=1,s.push({rowData:t}))});n._digestData({deleteList:s,source:"deleteNodes"}),this.refreshView()}},expandAll:function(){this.collapseAll(!0)},expandNodes:function(t,e){this.collapseNodes(t,e,!0)},expandTo:function(t){var e=[];do{t.pq_close&&e.push(t)}while(t=this.getParent(t));this.expandNodes(e)},exportCell:function(t,e){for(var i="",n=0;n<e;n++)i+="- ";return i+(null===t?"":t)},filter:function(t,e,i,n,r,o){for(var a,s,l,d,c=this.childstr,h=0,u=t.length;h<u;h++)s=!1,(d=(a=t[h])[c])&&(s=this.filter(d,e,i,n,r,o))&&(l=!0,r.push(a)),s||(i.isMatchRow(a,e,n)?(l=!0,r.push(a)):o.push(a));return l},getFormat:function(){for(var t,e,i=this.that.options.dataModel.data,n=0,r=i.length,o=this.parentId,a=this.childstr;n<r&&null===(t=i[n])[o];n++)if((e=t[a])&&e.length)return this.getParent(e[0])===t?"flat":"nested";return"flat"},getChildrenAll:function(t,e){for(var i,n=this.childstr,r=t[n]||[],o=r.length,a=0,s=e||[];a<o;a++)i=r[a],s.push(i),i[n]&&this.getChildrenAll(i,s);return s},getLevel:function(t){return t.pq_level},_groupById:function(t,e,i,n,r){for(var o,a=this.childstr,s=0,l=i.length;s<l;s++){var d=i[s],c=d[e];d.pq_level=r,t.push(d),(o=n[c])?(d[a]=o,this._groupById(t,e,o,n,r+1)):delete d[a]}},groupById:function(t){for(var e,i,n,r=this.id,o=this.parentId,a={},s=[],l=0,d=t.length;l<d;l++)null===(e=(n=t[l])[o])&&(e=""),(i=a[e])||(i=a[e]=[]),i.push(n);return this._groupById(s,r,a[""]||[],a,0),s},init:function(){var t=this.that,e=t.options,i=e.treeModel,n=i.cbId,r=this.dataIndx=i.dataIndx;this.cbId=n,this.prop="pq_tree_prop",this.id=i.id,this.parentId=i.parentId,this.childstr=i.childstr,this.onCMInit(),r?this._init||(this.on("CMInit",this.onCMInit.bind(this)).on("dataAvailable",this.onDataAvailable(this,t,i)).on("dataReadyAfter",this.onDataReadyAfter(this,t,i)).on("beforeCellKeyDown",this.onBeforeCellKeyDown.bind(this)).on("customSort",this.onCustomSortTree.bind(this)).on("customFilter",this.onCustomFilter.bind(this)).on("clearFilter",this.onClearFilter.bind(this)).on("change",this.onChange(this,t,i)).on("cellClick",this.onCellClick.bind(this)).on("refresh refreshRow",this.onRefresh(this,i)).on("valChange",this.onCheckbox(this,i)).on("refreshHeader",this.onRefreshHeader.bind(this)).on("beforeCheck",this.onBeforeCheck.bind(this)),this.setCascadeInit(!0),this._init=!0):this._init&&(this.off(),this._init=!1),this._init&&(e.groupModel.on=i.summary)},initData:function(){var t=this.that.options.dataModel;t.data=this["flat"===this.getFormat()?"groupById":"flatten"](t.data),this.buildCache()},isCollapsed:function(t){return!!t.pq_close},isOn:function(){return null!==this.that.options.treeModel.dataIndx},moveNodes:function(t,e,i){var n,r,o,a,s,l=this.that,d=this.parentId,c=this.id,h=this.childstr,u=l.options.dataModel,f=e[h].length,p=e[c],g={},v=(i=null===i||i>=f?f:i,0);if(t.forEach(function(t){g[t[c]]=1}),a=(o=t.reduce(function(t,e){return g[e[d]]||t.push(e),t},[])).length){for(l._trigger("beforeMoveNode");v<a;v++)s=o[v],r=(n=this.getParent(s))[h].indexOf(s),n===e?i=pq.moveItem(s,e[h],r,i):(e[h].splice(i++,0,s),n[h].splice(r,1)),s[d]=p;u.data=this.flatten(this.getRoots()),l.refreshView(),l._trigger("moveNode")}},off:function(){var t,e=this.fns,i=this.that;for(t in e)i.off(t,e[t]);this.fns={}},on:function(t,e){return this.fns[t]=e,this.that.on(t,e),this},onCellClick:function(e,i){i.dataIndx===this.dataIndx&&t(e.originalEvent.target).hasClass("pq-group-icon")&&(pq.isCtrl(e)?this[i.rowData.pq_close?"expandAll":"collapseAll"]():this.toggleNode(i.rowData,e))},onBeforeCellKeyDown:function(e,i){var n,r,o=this.that,a=i.rowData,s=i.dataIndx,l=e.keyCode,d=t.ui.keyCode;if(s===this.dataIndx){if(this.isFolder(a)&&(r=a.pq_close,l===d.ENTER&&!o.isEditable({rowIndx:a.pq_ri,dataIndx:s})||!r&&l===d.LEFT||r&&l===d.RIGHT))return this.toggleNode(a),!1;if(l===d.SPACE&&(n=o.getCell(i).find("input[type='checkbox']")).length)return n.click(),!1}},onChange:function(t,e,i){return function(n,r){var o=r.source||"",a=r.addList.length,s=r.deleteList.length;-1===o.indexOf("checkbox")&&("undo"!==o&&"redo"!==o||!a&&!s?i.summary&&i.refreshOnChange&&!a&&!s?(t.summaryT(),e.refresh()):"addNodes"!==o&&"deleteNodes"!==o||t.refreshViewFull():t.refreshViewFull())}},onClearFilter:function(t,e){return e.data=this.groupById(e.data),!1},onCustomFilter:function(t,e){var i=this.that,n=this.groupById(e.data),r=i.iFilterData,o=e.filters,a=[],s=[],l=e.mode;return this.filter(this.getRoots(n),o,r,l,a,s),e.dataTmp=this.groupById(a),e.dataUF=s,!1},onDataAvailable:function(t){return function(){t.initData()}},onDataReadyAfter:function(t,e,i){return function(){i.summary&&t.summaryT(t),t.showHideRows(),t.isCascade(i)&&t.cascadeInit()}},option:function(e,i){var n,r=this.that,o=r.options.treeModel,a=o.dataIndx;t.extend(o,e),n=o.dataIndx,this.setCellRender(),this.init(),!a&&n&&this.initData(),!1!==i&&r.refreshView()},renderCell:function(t,e){return function(i){var n,r,o,a,s,l,d=i.rowData,c=t.that,h=e.indent,u=i.column,f=u.renderLabel||e.render,p=e.iconCollapse,g=e.checkbox,v=t.isFolder(d),m=t._iconCls(d,v,e),w=d.pq_level||0,x=w*h,y=["pq-group-title-cell"],C=["text-indent:",v?x:x+1*h,"px;"],b=i.formatVal||i.cellData;if(f){var I=c.callFn(f,i);null!==I&&("string"!=typeof I?(I.iconCls&&(m=I.iconCls),null!==I.text&&(b=I.text),a=I.attr,y.push(I.cls),C.push(I.style)):b=I)}return i.Export?t.exportCell(b,w):(g&&(s=t.renderCB(g,d,e.cbId))&&(l=s[0],s[1]&&y.push(s[1])),v&&(r="<span class='pq-group-icon ui-icon "+(d.pq_close?p[1]:p[0])+"'></span>"),m&&(o="<span class='pq-tree-icon ui-icon "+m+"'></span>"),n=l&&(u.useLabel||e.useLabel),{cls:y.join(" "),attr:a,style:C.join(""),text:[r,o,n?"<label style='width:100%;'>":"",l,b,n?"</label>":""].join("")})}},refreshViewFull:function(t){var e=this.that.options.dataModel;e.data=this.groupById(e.data),this.buildCache(),t&&this.refreshView()},_iconCls:function(t,e,i){if(i.icons){var n;if(e&&(n=i.iconFolder))return t.pq_close?n[1]:n[0];if(!t.pq_gsummary)return i.iconFile}},setCellRender:function(){var t,e,i=this.that,n=i.options.treeModel,r=i.columns;n.summary&&i.iGroup.refreshColumns(),(t=this.di_prev)&&((e=r[t])&&(e._render=null),this.di_prev=null),(t=n.dataIndx)&&((e=r[t])._render=this.renderCell(this,n),this.di_prev=t)},_showHideRows:function(t,e,i){for(var n,r,o,a=e||this.getRoots(),s=this.childstr,l=i||!1,d=a.length,c=0;c<d;c++)(n=a[c]).pq_hidden=l,(o=n[s])&&(r=l||n.pq_close,this._showHideRows(t,o,r))},showHideRows:function(){var t,e,i=this.that,n=0,r=i.get_p_data(),o=i.options.treeModel.summary;if(this._showHideRows(r),o)for(t=(r=i.pdata).length;n<t;n++)(e=r[n]).pq_gsummary&&(e.pq_hidden=this.getParent(e).pq_hidden)},toggleNode:function(t,e){this[t.pq_close?"expandNodes":"collapseNodes"]([t],e)}})}(jQuery),function(t){var e=jQuery.paramquery,i=e.pqGrid.prototype,n=function(t){this.that=t;var e=t.options;this.options=e,this.selection=[],this.hclass=" pq-state-select "+(e.bootstrap.on?"":"ui-state-highlight")};e.cRows=n,i.SelectRow=function(){return this.iRows},n.prototype={_add:function(t,e){var i,n=this.that,r=t.rowIndxPage,o=!e,a=t.rowData,s=this.inViewRow(r);return!a.pq_hidden&&s&&(i=n.getRow(t)).length&&(i[o?"addClass":"removeClass"](this.hclass),!o&&i.removeAttr("tabindex")),a.pq_rowselect=o,t},_data:function(t){t=t||{};var e=this.that,i=t.all,n=e.riOffset,r=i?0:n,o=e.get_p_data();return[o,r,r+(i?o.length:e.pdata.length)]},add:function(t){var e=t.addList=t.rows||[{rowIndx:t.rowIndx}];t.isFirst&&this.setFirst(e[0].rowIndx),this.update(t)},extend:function(t){var e,i,n,r,o,a=t.rowIndx,s=[],l=this.getFirst();if(null!==l){if(null===(o=this.isSelected({rowIndx:l})))return;for(l>a?(n=l=[a,a=l][0],r=a-1):(n=l+1,r=a),e=n;e<=r;e++)i={rowIndx:e},s.push(i);this.update(o?{addList:s}:{deleteList:s})}},getFirst:function(){return this._firstR},getSelection:function(){for(var t,e=this.that.get_p_data(),i=0,n=e.length,r=[];i<n;i++)(t=e[i])&&t.pq_rowselect&&r.push({rowIndx:i,rowData:t});return r},inViewCol:function(t){var e=this.that,i=e.options,n=e.iRenderB;return t<i.freezeCols||t>=n.initH&&t<=n.finalH},inViewRow:function(t){var e=this.that,i=e.options,n=e.iRenderB;return t<i.freezeRows||t>=n.initV&&t<=n.finalV},isSelected:function(t){var e=t.rowData||this.that.getRowData(t);return e?!0===e.pq_rowselect:null},isSelectedAll:function(t){for(var e,i=this._data(t),n=i[0],r=i[1],o=i[2];r<o;r++)if((e=n[r])&&!e.pq_rowselect)return!1;return!0},removeAll:function(t){this.selectAll(t,!0)},remove:function(t){var e=t.deleteList=t.rows||[{rowIndx:t.rowIndx}];t.isFirst&&this.setFirst(e[0].rowIndx),this.update(t)},replace:function(t){t.deleteList=this.getSelection(),this.add(t)},selectAll:function(t,e){for(var i,n=[],r=this.that.riOffset,o=this._data(t),a=o[0],s=o[1],l=o[2];s<l;s++)(i=a[s])&&n.push({rowIndx:s,rowIndxPage:s-r,rowData:i});this.update(e?{deleteList:n}:{addList:n},!0)},setFirst:function(t){this._firstR=t},toRange:function(){for(var t,e,i=[],n=this.that,r=n.get_p_data(),o=0,a=r.length;o<a;o++)r[o].pq_rowselect?null!==t?e=o:t=e=o:null!==t&&(i.push({r1:t,r2:e}),t=e=null);return null!==t&&i.push({r1:t,r2:e}),n.Range(i)},toggle:function(t){this[this.isSelected(t)?"remove":"add"](t)},toggleAll:function(t){this[this.isSelectedAll(t)?"removeAll":"selectAll"](t)},update:function(t,e){var i=this,n=i.that,r={source:t.source},o=function(t){return e?t:n.normalizeList(t)},a=o(t.addList||[]),s=o(t.deleteList||[]);if(a=a.filter(function(t){return!1===i.isSelected(t)}),s=s.filter(i.isSelected.bind(i)),a.length||s.length){if(r.addList=a,r.deleteList=s,!1===n._trigger("beforeRowSelect",null,r))return;r.addList.forEach(function(t){i._add(t)}),r.deleteList.forEach(function(t){i._add(t,!0)}),n._trigger("rowSelect",null,r)}}}}(),function(t){var e=t.paramquery;t(document).on("pqGrid:bootup",function(t,e){var n=e.instance;n.iImport=new i(n)}),e.pqGrid.prototype.importWb=function(t){return this.iImport.importWb(t)};var i=e.cImport=function(t){this.that=t};i.prototype={fillRows:function(t,e,i){for(var n=t.length;n<e;n++)t.push(i?{}:[])},generateCols:function(t,e,i){var n,r,o=pq.toLetter,a=[],s=0,l=pq.excel.colWidth,d=i?i.cells:[],c=[];for(d.forEach(function(t,e){var i=t.indx||e;c[i]=t.value}),(e=e||[]).forEach(function(t,e){var i=t.indx||e;a[i]={hidden:t.hidden,width:t.width,title:c[i]||""}}),t=Math.max(t,e.length);s<t;s++)r={title:(n=a[s]||{}).title||o(s),width:n.width||l,halign:"center"},n.hidden&&(r.hidden=!0),a[s]=r;return a},importS:function(t,i,n,r,o){var a,s,l,d,c,h,u,f=t.mergeCells,p=this,g=[],v=this.that,m=0,w=t.rows,x=t.frozenRows||0,y=w.length,C=0,b=v.options.colModel,I=0,_=b&&b.length,q=e.cFormulas.shiftRC();for(null!==o&&(I=o+1,h=w[o],w=w.slice(I),x=(x-=I)>0?x:0),C=0,y=w.length;C<y;C++)s=(a=w[C]).indx||C,l={},s!==C&&this.fillRows(g,s,!0),a.cells.forEach(function(t,e){d=t.indx||e,c=r&&_&&b[d]?b[d].dataIndx:d,l[c]=t.value,p.copyStyle(l,c,t),t.format&&p.copyFormat(l,c,t.format),(u=t.formula)&&p.copyFormula(l,c,I?q(u,0,-I):u),m<=d&&(m=d+1)}),a.hidden&&(l.pq_hidden=!0),g[s]=l;t.name&&v.option("title",t.name),i&&this.fillRows(g,g.length+i,!0),v.option("dataModel.data",g),m+=n||0,v.refreshCM(this.generateCols(m,t.columns,h)),v.option("mergeCells",(f||[]).map(function(t){var e=pq.getAddress(t);return e.r1-=I,e.r2-=I,e}).filter(function(t){return t.r1>=0})),v.option({freezeRows:x,freezeCols:t.frozenCols}),v.refreshDataAndView(),v._trigger("importWb")},copyFormula:function(t,e,i){(t.pq_fn=t.pq_fn||{})[e]=i},copyFormat:function(t,e,i){var n=t.pq_format=t.pq_format||{};i=pq.isDateFormat(i)?pq.excelToJui(i):pq.excelToNum(i),n[e]=i},copyStyle:function(t,e,i){var n,r=[];(n=i.font)&&r.push("font-family:"+n),(n=i.fontSize)&&r.push("font-size:"+n+"px"),(n=i.color)&&r.push("color:"+n),(n=i.bgColor)&&r.push("background:"+n),i.bold&&r.push("font-weight:bold"),i.italic&&r.push("font-style:italic"),i.underline&&r.push("text-decoration:underline"),(n=i.align)&&r.push("text-align:"+n),(n=i.valign)&&r.push("vertical-align:"+n),i.wrap&&r.push("white-space:normal"),(r=r.join(";"))&&((t.pq_cellattr=t.pq_cellattr||{})[e]={style:r})},importWb:function(t){var e=t.workbook,i=t.sheet||0,n=e.sheets.filter(function(t,e){return i===e||i===t.name})[0];n&&this.importS(n,t.extraRows,t.extraCols,t.keepCM,t.headerRowIndx)}}}(jQuery),function(t){var e;pq.excelImport={attr:(e=new RegExp('([a-z]+)\\s*=\\s*"([^"]*)"',"gi"),function(t){t=(t=t||"").slice(0,t.indexOf(">"));var i={};return t.replace(e,function(t,e,n){i[e]=n}),i}),cacheStyles:function(){var e,i,n,r=this,o=t(t.parseXML(r.getStyleText())),a=t.extend(!0,{},r.preDefFormats),s=[],l=[""],d=["",""];o.find("numFmts>numFmt").each(function(e,i){var n=t(i),r=n.attr("formatCode");a[n.attr("numFmtId")]=r}),o.find("fills>fill>patternFill>fgColor[rgb]").each(function(e,i){var n=r.getColor(t(i).attr("rgb"));d.push(n)}),o.find("fonts>font").each(function(n,o){var a=t(o),s=1*a.find("sz").attr("val"),d=a.find("name").attr("val"),c=a.find("color").attr("rgb"),h={};if(0===n)return e=s,void(i=d.toUpperCase());a.find("b").length&&(h.bold=!0),c&&(h.color=r.getColor(c)),d&&d.toUpperCase()!==i&&(h.font=d),s&&s!==e&&(h.fontSize=s),a.find("u").length&&(h.underline=!0),a.find("i").length&&(h.italic=!0),l.push(h)}),o.find("cellXfs>xf").each(function(e,i){var r,o,c,h=t(i),u=1*h.attr("numFmtId"),f=1*h.attr("fillId"),p=h.children("alignment"),g=1*h.attr("fontId"),v=g?l[g]:{},m={};for(c in p.length&&((r=p.attr("horizontal"))&&(m.align=r),(o=p.attr("vertical"))&&(m.valign=o),"1"===p.attr("wrapText")&&(m.wrap=!0)),u&&(n=a[u],/(?=.*m.*)(?=.*d.*)(?=.*y.*)/i.test(n)&&(n=n.replace(/(\[.*\]|[^mdy\/\-\s])/gi,"")),m.format=n),f&&d[f]&&(m.bgColor=d[f]),v)m[c]=v[c];s.push(m)}),r.getStyle=function(t){return s[t]},o=0},getMergeCells:function(t){var e=this;return(t.match(/<mergeCell\s+.*?(\/>|<\/mergeCell>)/g)||[]).map(function(t){return e.attr(t).ref})},getFrozen:function(t){var e=this.match(t,/<pane.*?(\/>|<\/pane>)/,0),i=this.attr(e),n=1*i.xSplit;return{r:1*i.ySplit||0,c:n||0}},getFormula:function(e){var i={},n=t.paramquery.cFormulas.shiftRC();return function(t,r,o){if("<f"===t.substr(0,2)){var a,s=e.match(t,/^<f.*?>(.*?)<\/f>/,1),l=e.attr(t);return"shared"===l.t&&(s?i[l.si]={r:r,c:o,f:s}:(a=i[l.si],s=n(a.f,o-a.c,r-a.r))),s}}},getCols:function(t){for(var e=(t.match(/<dimension\s.*?\/>/)||[])[0],i=this.attr(e||"").ref,n=[],r=t.match(/<col\s.*?\/>/g)||[],o=i?pq.getAddress(i).c2+1:r.length,a=pq.excel.colRatio,s=0;s<o;s++)for(var l,d=r[s],c=this.attr(d),h=1*c.min,u=1*c.max,f=1*c.hidden,p=1*c.width,g=h;g<=u;g++)l={},f?l.hidden=!0:l.width=1*(p*a).toFixed(2),g!==n.length+1&&(l.indx=g-1),n.push(l);return n},getColor:function(t){return"#"+t.slice(2)},getPath:function(t){return this.paths[t]},getPathSheets:function(){return this.pathSheets},getFileTextFromKey:function(t){return this.getFileText(this.getPath(t))},getFileText:function(t){return this.files[t.replace(/^\//,"")].asText()},getSheetText:function(t){t=t||0;var e=this.pathSheets.filter(function(e,i){return e.name===t||i===t})[0].path;return this.getFileText(e)},getStyleText:function(){return this.getFileTextFromKey("st")},getSI:function(t){var e,i=[],n=pq.unescapeXml,r=1*this.attr(this.match(t,/<sst.*?>[\s\S]*?<\/sst>/,0)).uniqueCount;if(t.replace(/<si>([\s\S]*?)<\/si>/g,function(t,r){e=[],r.replace(/<t.*?>([\s\S]*?)<\/t>/g,function(t,i){e.push(i)}),i.push(n(e.join("")))}),r&&r!==i.length)throw"si misatch";return i},getWorkBook:function(t,e,i){var n=this,r={};e?r[e]=!0:"string"==typeof t&&(r.base64=!0),n.files=new JSZip(t,r).files,this.readPaths(),this.cacheStyles();var o=this.getPath("ss"),a=[],s=o?this.getSI(this.getFileText(o)):[];return n.getPathSheets().forEach(function(t,e){if(!i||i.indexOf(e)>-1||i.indexOf(t.name)>-1){var r=n.getFileText(t.path),o=n.match(r,/<sheetData.*?>(.*?)<\/sheetData>/,1),l=n.getWorkSheet(r,o,s,t.name);a.push(l)}}),delete n.files,{sheets:a}},getWorkSheet:function(t,e,i,n){for(var r,o,a,s,l,d,c,h,u,f,p,g,v,m,w,x,y,C=[],b=0,I=pq.toNumber,_=this.getFormula(this),q=pq.isEmpty,D=pq.formulas,R=pq.isDateFormat,M=this.getMergeCells(t),T=e.match(/<row.*?<\/row>/g)||[],k=0,E=T.length;k<E;k++){d={cells:[]},w=T[k],(x=(y=(v=this.attr(w)).r)?y-1:k)!==k&&(d.indx=x),v.hidden&&(d.hidden=!0);for(var S=0,P=(c=w.match(/(<c[^<]*?\/>|<c.*?<\/c>)/g)||[]).length;S<P;S++){if(o=c[S],h=(m=this.attr(o)).t,g=this.match(o,/<c.*?>(.*?)(<\/c>)?$/,1),l={},"inlineStr"===h?f=g.match(/<t><!\[CDATA\[(.*?)\]\]><\/t>/)[1]:null!==(f=this.match(g,/<v>(.*?)<\/v>/,1)||void 0)&&(f="s"===h?i[f]:"str"===h?pq.unescapeXml(f):"b"===h?"1"===f:D.VALUE(f)),b=b>(p=(p=m.r)?I(p=p.replace(/\d+/,"")):S)?b:p,void 0!==f&&(l.value=f),p!==S&&(l.indx=p),(a=_(g,x,p))&&(l.formula=pq.unescapeXml(a)),(u=m.s)&&(u=this.getStyle(u))){for(r in u)l[r]=u[r];s=l.format,null!==f&&!a&&s&&R(s)&&(l.value=D.TEXT(f,"m/d/yyyy"))}!q(l)&&d.cells.push(l)}C.push(d)}var $={rows:C,name:n},A=this.getCols(t),H=this.getFrozen(t);return M.length&&($.mergeCells=M),A.length&&($.columns=A),H.r&&($.frozenRows=H.r),H.c&&($.frozenCols=H.c),$},Import:function(t,e){var i,n,r,o=this,a=t.file,s=t.content,l=t.url,d=function(i,n){e(o.getWorkBook(i,t.type||n,t.sheets))};l?(n="?"+Math.random(),window.Uint8Array?((r=new XMLHttpRequest).open("GET",l+n,!0),r.responseType="arraybuffer",r.onload=function(t){200===this.status&&d(r.response)},r.send()):JSZipUtils.getBinaryContent(l+n,function(t,e){d(e,"binary")})):a?((i=new FileReader).onload=function(t){d(t.target.result)},i.readAsArrayBuffer(a)):s&&d(s)},match:function(t,e,i){var n=t.match(e);return n?n[i]:""},preDefFormats:{1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",5:"$#,##0_);($#,##0)",6:"$#,##0_);[Red]($#,##0)",7:"$#,##0.00_);($#,##0.00)",8:"$#,##0.00_);[Red]($#,##0.00)",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yyyy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yyyy h:mm",37:"#,##0_);(#,##0)",38:"#,##0_);[Red](#,##0)",39:"#,##0.00_);(#,##0.00)",40:"#,##0.00_);[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mm:ss.0",48:"##0.0E+0",49:"@"},readPaths:function(){var e=this.files,i=t(t.parseXML(e["[Content_Types].xml"].asText())),n=this.paths={wb:"sheet.main",ws:"worksheet",st:"styles",ss:"sharedStrings"};for(var r in n)n[r]=i.find('[ContentType$="'+n[r]+'+xml"]').attr("PartName");for(r in e)if(/workbook.xml.rels$/.test(r)){n.wbrels=r;break}var o=t(this.getFileTextFromKey("wbrels")),a=t(this.getFileTextFromKey("wb")),s=this.pathSheets=[];a.find("sheet").each(function(e,n){var r=t(n),a=r.attr("r:id"),l=r.attr("name"),d=o.find('[Id="'+a+'"]').attr("Target"),c=i.find('Override[PartName$="'+d+'"]').attr("PartName");s.push({name:l,rId:a,path:c})})}}}(jQuery),function(t){var e=t.paramquery,i=e._pqGrid.prototype;i.exportExcel=function(t){return(t=t||{}).format="xlsx",this.exportData(t)},i.exportCsv=function(t){return(t=t||{}).format="csv",this.exportData(t)},i.exportData=function(t){return new n(this,t).Export(t)};var n=e.cExport=function(t,e){this.that=t};n.prototype=t.extend({copyStyle:function(t,e){var i,n,r,o,a,s,l;"string"==typeof e&&(l=e.split(";"),e={},l.forEach(function(t){t&&(l=t.split(":"))[0]&&l[1]&&(e[l[0].trim()]=l[1].trim())})),(i=e.background)&&(t.bgColor=i),(n=e["font-size"])&&(t.fontSize=parseFloat(n)),(o=e.color)&&(t.color=o),"normal"===e["white-space"]&&(t.wrap=!0),(a=e["text-align"])&&(t.align=a),(s=e["vertical-align"])&&(t.valign=s),"bold"===e["font-weight"]&&(t.bold=!0),(r=e["font-family"])&&(t.font=r),"italic"===e["font-style"]&&(t.italic=!0),"underline"===e["text-decoration"]&&(t.underline=!0)},getCsvHeader:function(t,e,i,n){for(var r,o,a,s=[],l=[],d=0;d<e;d++){for(var c=t[d],h=null,u=0,f=c.length;u<f;u++)(r=i[u]).hidden||!1===r.copy||(o=c[u],d>0&&o===t[d-1][u]?s.push(""):h&&u>0&&o===h?s.push(""):(a=(a=this.getTitle(o,u))?a.replace(/\"/g,'""'):"",h=o,s.push('"'+a+'"')));l.push(s.join(n)),s=[]}return l},getCSVContent:function(t,e,i,n,r,o,a,s,l,d,c,h,u){var f,p,g,v,m,w,x,y,C=t.separator||",",b=[];for(y=u?this.getCsvHeader(n,r,e,C):[],g=0;g<a;g++)if(!(m=o[g]).pq_hidden){v={rowIndx:w=s?g+l:g,rowIndxPage:w-l,rowData:m,Export:!0};for(var I=0;I<i;I++)if(!(x=e[I]).hidden&&!1!==x.copy){f=null,null,d.ismergedCell(w,I)?d.isRootCell(w,I)?((f=d.getRootCellO(w,I)).Export=!0,p=this.getRenderVal(f,c,h)[0]):p="":(v.colIndx=I,v.column=x,v.dataIndx=x.dataIndx,p=this.getRenderVal(v,c,h)[0]);var _=(null===p?"":p)+"";_=_.replace(/\"/g,'""'),b.push('"'+_+'"')}y.push(b.join(C)),b=[]}return"\ufeff"+y.join("\n")},getExportCM:function(t,e){return e>1?t:t.filter(function(t){return!1!==t.copy})},Export:function(t){if(!1===this.that._trigger("beforeExport",null,t))return!1;var e,i=this.that,n=i.options,r=n.groupModel,o="remote"===n.pageModel.type,a=i.riOffset,s=i.iRenderB,l=i.iMerge,d=i.headerCells,c=d.length,h=i.colModel,u=h.length,f=this.getExportCM(h,c),p=f.length,g=n.treeModel,v=r.on&&r.dataIndx.length||o||g.dataIndx&&g.summary?i.pdata:n.dataModel.data,m=(v=n.summaryData?v.concat(n.summaryData):v).length,w=t.render,x=!t.noheader,y=t.format;if("xlsx"===y){var C=this.getWorkbook(f,p,d,c,v,m,o,a,l,w,s,x,t.sheetName);if(!1===i._trigger("workbookReady",null,{workbook:C}))return C;if(t.workbook)return C;t.workbook=C,e=pq.excel.exportWb(t)}else t.data="json"===y?this.getJsonContent(t,v):"csv"===y?this.getCSVContent(t,h,u,d,c,v,m,o,a,l,w,s,x):this.getHtmlContent(t,h,u,d,c,v,m,o,a,l,w,s,x);return e=e||this.postRequest(t),i._trigger("exportData",null,t),e},getHtmlHeader:function(t,e){for(var i,n,r,o,a,s=[],l=0;l<e;l++){var d=t[l],c=null;s.push("<tr>");for(var h=0,u=d.length;h<u;h++)n=(i=d[h]).colSpan,!i.hidden&&n&&!1!==i.copy&&(r=i.rowSpan,l>0&&i===t[l-1][h]||c&&h>0&&i===c||(o=this.getTitle(i,h),c=i,a=(a=i.halign||i.align)?"align="+a:"",s.push("<th colspan=",n," rowspan=",r," ",a,">",o,"</th>")));s.push("</tr>")}return s.join("")},getHtmlBody:function(t,e,i,n,r,o,a,s,l){var d,c,h,u,f,p,g,v,m,w,x,y,C,b=[];for(d=0;d<n;d++)if(!(m=i[d]).pq_hidden){for(v={rowIndx:w=r?d+o:d,rowIndxPage:w-o,rowData:m,Export:!0},b.push("<tr>"),c=0;c<e;c++)if(!(h=t[c]).hidden&&!1!==h.copy){if(u=null,f=null,y="",a.ismergedCell(w,c)){if(!(f=a.isRootCell(w,c)))continue;(u=a.getRootCellO(w,c)).Export=!0,x=(p=this.getRenderVal(u,s,l))[0],g=p[1],y="rowspan="+f.rowspan+" colspan="+f.colspan+" "}else v.colIndx=c,v.column=h,v.dataIndx=h.dataIndx,x=(p=this.getRenderVal(v,s,l))[0],g=p[1];y+=(C=h.align)?"align="+C:"",x=null===x?"":x,x=pq.newLine(x),b.push("<td ",y,g?' style="'+g+'"':"",">",x,"</td>")}b.push("</tr>")}return b.join("")},getHtmlContent:function(t,e,i,n,r,o,a,s,l,d,c,h,u){var f=this.that,p=t.cssRules||"",g=f.element.find(".pq-grid-table"),v="table{empty-cells:show;font-family:"+g.css("font-family")+";font-size:"+g.css("font-size")+";border-collapse:collapse;}",m=[];return m.push("<!DOCTYPE html><html><head>",'<meta charset="utf-8" />',"<title>",t.title?t.title:"ParamQuery Pro","</title>","</head><body>","<style>",v,"td,th{padding: 5px;border:1px solid #ccc;}",p,"</style>","<table>"),m.push(u?this.getHtmlHeader(n,r,e):""),m.push(this.getHtmlBody(e,i,o,a,s,l,d,c,h)),m.push("</table></body></html>"),m.join("")},getJsonContent:function(t,e){return t.nostringify?e:JSON.stringify(e,t.nopqdata?function(t,e){if(0!==(t+"").indexOf("pq_"))return e}:null,t.nopretty?null:2)},getTitle:function(t,e){var i=t.title;return i?"function"==typeof i&&(i=i.call(this.that,{colIndx:e,column:t,dataIndx:t.dataIndx,Export:!0})):i="",i},getXlsMergeCells:function(t,e,i,n){t=t.concat(i.getMergeCells(e,this.curPage,n));for(var r=[],o=pq.toLetter,a=t.length,s=0;s<a;s++){var l=t[s];l=o(l.c1)+(l.r1+1)+":"+o(l.c2)+(l.r2+1),r.push(l)}return r},getXlsCols:function(t,e){for(var i,n,r,o=[],a=0,s=pq.excel.colWidth;a<e;a++)i={},(r=1*((n=t[a])._width||s).toFixed(2))!==s&&(i.width=r),n.hidden&&(i.hidden=!0),pq.isEmpty(i)||(o.length!==a&&(i.indx=a),o.push(i));return o},getXlsHeader:function(t,e,i){for(var n=[],r=0;r<e;r++){for(var o=t[r],a=[],s=0,l=o.length;s<l;s++){var d=o[s];if(!1!==d.copy){var c=d.o_colspan,h=d.rowSpan,u=this.getTitle(d,s);r>0&&d===t[r-1][s]?u="":s>0&&d===t[r][s-1]?u="":(c>1||h>1)&&i.push({r1:r,c1:s,r2:r+h-1,c2:s+c-1}),a.push({value:u,bgColor:"#eeeeee"})}}n.push({cells:a})}return n},getXlsBody:function(i,n,r,o,a,s,l,d,c,h){var u,f,p,g,v,m,w,x,y,C,b,I,_,q,D,R,M,T,k=this.that,E=[],S=e.cFormulas.shiftRC(k);for(f=0;f<o;f++){for(b=[],x={rowIndx:_=a?f+s:f,rowIndxPage:_-s,rowData:I=r[f],Export:!0},p=0;p<n;p++)q=(w=i[p]).dataIndx,M=I.pq_cellattr,g=m=I[q],v=k.getFormula(I,q),u=!1,l.ismergedCell(_,p)&&(l.isRootCell(_,p,"o")||(u=!0)),u||v||(x.colIndx=p,x.column=w,x.dataIndx=q,g=(y=this.getRenderVal(x,d,c))[0],C=y[1]),R={},"string"==typeof(T=this.getCellFormat(I,q)||w.format)&&(pq.isDateFormat(T)?(g!==m&&t.datepicker.formatDate(T,new Date(m))===g&&(g=m),T=pq.juiToExcel(T)):(g!==m&&pq.formatNumber(m,T)===g&&(g=m),T=pq.numToExcel(T)),R.format=T),void 0!==g&&(R.value=g),M&&(M=M[q])&&(M=M.style)&&this.copyStyle(R,M),C&&this.copyStyle(R,C),v&&(h&&(v=S(v,0,h)),R.formula=v),pq.isEmpty(R)||(R.dataIndx=q,b.length!==p&&(R.indx=p),b.push(R));D={},b.length&&(D.cells=b),I.pq_hidden&&(D.hidden=!0),pq.isEmpty(D)||(E.length!==f&&(D.indx=f),E.push(D))}return E},getCellFormat:function(t,e){var i=t.pq_format;return i&&i[e]},getWorkbook:function(t,e,i,n,r,o,a,s,l,d,c,h,u){var f,p=this.getXlsCols(t,e),g=[],v=this.that.options,m=v.freezeCols,w=h?n:0,x=w+(v.freezeRows||0),y=h?this.getXlsHeader(i,n,g):[],C=this.getXlsMergeCells(g,h?n:0,l,o),b=this.getXlsBody(t,e,r,o,a,s,l,d,c,w),I={columns:p,rows:y.concat(b)};return C.length&&(I.mergeCells=C),(f=y.length)&&(I.headerRows=f),x&&(I.frozenRows=x),m&&(I.frozenCols=m),(u||(u=v.title))&&(I.name=u),{sheets:[I]}},postRequest:function(e){var i,n,r=e.format,o=e.url,a=e.filename||"pqGrid";if(e.zip&&"xlsx"!==r){var s=new JSZip;s.file(a+"."+e.format,e.data),i=s.generate({type:"base64",compression:"DEFLATE"}),n=!0,r="zip"}else n=!!e.decodeBase,i=e.data;return o&&t.ajax({url:o,type:"POST",cache:!1,data:{pq_ext:r,pq_data:i,pq_decode:n,pq_filename:a},success:function(e){o=o+(o.indexOf("?")>0?"&":"?")+"pq_filename="+e,t(document.body).append("<iframe height='0' width='0' frameborder='0' src=\""+o+'"></iframe>')}}),i}},pq.mixin.render)}(jQuery);var pqEx=pq.excel={_tmpl:{rels:'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument" Target="workbook.xml"/></Relationships>'},eachRow:function(t,e){for(var i=t.rows,n=0,r=i.length;n<r;n++)e(i[n],n)},exportWb:function(t){var e=t.workbook,i=this._tmpl,n=this,r=[],o=e.sheets,a=o.length,s=new JSZip;s.file("[Content_Types].xml",this.getContentTypes(a)),o.forEach(function(t,e){var i=n.getCols(t.columns),o=n.getFrozen(t.frozenRows,t.frozenCols),a=n.getBody(t.rows),l=n.getMergeCells(t.mergeCells);r.push(t.name),s.file("worksheet"+(e+1)+".xml",n.getSheet(o,i,a,l))}),s.file("workbook.xml",this.getWBook(r)),s.file("styles.xml",n.getStyle());var l=s.folder("_rels");return l.file(".rels",i.rels),l.file("workbook.xml.rels",this.getWBookRels(a)),t.url?(t.data=s.generate({type:"base64",compression:"DEFLATE"}),t.decodeBase=!0,pq.postRequest(t)):s.generate({type:t.type||"blob",compression:"DEFLATE"})},eachCell:function(t,e,i){t.forEach(function(t,n){var r,o;if(r=t.cells){n=t.indx||n;for(var a=0,s=r.length;a<s;a++)o=r[a],e(o,o.indx||a,n,i)}else(r=t.rows)&&this.eachCell(r,e,n)},this)},findIndex:function(t,e){var i=t.findIndex(e);return t[i].indx||i},getArray:function(t){var e=[],i=this;return this.eachRow(t,function(t){var n=[];t.cells.forEach(function(t){n.push(i.getCell(t))}),e.push(n)}),e},getBody:function(t){var e,i,n,r,o,a,s,l,d,c,h,u,f,p,g,v,m,w,x,y,C,b,I,_,q,D,R=pq.formulas,M=[],T=t.length;for(e=0;e<T;e++){for(_=(h=(f=t[e]).cells).length,q=f.hidden?'hidden="1"':"",o='r="'+(n=(f.indx||e)+1)+'"',M.push("<row "+q+" "+o+">"),i=0;i<_;i++)u=(c=h[i]).value,a="",s="",o=(r=c.indx||i)===i?"":'r="'+pq.toLetter(r)+n+'"',D=c.format,p=c.bgColor,g=c.color,v=c.font,m=c.fontSize,C=c.bold,b=c.italic,I=c.underline,w=c.align,x=c.wrap,y=c.valign,d=(d=c.formula)?"<f>"+pq.escapeXml(d)+"</f>":"",null===u?l="<v></v>":u===parseFloat(u)&&(u+"").match(/^[0-9,-,\.]*$/g)?l="<v>"+u+"</v>":D&&R.isDate(u)?l="<v>"+R.VALUE(u)+"</v>":"boolean"==typeof u?(l="<v>"+(u?"1":"0")+"</v>",a='t="b"'):(a='t="inlineStr"',l="<is><t><![CDATA["+u+"]]></t></is>"),(D||p||g||m||w||y||x||C||b||I)&&(s='s="'+this.getStyleIndx(D,p,g,v,m,w,y,x,C,b,I)+'"'),M.push("<c "+a+" "+o+" "+s+">"+d+l+"</c>");M.push("</row>")}return M.join("")},getCell:function(t){var e=t.format,i=t.value;return e?pq.formulas.TEXT(i,e):i},getCSV:function(t){var e=[],i=this;return this.eachRow(t,function(t){var n=[];t.cells.forEach(function(t){n.push(i.getCell(t))}),e.push(n.join(","))}),e.join("\r\n")},getColor:function(){var t={},e=function(t){return 1===t.length?"0"+t:t};return function(i){var n,r,o=t[i];if(o||(/^#[0-9,a,b,c,d,e,f]{6}$/i.test(i)?r=i.replace("#",""):(n=i.match(/^rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)$/i))&&(r=e((1*n[1]).toString(16))+e((1*n[2]).toString(16))+e((1*n[3]).toString(16))),r&&6===r.length&&(o=t[i]="ff"+r)),o)return o;throw"invalid color: "+i}}(),_getCol:function(t,e,i,n,r){if(r){if(r===this.colWidth&&!n)return;r=' customWidth="1" width="'+(r=1*(r/this.colRatio).toFixed(2))+'"'}t.push('<col min="',e,'" max="',i,'" hidden="',n,'"',r,"/>")},getCols:function(t){if(!t||!t.length)return"";var e,i,n,r,o,a=[],s=0,l=0,d=0,c=t.length;for(a.push("<cols>");d<c;d++){var h=t[d],u=h.hidden?1:0,f=h.width;s=(h.indx||s)+1,n===f&&r===u&&s===l+1?i=s:(o&&(this._getCol(a,e,i,r,n),e=null),i=s,null===e&&(e=s)),n=f,r=u,l=s,o=!0}return this._getCol(a,e,i,r,n),a.push("</cols>"),a.join("")},getContentTypes:function(t){for(var e=[],i=1;i<=t;i++)e.push('<Override PartName="/worksheet'+i+'.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml"/>');return['<?xml version="1.0" encoding="UTF-8" standalone="yes"?>','<Types xmlns="http://schemas.openxmlformats.org/package/2006/content-types">','<Default Extension="rels" ContentType="application/vnd.openxmlformats-package.relationships+xml"/>','<Override PartName="/workbook.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml"/>',e.join(""),'<Override PartName="/styles.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml"/>',"</Types>"].join("")},getFillIndx:function(t){var e=this.fills=this.fills||{length:2};return this.getIndx(e,t)},getFontIndx:function(t,e,i,n,r,o){var a=this.fonts=this.fonts||{length:1};return this.getIndx(a,(t||"")+"_"+(e||"")+"_"+(i||"")+"_"+(n||"")+"_"+(r||"")+"_"+(o||""))},getFormatIndx:function(t){var e=this.formats=this.formats||{length:164};return this.numFmtIds[t]||this.getIndx(e,t)},getFrozen:function(t,e){return['<sheetViews><sheetView workbookViewId="0">','<pane xSplit="',e=e||0,'" ySplit="',t=t||0,'" topLeftCell="',pq.toLetter(e)+(t+1),'" activePane="bottomLeft" state="frozen"/>',"</sheetView></sheetViews>"].join("")},getIndx:function(t,e){var i=t[e];return null===i&&(i=t[e]=t.length,t.length++),i},getItem:function(t,e){var i,n,r=t[e],o=0,a=0,s=r?r.indx:-1;if(null===s||e===s)return r;if((i=-1===s?t.length-1:e)>=0)for(;;){if(++a>20)throw"not found";if((s=(r=t[n=Math.floor((i+o)/2)]).indx)===e)return r;if(s>e?i=n:o=n===o?n+1:n,o===i&&n===o)break}},getMergeCells:function(t){var e=[],i=0,n=(t=t||[]).length;for(e.push('<mergeCells count="'+n+'">');i<n;i++)e.push('<mergeCell ref="',t[i],'"/>');return e.push("</mergeCells>"),n?e.join(""):""},getWBook:function(t){return['<?xml version="1.0" encoding="UTF-8" standalone="yes"?><workbook xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships">',"<bookViews><workbookView /></bookViews><sheets>",t.map(function(t,e){return e++,['<sheet name="',t?pq.escapeXml(t):"sheet"+e,'" sheetId="',e,'" r:id="rId',e,'"/>'].join("")}).join(""),"</sheets></workbook>"].join("")},getWBookRels:function(t){for(var e=[],i=1;i<=t;i++)e.push('<Relationship Id="rId'+i+'" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet" Target="/worksheet'+i+'.xml"/>');return['<?xml version="1.0" encoding="UTF-8" standalone="yes"?>','<Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">',e.join(""),'<Relationship Id="rId',i,'" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles" Target="/styles.xml"/>',"</Relationships>"].join("")},getSheet:function(t,e,i,n){return['<?xml version="1.0" encoding="UTF-8" standalone="yes"?><worksheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships">',t,e,"<sheetData>",i,"</sheetData>",n,"</worksheet>"].join("")},getStyleIndx:function(t,e,i,n,r,o,a,s,l,d,c){var h=(t?this.getFormatIndx(t):"")+"_"+(e?this.getFillIndx(e):"")+"_"+(i||n||r||l||d||c?this.getFontIndx(i,n,r,l,d,c):"")+"_"+(o||"")+"_"+(a||"")+"_"+(s||""),u=this.styles=this.styles||{length:1};return this.getIndx(u,h)},getStyle:function(){var t,e,i,n,r,o,a,s,l,d,c,h,u,f,p,g,v,m,w=this.formats,x=this.fills,y=this.fonts,C=this.styles,b=[],I=[],_=[],q=['<xf numFmtId="0" applyNumberFormat="1"/>'];if(w){for(m in delete w.length,w)b.push('<numFmt numFmtId="'+w[m]+'" formatCode="'+m+'"/>');delete this.formats}if(x){for(m in delete x.length,x)I.push('<fill><patternFill patternType="solid"><fgColor rgb="'+this.getColor(m)+'"/></patternFill></fill>');delete this.fills}if(y){for(m in delete y.length,y)t="<color "+((a=m.split("_"))[0]?'rgb="'+this.getColor(a[0])+'"':'theme="1"')+" />",i='<name val="'+(a[1]||"Calibri")+'"/>',e='<sz val="'+(a[2]||11)+'"/>',n=a[3]?"<b/>":"",r=a[4]?"<i/>":"",o=a[5]?"<u/>":"",_.push("<font>",n,r,o,e,t,i,'<family val="2"/></font>');delete this.fonts}if(C){for(m in delete C.length,C)s=(a=m.split("_"))[0],l=a[1],d=a[2],c=a[3],f=l?' applyFill="1" fillId="'+l+'" ':"",g=d?' applyFont="1" fontId="'+d+'" ':"",p=s?' applyNumberFormat="1" numFmtId="'+s+'"':"",h=(h=a[4])?' vertical="'+h+'" ':"",u=(u=a[5])?' wrapText="1" ':"",v=(c=c?' horizontal="'+c+'" ':"")||h||u?' applyAlignment="1"><alignment '+c+h+u+"/></xf>":"/>",q.push("<xf "+p+f+g+v);delete this.styles}return b=b.join("\n"),q=q.join("\n"),I=I.join("\n"),['<?xml version="1.0" encoding="UTF-8" standalone="yes"?>','<styleSheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main">',"<numFmts>",b,"</numFmts>","<fonts>",'<font><sz val="11"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font>',_=_.join(""),"</fonts>",'<fills><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill>',I,"</fills>",'<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>','<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/>',"</cellStyleXfs>","<cellXfs>",q,"</cellXfs>",'<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>','<dxfs count="0"/><tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleLight16"/>',"</styleSheet>"].join("")},importXl:function(){var t=pq.excelImport;return t.Import.apply(t,arguments)},SpreadSheet:function(t){var e,i=pqEx.SpreadSheet;if(this instanceof i==!1)return new i(t);for(e in t)this[e]=t[e]}};pqEx.colRatio=8,pqEx.colWidth=8.43*pqEx.colRatio,pqEx.numFmtIds=function(){var t=pq.excelImport.preDefFormats,e={};for(var i in t)e[t[i]]=i;return e}(),pq.postRequest=function(t){var e,i,n=t.format,r=t.url,o=t.filename||"pqGrid";if(t.zip&&"xlsx"!==n){var a=new JSZip;a.file(o+"."+t.format,t.data),e=a.generate({type:"base64",compression:"DEFLATE"}),i=!0,n="zip"}else i=!!t.decodeBase,e=t.data;return r&&$.ajax({url:r,type:"POST",cache:!1,data:{pq_ext:n,pq_data:e,pq_decode:i,pq_filename:o},success:function(t){r=r+(r.indexOf("?")>0?"&":"?")+"pq_filename="+t,$(document.body).append("<iframe height='0' width='0' frameborder='0' src=\""+r+'"></iframe>')}}),e},pqEx.SpreadSheet.prototype={getCell:function(t,e){var i=this.rows||[],n=pqEx.getItem(i,t)||{cells:[]};return pqEx.getItem(n.cells,e)}},function($){var _pq=$.paramquery;_pq.pqGrid.defaults.formulasModel={on:!0},_pq.pqGrid.prototype.getFormula=function(t,e){var i=this.iFormulas.getFnW(t,e);return i?i.fn:void 0},$(document).on("pqGrid:bootup",function(t,e){var i=e.instance;i.options.formulasModel.on&&(i.iFormulas=new cFormulas(i))});var cFormulas=_pq.cFormulas=function(t){var e=this;e.that=t,e.fn={},t.on("dataReadyDone",function(){e.onDataReadyDone()}).on("columnOrder",function(){e.onColumnOrder()}).on("beforeValidateDone",function(t,i){e.onBeforeValidateDone(i)}).on("autofillSeries",function(t,i){e.onAutofill(i)}).on("editorBegin",function(t,i){e.onEditorBegin(i)}).on("editorEnd",function(){e.onEditorEnd()}).on("editorKeyUp editorClick",function(t,i){e.onEditorKeyUp(t,i)}).on(!0,"change",function(t,i){e.onChange(i)})};$.extend(cFormulas,{deString:function(t,e,i){var n=[];return t=e(t=t.replace(/"(([^"]|"")+)"/g,function(t,e){return n.push(e),"#"+(n.length-1)+"#"})),n.forEach(function(e,n){i&&(e=e.replace(/""/g,'\\"')),t=t.replace("#"+n+"#",'"'+e+'"')}),t},selectExp:function(t,e){var i,n,r,o=t.slice(0,e).replace(/"[^"]*"/g,"");if(!/"[^"]+$/.test(o)&&(r=t.slice(e),(i=o.match(/.*?([a-z0-9:$]+)$/i))&&(""===r&&(n=[])||(n=r.match(/^([a-z0-9:$]+)?.*/i)))))return(i[1]+(null===n[1]?"":n[1])).replace(/\$/g,"").toUpperCase()},shiftRC:function(t){var e=cFormulas,i=t?t.get_p_data().length-1:0,n=t?t.colModel.length-1:0;return function(t,r,o){return r&&(t=e.shiftC(t,r,n)),o&&(t=e.shiftR(t,o,i)),t}},shiftR:function(t,e,i){return cFormulas.deString(t,function(t){return(t=t.replace(/(\$?)([A-Z]+)(\$?)([\d]+)/g,function(t,n,r,o,a){if(o)return t;var s=1*a+e-1;return n+r+((s=s<0?0:i&&s>i?i:s)+1)})).replace(/(\$?)([0-9]+):(\$?)([0-9]+)/g,function(t,n,r,o,a){var s;return n||(r=(s=(s=1*r+e-1)<0?0:i&&s>i?i:s)+1),o||(a=(s=(s=1*a+e-1)<0?0:i&&s>i?i:s)+1),n+r+":"+o+a})})},shiftC:function(t,e,i){return cFormulas.deString(t,function(t){return(t=t.replace(/(\$?)([A-Z]+)(\$?)([\d]+)/g,function(t,n,r,o,a){if(n)return t;var s=pq.toNumber(r)+e;return s=s<0?0:i&&s>i?i:s,pq.toLetter(s)+o+a})).replace(/(\$?)([A-Z]+):(\$?)([A-Z]+)/g,function(t,n,r,o,a){var s;return n||(s=(s=pq.toNumber(r)+e)<0?0:i&&s>i?i:s,r=pq.toLetter(s)),o||(s=(s=pq.toNumber(a)+e)<0?0:i&&s>i?i:s,a=pq.toLetter(s)),n+r+":"+o+a})})}}),cFormulas.prototype={addRowIndx:function(t){t.forEach(function(t){var e,i,n=t.newRow,r=n.pq_fn;if(r)for(i in r)(e=r[i]).ri=e.riO=n.pq_ri})},cell:function(t){var e=this.toCell(t),i=e.r,n=e.c;return this.valueArr(i,n)[0]},check:function(t){return cFormulas.deString(t,function(t){return(t=t.split(" ").join("")).toUpperCase().replace(/([A-Z]+)([0-9]+)\:([A-Z]+)([0-9]+)/g,function(t,e,i,n,r){return(e=pq.toNumber(e))>(n=pq.toNumber(n))&&(e=[n,n=e][0]),1*i>1*r&&(i=[r,r=i][0]),pq.toLetter(e)+i+":"+pq.toLetter(n)+r})})},computeAll:function(){var t,e=this,i=e.that;if(e.initObj(),e.eachFormula(function(e){e.clean=0,t=!0}),t)return e.eachFormula(function(t,n,r,o,a){n[r]=e.execIfDirty(t),a&&i.isValid({rowIndx:o,rowData:n,dataIndx:r,allowInvalid:!0})}),!0},eachFormula:function(t){var e=!0,i=this.that,n=function(i,n,r){var o,a;for(o in r)"string"!=typeof(a=r[o])&&t(a,i,o,n,e)},r=function(t){for(var e,i,r=(t=t||[]).length;r--;)(e=t[r])&&(i=e.pq_fn)&&n(e,r,i)};r(i.get_p_data()),e=!1,r(i.options.summaryData)},execIfDirty:function(t){if(t.clean){if(.5===t.clean)return}else t.clean=.5,t.val=this.exec(t.fn,t.ri,t.ci),t.clean=1;return t.val},exec:function(_fn,r,c){var self=this,obj=self.obj,fn=cFormulas.deString(_fn,function(t){return t=(t=(t=t.replace(/(\$?([A-Z]+)?\$?([0-9]+)?\:\$?([A-Z]+)?\$?([0-9]+)?)/g,function(t,e){return obj[e]=obj[e]||self.range(e),"obj['"+e+"']"})).replace(/(?:[^:]|^)(\$?[A-Z]+\$?[0-9]+)(?!:)/g,function(t,e){obj[e]=obj[e]||self.cell(e);var i=t.charAt(0);return(t===e?"":"$"===i?"":i)+e})).replace(/{/g,"[").replace(/}/g,"]").replace(/(?:[^><])(=+)/g,function(t,e){return t+(1===e.length?"=":"")}).replace(/<>/g,"!=").replace(/&/g,"+")},!0);obj.getRange=function(){return{r1:r,c1:c}};try{var v=eval(fn);"function"==typeof v?v="#NAME?":"string"==typeof v&&cFormulas.deString(v,function(t){t.indexOf("function")>=0&&(v="#NAME?")}),v!=v&&(v=null)}catch(t){v="string"==typeof t?t:t.message}return v},initObj:function(){this.obj=$.extend({iFormula:this},pq.formulas)},onAutofill:function(t){var e=t.sel,i=this.that,n=e.r,r=e.c,o=t.x,a=i.getRowData({rowIndx:n}),s=i.colModel,l=s.length-1,d=i.get_p_data().length-1,c=s[r].dataIndx,h=this.getFnW(a,c);h&&(t.series=function(t){return"="+(o?cFormulas.shiftC(h.fn,t-1,l):cFormulas.shiftR(h.fn,t-1,d))})},onBeforeValidateDone:function(t){var e=this,i=this.that.colIndxs,n=function(n){n.forEach(function(n){var r,o,a,s=n.newRow,l=n.rowData;for(o in s)if("string"==typeof(r=s[o])&&"="===r[0]){t.allowInvalid=!0;var d=e.check(r),c=l?e.getFnW(l,o):null;c?d!==c.fn&&(n.oldRow[o]="="+c.fn,e.save(l,o,d,n.rowIndx,i[o])):e.save(l||s,o,d,n.rowIndx,i[o])}else l&&(a=e.remove(l,o))&&(n.oldRow[o]="="+a.fn)})};n(t.addList),n(t.updateList)},onChange:function(t){this.addRowIndx(t.addList),t.addList.length||t.deleteList.length||this.computeAll()&&"edit"===t.source&&this.that.refresh({header:!1})},onColumnOrder:function(){var t,e,i=this.that,n=cFormulas.shiftRC(i),r=i.colIndxs;this.eachFormula(function(i,o,a){t=r[a],i.ci!==t&&(e=t-i.ciO,i.ci=t,i.fn=n(i.fnOrig,e,i.ri-i.riO))}),null!==t&&this.computeAll()},onEditorBegin:function(t){var e=this.getFnW(t.rowData,t.dataIndx);e&&t.$editor.val("="+e.fn)},onEditorEnd:function(){pq.intel.hide()},onEditorKeyUp:function(t,e){var i=e.$editor,n=i[0],r=n.value,o=pq.intel,a=n.selectionEnd;r&&0===r.indexOf("=")&&(o.popup(r,a,i),this.select(r,a))},onDataReadyDone:function(){var t,e=this,i=e.that,n=cFormulas.shiftRC(i),r=i.colIndxs,o=function(i,o,a){var s,l,d;for(l in a)s=a[l],t=!0,"string"==typeof s?e.save(i,l,e.check(s),o,r[l]):s.ri!==o&&(d=o-s.riO,s.ri=o,s.fn=n(s.fnOrig,s.ci-s.ciO,d))},a=function(t){for(var e,i,n=(t=t||[]).length;n--;)(e=t[n])&&(i=e.pq_fn)&&o(e,n,i)};a(i.get_p_data()),a(i.options.summaryData),e.initObj(),t&&e.computeAll()},getFnW:function(t,e){var i;if(i=t.pq_fn)return i[e]},remove:function(t,e){var i,n=t.pq_fn;if(n&&(i=n[e]))return delete n[e],pq.isEmpty(n)&&delete t.pq_fn,i},range:function(t){var e=t.split(":"),i=this.that,n=this.toCell(e[0]),r=n.r,o=n.c,a=this.toCell(e[1]),s=a.r,l=a.c;return this.valueArr(null===r?0:r,null===o?0:o,null===s?i.get_p_data().length-1:s,null===l?i.colModel.length-1:l)},save:function(t,e,i,n,r){var o=i.replace(/^=/,""),a={clean:0,fn:o,fnOrig:o,riO:n,ciO:r,ri:n,ci:r};return(t.pq_fn=t.pq_fn||{})[e]=a,a},selectRange:function(t,e){var i,n,r,o,a=cFormulas.selectExp(t,e);if(a)return/^([a-z0-9]+):([a-z0-9]+)$/i.test(a)?(i=a.split(":"),n=this.toCell(i[0]),r=this.toCell(i[1]),o={r1:n.r,c1:n.c,r2:r.r,c2:r.c}):/^[a-z]+[0-9]+$/i.test(a)&&(o={r1:(n=this.toCell(a)).r,c1:n.c}),o},select:function(t,e){var i=this.selectRange(t,e),n=this.that;i?n.Range(i).select():n.Selection().removeAll()},toCell:function(t){var e=t.match(/\$?([A-Z]+)?\$?(\d+)?/);return{c:e[1]?pq.toNumber(e[1]):null,r:e[2]?e[2]-1:null}},valueArr:function(t,e,i,n){var r,o,a,s,l,d,c=this.that,h=c.colModel,u=h.length,f=[],p=[],g=[],v=c.get_p_data(),m=v.length;for(n=null===n?e:n,e=e<0?0:e,i=(i=null===i?t:i)>=m?m-1:i,n=n>=u?u-1:n,r=t=t<0?0:t;r<=i;r++){for(a=v[r],o=e;o<=n;o++)s=h[o].dataIndx,d=(l=this.getFnW(a,s))?this.execIfDirty(l):a[s],f.push(d),g.push(d);p.push(g),g=[]}return f.get2Arr=function(){return p},f.getRange=function(){return{r1:t,c1:e,r2:i,c2:n}},f}}}(jQuery),function(t){var e=window.pq=window.pq||{};e.intel={removeFn:function(t){return t.length===(t=t.replace(/[a-z]*\([^()]*\)/gi,"")).length?t:this.removeFn(t)},removeStrings:function(t){return(t=t.replace(/"[^"]*"/g,"")).replace(/"[^"]*$/,"")},getMatch:function(t,i){var n,r=e.formulas,o=[];for(n in t=t.toUpperCase(),r)if(i){if(n===t)return[n]}else 0===n.indexOf(t)&&o.push(n);return o},intel:function(t){t=this.removeStrings(t);var e,i,n;return(e=(t=this.removeFn(t)).match(/^=(.*[,+\-&*\s(><=])?([a-z]+)((\()[^)]*)?$/i))&&(i=e[2],e[4]&&(n=!0)),[i,n]},movepos:function(t){var e;return(e=t.match(/([^a-z].*)/i))?t.indexOf(e[1])+1:t.length},intel3:function(t,e){e<t.length&&/=(.*[,+\-&*\s(><=])?[a-z]+$/i.test(t.slice(0,e))&&(e+=this.movepos(t.slice(e)));var i=t.substr(0,e);return this.intel(i)},item:function(t){var e=this.that.options.strFormulas;return"<div>"+((e=e?e[t]:null)?e[0]:t)+"</div>"+(e?"<div style='font-size:0.9em;color:#888;margin-bottom:5px;'>"+e[1]+"</div>":"")},popup:function(e,i,n){var r,o,a=n.closest(".pq-grid"),s=t(".pq-intel"),l=a,d=this.intel3(e,i);this.that=a.pqGrid("instance"),s.remove(),(r=d[0])&&(o=this.getMatch(r,d[1]).map(this.item,this).join(""))&&t("<div class='pq-intel' style='width:350px;max-height:300px;overflow:auto;background:#fff;border:1px solid gray;box-shadow: 4px 4px 2px #aaaaaa;padding:5px;'></div>").appendTo(l).html(o).position({my:"center top",at:"center bottom",collision:"flipfit",of:n,within:l})},hide:function(){t(".pq-intel").remove()}}}(jQuery),function($){var f=pq.formulas={evalify:function(t,e){var i,n,r=e.match(/([><=]{1,2})?(.*)/),o=r[1]||"=",a=r[2],s=this;return/(\*|\?)/.test(a)?i=a.replace(/\*/g,".*").replace(/\?/g,"\\S").replace(/\(/g,"\\(").replace(/\)/g,"\\)"):(o="="===o?"==":"<>"===o?"!=":o,n=this.isNumber(a)),t.map(function(t){return t=i?("<>"===o?"!":"")+"/^"+i+'$/i.test("'+(t=null===t?"":t)+'")':n?s.isNumber(t)?t+o+a:"false":'"'+((t=null===t?"":t)+"").toUpperCase()+'"'+o+'"'+(a+"").toUpperCase()+'"'})},get2Arr:function(t){return t.get2Arr?t.get2Arr():t},isNumber:function(t){return parseFloat(t)===t},_reduce:function(t,e){t.length;var i=[],n=e.map(function(t){return[]});return t.forEach(function(t,r){null!==t&&(t*=1,isNaN(t)||(i.push(t),n.forEach(function(t,i){t.push(e[i][r])})))}),[i,n]},reduce:function(t){var e=(t=this.toArray(t)).shift(),i=t.filter(function(t,e){return e%2==0}),n=this._reduce(e,i);return e=n[0],i=n[1],[e].concat(t.map(function(e,n){return n%2==0?i[n/2]:t[n]}))},strDate1:"(\\d{1,2})/(\\d{1,2})/(\\d{2,4})",strDate2:"(\\d{4})-(\\d{1,2})-(\\d{1,2})",strTime:"(\\d{1,2})(:(\\d{1,2}))?(:(\\d{1,2}))?(\\s(AM|PM))?",isDate:function(t){return this.reDate.test(t)&&Date.parse(t)||t&&t.constructor===Date},toArray:function(t){for(var e=[],i=0,n=t.length;i<n;i++)e.push(t[i]);return e},valueToDate:function(t){var e=new Date(Date.UTC(1900,0,1));return e.setUTCDate(e.getUTCDate()+t-2),e},varToDate:function(t){var e,i,n,r,o;if(this.isNumber(t))e=this.valueToDate(t);else if(t.getTime)e=t;else if("string"==typeof t){if((i=t.match(this.reDateTime))?i[12]?(o=1*i[13],r=1*i[15],n=1*i[14]):(n=1*i[2],r=1*i[3],o=1*i[4]):(i=t.match(this.reDate2))?(o=1*i[1],r=1*i[3],n=1*i[2]):(i=t.match(this.reDate1))&&(n=1*i[1],r=1*i[2],o=1*i[3]),!i)throw"#N/A date";t=Date.UTC(o,n-1,r),e=new Date(t)}return e},_IFS:function(arg,fn){for(var len=arg.length,i=0,arr=[],a=0;i<len;i+=2)arr.push(this.evalify(arg[i],arg[i+1]));for(var condsIndx=arr[0].length,lenArr=len/2,j;condsIndx--;){for(j=0;j<lenArr&&eval(arr[j][condsIndx]);j++);a+=j===lenArr?fn(condsIndx):0}return a},ABS:function(t){return Math.abs(t.map?t[0]:t)},ACOS:function(t){return Math.acos(t)},AND:function(){var arr=this.toArray(arguments);return eval(arr.join(" && "))},ASIN:function(t){return Math.asin(t)},ATAN:function(t){return Math.atan(t)},_AVERAGE:function(t){var e=0,i=0;if(t.forEach(function(t){parseFloat(t)===t&&(i+=1*t,e++)}),e)return i/e;throw"#DIV/0!"},AVERAGE:function(){return this._AVERAGE(pq.flatten(arguments))},AVERAGEIF:function(t,e,i){return this.AVERAGEIFS(i||t,t,e)},AVERAGEIFS:function(){var t=this.reduce(arguments),e=0,i=t.shift(),n=this._IFS(t,function(t){return e++,i[t]});if(!e)throw"#DIV/0!";return n/e},TRUE:!0,FALSE:!1,CEILING:function(t){return Math.ceil(t)},CHAR:function(t){return String.fromCharCode(t)},CHOOSE:function(){var t=pq.flatten(arguments),e=t[0];if(e>0&&e<t.length)return t[e];throw"#VALUE!"},CODE:function(t){return(t+"").charCodeAt(0)},COLUMN:function(t){return(t||this).getRange().c1+1},COLUMNS:function(t){var e=t.getRange();return e.c2-e.c1+1},CONCATENATE:function(){var t=pq.flatten(arguments),e="";return t.forEach(function(t){e+=t}),e},COS:function(t){return Math.cos(t)},_COUNT:function(t){var e=pq.flatten(t),i=this,n=0,r=0,o=0;return e.forEach(function(t){null===t||""===t?n++:(r++,i.isNumber(t)&&o++)}),[n,r,o]},COUNT:function(){return this._COUNT(arguments)[2]},COUNTA:function(){return this._COUNT(arguments)[1]},COUNTBLANK:function(){return this._COUNT(arguments)[0]},COUNTIF:function(t,e){return this.COUNTIFS(t,e)},COUNTIFS:function(){return this._IFS(arguments,function(){return 1})},DATE:function(t,e,i){if(t<0||t>9999)throw"#NUM!";return t<=1899&&(t+=1900),this.VALUE(new Date(Date.UTC(t,e-1,i)))},DATEVALUE:function(t){return this.DATEDIF("1/1/1900",t,"D")+2},DATEDIF:function(t,e,i){var n,r=this.varToDate(e),o=this.varToDate(t),a=(r.getTime()-o.getTime())/864e5;if("Y"===i)return parseInt(a/365);if("M"===i)return n=r.getUTCMonth()-o.getUTCMonth()+12*(r.getUTCFullYear()-o.getUTCFullYear()),o.getUTCDate()>r.getUTCDate()&&n--,n;if("D"===i)return a;throw"unit N/A"},DAY:function(t){return this.varToDate(t).getUTCDate()},DAYS:function(t,e){return this.DATEDIF(e,t,"D")},DEGREES:function(t){return 180/Math.PI*t},EOMONTH:function(t,e){e=e||0;var i=this.varToDate(t);return i.setUTCMonth(i.getUTCMonth()+e+1),i.setUTCDate(0),this.VALUE(i)},EXP:function(t){return Math.exp(t)},FIND:function(t,e,i){return e.indexOf(t,i?i-1:0)+1},FLOOR:function(t,e){return t*e<0?"#NUM!":parseInt(t/e)*e},HLOOKUP:function(t,e,i,n){null===n&&(n=!0),e=this.get2Arr(e);var r=this.MATCH(t,e[0],n?1:0);return this.INDEX(e,i,r)},HOUR:function(t){return Date.parse(t)?new Date(t).getHours():24*t},IF:function(t,e,i){return t?e:i},INDEX:function(t,e,i){return e=e||1,i=i||1,"function"==typeof(t=this.get2Arr(t))[0].push?t[e-1][i-1]:t[e>1?e-1:i-1]},INDIRECT:function(t){return this.iFormula.cell(t.toUpperCase())},LARGE:function(t,e){return t.sort(),t[t.length-(e||1)]},LEFT:function(t,e){return t.substr(0,e||1)},LEN:function(t){return(t=(t.map?t:[t]).map(function(t){return t.length})).length>1?t:t[0]},LOOKUP:function(t,e,i){i=i||e;var n=this.MATCH(t,e,1);return this.INDEX(i,1,n)},LOWER:function(t){return(t+"").toLocaleLowerCase()},_MAXMIN:function(t,e){var i,n=this;return t.forEach(function(t){null!==t&&(t=n.VALUE(t),n.isNumber(t)&&(t*e>i*e||null===i)&&(i=t))}),null!==i?i:0},MATCH:function(val,arr,type){var isNumber=this.isNumber(val),_isNumber,sign,indx,_val,i=0,len=arr.length;if(null===type&&(type=1),val=isNumber?val:val.toUpperCase(),0===type){for(arr=this.evalify(arr,val+""),i=0;i<len;i++)if(_val=arr[i],eval(_val)){indx=i+1;break}}else{for(i=0;i<len;i++)if(_val=arr[i],_isNumber=this.isNumber(_val),_val=arr[i]=_isNumber?_val:_val?_val.toUpperCase():"",val===_val){indx=i+1;break}if(!indx){for(i=0;i<len;i++)if(_val=arr[i],_isNumber=this.isNumber(_val),type*(_val<val?-1:1)==1&&isNumber===_isNumber){indx=i;break}indx=null===indx?i:indx}}if(indx)return indx;throw"#N/A"},MAX:function(){var t=pq.flatten(arguments);return this._MAXMIN(t,1)},MEDIAN:function(){var t=pq.flatten(arguments).filter(function(t){return 1*t===t}).sort(function(t,e){return e-t}),e=t.length,i=e/2;return i===parseInt(i)?(t[i-1]+t[i])/2:t[(e-1)/2]},MID:function(t,e,i){if(e<1||i<0)throw"#VALUE!";return t.substr(e-1,i)},MIN:function(){var t=pq.flatten(arguments);return this._MAXMIN(t,-1)},MODE:function(){var t,e,i=pq.flatten(arguments),n={},r=0;if(i.forEach(function(i){t=n[i]=n[i]?n[i]+1:1,r<t&&(r=t,e=i)}),r<2)throw"#N/A";return e},MONTH:function(t){return this.varToDate(t).getUTCMonth()+1},OR:function(){var arr=this.toArray(arguments);return eval(arr.join(" || "))},PI:function(){return Math.PI},POWER:function(t,e){return Math.pow(t,e)},PRODUCT:function(){var t=pq.flatten(arguments),e=1;return t.forEach(function(t){e*=t}),e},PROPER:function(t){return t=t.replace(/(\S+)/g,function(t){return t.charAt(0).toUpperCase()+t.substr(1).toLowerCase()})},RADIANS:function(t){return Math.PI/180*t},RAND:function(){return Math.random()},RANK:function(t,e,i){for(var n=JSON.stringify(e.getRange()),r=this,o=n+"_range",a=0,s=(e=this[o]||(r[o]=e,e.sort(function(t,e){return t-e}))).length;a<s;a++)if(t===e[a])return i?a+1:s-a},RATE:function(){},REPLACE:function(t,e,i,n){return(t+="").substr(0,e-1)+n+t.substr(e+i-1)},REPT:function(t,e){for(var i="";e--;)i+=t;return i},RIGHT:function(t,e){return e=e||1,t.substr(-1*e,e)},_ROUND:function(t,e,i){var n=Math.pow(10,e),r=t*n,o=parseInt(r);return i(o,r-o)/n},ROUND:function(t,e){return this._ROUND(t,e,function(t,e){var i=Math.abs(e);return t+(i>=.5?i/e:0)})},ROUNDDOWN:function(t,e){return this._ROUND(t,e,function(t){return t})},ROUNDUP:function(t,e){return this._ROUND(t,e,function(t,e){return t+(e?Math.abs(e)/e:0)})},ROW:function(t){return(t||this).getRange().r1+1},ROWS:function(t){var e=t.getRange();return e.r2-e.r1+1},SEARCH:function(t,e,i){return t=t.toUpperCase(),(e=e.toUpperCase()).indexOf(t,i?i-1:0)+1},SIN:function(t){return Math.sin(t)},SMALL:function(t,e){return t.sort(),t[(e||1)-1]},SQRT:function(t){return Math.sqrt(t)},_STDEV:function(t){var e=(t=pq.flatten(t)).length,i=this._AVERAGE(t),n=0;return t.forEach(function(t){n+=(t-i)*(t-i)}),[n,e]},STDEV:function(){var t=this._STDEV(arguments);if(1===t[1])throw"#DIV/0!";return Math.sqrt(t[0]/(t[1]-1))},STDEVP:function(){var t=this._STDEV(arguments);return Math.sqrt(t[0]/t[1])},SUBSTITUTE:function(t,e,i,n){var r=0;return t.replace(new RegExp(e,"g"),function(t){return r++,n?r===n?i:e:i})},SUM:function(){var t=pq.flatten(arguments),e=0,i=this;return t.forEach(function(t){t=i.VALUE(t),i.isNumber(t)&&(e+=parseFloat(t))}),e},SUMIF:function(t,e,i){return this.SUMIFS(i||t,t,e)},SUMIFS:function(){var t=this.reduce(arguments),e=t.shift();return this._IFS(t,function(t){return e[t]})},SUMPRODUCT:function(){var t=this.toArray(arguments);return t=t[0].map(function(e,i){var n=1;return t.forEach(function(t){var e=t[i];n*=parseFloat(e)===e?e:0}),n}),pq.aggregate.sum(t)},TAN:function(t){return Math.tan(t)},TEXT:function(t,e){return this.isNumber(t)&&e.indexOf("#")>=0?pq.formatNumber(t,e):$.datepicker.formatDate(pq.excelToJui(e),this.varToDate(t))},TIME:function(t,e,i){return(t+e/60+i/3600)/24},TIMEVALUE:function(t){var e=t.match(this.reTime);if(e&&null!==e[1]&&(null!==e[3]||null!==e[7]))var i=1*e[1],n=1*(e[3]||0),r=1*(e[5]||0),o=(e[7]||"").toUpperCase(),a=i+n/60+r/3600;if(0<=a&&(o&&a<13||!o&&a<24))return"PM"===o&&i<12?a+=12:"AM"===o&&12===i&&(a-=12),a/24;throw"#VALUE!"},TODAY:function(){var t=new Date;return this.VALUE(new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate())))},TRIM:function(t){return t.replace(/^\s+|\s+$/gm,"")},TRUNC:function(t,e){return~~(t*(e=Math.pow(10,e||0)))/e},UPPER:function(t){return(t+"").toLocaleUpperCase()},VALUE:function(t){var e,i;if(t)if(parseFloat(t)===t)i=parseFloat(t);else if(this.isDate(t))i=this.DATEVALUE(t);else if(e=t.match(this.reDateTime)){var n=e[1]||e[12],r=t.substr(n.length+1);i=this.DATEVALUE(n)+this.TIMEVALUE(r)}else i=(e=t.match(this.reTime))?this.TIMEVALUE(t):(i=t.replace(/[^0-9\-.]/g,"")).replace(/(\.[1-9]*)0+$/,"$1").replace(/\.$/,"");else i=0;return i},VAR:function(){var t=this._STDEV(arguments);return t[0]/(t[1]-1)},VARP:function(){var t=this._STDEV(arguments);return t[0]/t[1]},VLOOKUP:function(t,e,i,n){null===n&&(n=!0);var r=(e=this.get2Arr(e)).map(function(t){return t[0]}),o=this.MATCH(t,r,n?1:0);return this.INDEX(e,o,i)},YEAR:function(t){return this.varToDate(t).getUTCFullYear()}};f.reDate1=new RegExp("^"+f.strDate1+"$"),f.reDate2=new RegExp("^"+f.strDate2+"$"),f.reDate=new RegExp("^"+f.strDate1+"$|^"+f.strDate2+"$"),f.reTime=new RegExp("^"+f.strTime+"$","i"),f.reDateTime=new RegExp("^("+f.strDate1+")\\s"+f.strTime+"$|^("+f.strDate2+")\\s"+f.strTime+"$")}(jQuery),function(t){pq.Select=function(e,i){if(this instanceof pq.Select==!1)return new pq.Select(e,i);var n=i.closest(".pq-grid"),r=t("<div/>").appendTo(n);pq.grid(r,t.extend({width:i[0].offsetWidth,scrollModel:{autoFit:!0},height:"flex",autoRow:!1,numberCell:{show:!1},hoverMode:"row",fillHandle:"",stripeRows:!1,showTop:!1,showHeader:!1},e));pq.makePopup(r[0]),r.position({my:"left top",at:"left bottom",of:i,collision:"flipfit",within:n})}}(jQuery),function(t){var e=function(t){this.options=t.options};e.prototype={empty:function(){for(var t in this)0===t.indexOf("_")&&delete this[t];delete this.options.dataModel.dataPrimary},getCM:function(){return this._cm},setCM:function(t){this._cm=t},getCols:function(){return this._columns},setCols:function(t){this._columns=t},getDMData:function(){return this.options.dataModel.dataPrimary},setDMData:function(t){this.options.dataModel.dataPrimary=t},getOCM:function(){return this._ocm},setOCM:function(t){this._ocm=t}},t(document).on("pqGrid:bootup",function(t,i){var n=i.instance,r=n.Group();r.primary=new e(n),n.on("beforeFilterDone",r.onBeforeFilterDone.bind(r)).one("CMInit",r.oneCMInit.bind(r))});var i={},n={clearPivot:function(t){if(this.isPivot()){var e=this.that,i=e.options.dataModel,n=this.primary;if(n.getOCM()&&e.refreshCM(n.getOCM()),t){if(!n.getDMData())throw"!primary.getDMData";i.data=n.getDMData()}else n.getDMData()&&(i.data=n.getDMData());return this.primary.empty(),this.setPivot(!1),!0}},getColsPrimary:function(){return this.primary.getCols()||this.that.columns},getCMPrimary:function(){return this.primary.getCM()||this.that.colModel},getOCMPrimary:function(){return this.primary.getOCM()||this.that.options.colModel},getSumCols:function(){return(i.getSumCols.call(this)||[]).map(function(t){return[t.dataIndx,t.dataType,t.summary,t.summary.type+"("+t.title+")",t.width,t.format,t.showifOpen]})},getVal:function(){return this._pivot?function(t,e){return t[e]}:i.getVal.apply(this,arguments)},groupData:function(){var t,e,n,r=this.that,o=r.options.groupModel,a=o.dataIndx,s=o.groupCols,l=this.isPivot(),d=!l&&o.pivot,c=s.length;if(d?(c&&(t=a.slice(),o.dataIndx=a=a.concat(s)),this.skipConcat=!0,e=o.titleInFirstCol,n=o.merge,o.titleInFirstCol=!1,o.fixCols=!0,o.merge=!1):l&&c&&(t=a.slice(),o.dataIndx.length=o.dataIndx.length-1,this.setPivot(!1)),i.groupData.call(this),d&&(r.pdata=r.pdata.reduce(function(t,e){return e.pq_gtitle&&t.push(e),t},[])),l&&c&&(o.dataIndx=t,this.setPivot(!0)),d){if(c){e?(o.titleInFirstCol=!0,o.fixCols=!1):t.length>1&&(o.merge=n),this.pivotData(a,t),o.dataIndx=t.slice(0,t.length-1),o.summaryInTitleRow="all",this.skipConcat=!1;var h=this.firstCol().dataIndx,u=t[t.length-1];e&&h!==u&&r.pdata.forEach(function(t){t[h]=t[u]}),i.groupData.call(this),o.dataIndx=t,this.setPivot(!0)}this.skipConcat=!1}r._trigger("groupData")},isPivot:function(){return this._pivot},getSorter:function(t){var e=t.pivotSortFn;return e||(e="number"===pq.getDataType(t)?function(t,e){return 1*t.sortby>1*e.sortby?1:-1}:function(t,e){return t.sortby>e.sortby?1:-1}),e},nestedCM:function(e,i){var n=this,r=i.groupCols,o=i.pivotColsTotal,a="hideifOpen"!==o&&null,s=[],l=[],d=n.that.columns;return d=r.map(function(t){var e=d[t];return s.push(n.getSorter(e)),l.push(pq.getDataType(e)),e}),function i(n,r,c){r=r||0,c=c||[];var h,u,f,p,g,v,m,w,x=0,y=[];if(t.isEmptyObject(n))for(;x<e.length;x++)h=e[x],(u=c.slice()).push(h[0]),f={dataIndx:u.join("_"),dataType:h[1],summary:h[2],title:h[3],width:h[4],format:h[5],showifOpen:h[6]},y.push(f);else{for(g in h=d[r],p=l[r],n)m="aggr"===g,(u=c.slice()).push(g),v=i(n[g],r+1,u),m?(w=v).forEach(function(t){t.showifOpen=a,t.type="aggr"}):(f={showifOpen:!0,sortby:g,title:pq.format(h,g,p),colModel:v},v.length>1&&!v.find(function(t){return!t.type}).dataIndx&&(f.collapsible={on:!0,last:null}),y.push(f));y.sort(s[r]),w&&y["before"===o?"unshift":"push"].apply(y,w)}return y}},onBeforeFilterDone:function(t,e){if(this.isPivot()){for(var i=e.rules,n=this.primary.getCols(),r=0;r<i.length;r++)if(!n[i[r].dataIndx])return!1;this.clearPivot(!0),e.header=!0}},oneCMInit:function(){this.updateAgg(this.that.options.groupModel.agg)},option:function(t,e,n,r){var o=t.agg;this.isPivot()&&this.clearPivot(),o&&this.updateAgg(o,this.that.options.groupModel.agg),i.option.call(this,t,e,n,r)},pivotData:function(e,i){var n,r,o=this.that,a=this.getSumCols(),s=this.getSumDIs(),l=o.options,d=l.groupModel,c=this.primary,h=o.pdata,u=o.columns;r=d.titleInFirstCol?[n=o.colModel[0]].concat(i.reduce(function(e,i){return i!==n.dataIndx&&e.push(t.extend({hidden:!0},u[i])),e},[])):i.map(function(t){return u[t]});var f=this.transformData(h,s,e,i),p=this.nestedCM(a,d)(f),g={};g.CM=r=r.concat(p),o._trigger("pivotCM",null,g),c.setOCM(l.colModel),c.setCM(o.colModel),c.setCols(o.columns),o.refreshCM(g.CM,{pivot:!0})},setPivot:function(t){this._pivot=t},transformData:function(t,e,i,n){var r,o,a,s,l=this,d=[],c=this.that,h=this.primary,u={},f=[],p=c.options,g=p.dataModel,v=p.groupModel,m=v.pivotColsTotal,w=n.length,x={},y=i.length;return t.forEach(function(t){var c,h,p=t.pq_level,g=p-w,v=x,C=i[p],b=t[C];if(g>=0)for(f[g]=b,c=0;c<g+1;c++)v=v[h=f[c]]=v[h]||{};p===y-1?e.forEach(function(e){(s=f.slice()).push(e),a[s.join("_")]=t[e]}):((!a||o>p&&p<w)&&(a={pq_gid:l.idCount++},r=!0),p<w&&(u[C]=a[C]=b),m&&p<=y-2&&p>=w-1&&e.forEach(function(e){(s=f.slice(0,g+1)).push("aggr"),s.push(e),a[s.join("_")]=t[e]})),o=p,r&&(d.push(a),n.forEach(function(t){void 0===a[t]&&(a[t]=u[t])}),r=!1)}),h.setDMData(g.data),g.data=c.pdata=d,m&&this.addAggrInCM(x,v.pivotTotalForSingle),x},addAggrInCM:function(t,e){var i,n=0;for(i in t)n++,this.addAggrInCM(t[i],e);n>(e?0:1)&&(t.aggr={})},updateAgg:function(t,e){var i,n=this.that.columns;if(e)for(i in e)n[i].summary=null;if(t)for(i in t)n[i].summary={type:t[i]}}},r=t.paramquery.cGroup.prototype;for(var o in n)i[o]=r[o],r[o]=n[o]}(jQuery),function(t){var e,i=t.paramquery;i.pqGrid.defaults.toolPanel={},i.pqGrid.prototype.ToolPanel=function(){return this.iToolPanel},t(document).on("pqGrid:bootup",function(t,e){var n=e.instance;n.iToolPanel=new i.cToolPanel(n)}),i.cToolPanel=function(t){this.that=t,this.clsSort="pq-sortable",t.one("render",this.init.bind(this))},i.cToolPanel.prototype={getArray:function(t){return t.find(".pq-pivot-col").get().map(function(t){return t.id})},getInit:function(){return this._inited},getObj:function(t){var e={};return t.find(".pq-pivot-col").each(function(t,i){e[i.id]=i.getAttribute("type")||"sum"}),e},getSortCancel:function(){return this._sortCancel},_hide:function(t){this.$ele[t?"hide":"show"](),this.init(),this.that.refresh({soft:!0})},hide:function(){this._hide(!0)},init:function(){var t=this,e=t.$ele=t.that.$toolPanel;if(t.isVisible()&&!t.getInit()){var i=t.that,n=i.options,r=n.toolPanel,o=n.groupModel.pivot,a=" pq-pivot-label ",s=" pq-pivot-pane pq-border-1 ",l=t.isHideColPane(),d=r.hidePivotChkBox,c=o?"checked":"",h=t.clsSort;e.html(["<div class='pq-pivot-cols-all",s,"'>","<div class='",h,"' style='",d?"padding-top:0;":"","'></div>",d?"":["<div class='",a,"'>","<label><input type='checkbox' class='pq-pivot-checkbox' ",c,"/>",n.strTP_pivot,"</label>","</div>"].join(""),"</div>","<div class='pq-pivot-rows",s,"' style='display:",r.hideRowPane?"none":"",";'>","<div deny='denyGroup' class='",h,"'></div>","<div class='",a,"'><span class='pq-icon'></span>",n.strTP_rowPane,"</div>","</div>","<div class='pq-pivot-cols",s,"' style='display:",l?"none":"",";'>","<div deny='denyPivot' class='",h,"'></div>","<div class='",a,"'><span class='pq-icon'></span>",n.strTP_colPane,"</div>","</div>","<div class='pq-pivot-vals",s,"' style='display:",r.hideAggPane?"none":"",";'>","<div deny='denyAgg' class='",h,"'></div>","<div class='",a,"'><span class='pq-icon'></span>",n.strTP_aggPane,"</div>","</div>"].join("")),t.$pivotChk=e.find(".pq-pivot-checkbox").on("click",t.onPivotChange(t,i)),t.$colsAll=e.find(".pq-pivot-cols-all>."+h),t.$colsPane=e.find(".pq-pivot-cols"),t.$cols=e.find(".pq-pivot-cols>."+h),t.$rows=e.find(".pq-pivot-rows>."+h),t.$aggs=e.find(".pq-pivot-vals>."+h).on("click contextmenu",t.onClick.bind(t)),i.on("refreshFull",t.setHt.bind(t)).on("groupOption",t.onGroupOption.bind(t)),setTimeout(function(){i.element&&(i.on("CMInit",t.onCMInit.bind(t)),t.render())}),t.setInit()}},isHideColPane:function(){var t=this.that.options;return t.toolPanel.hideColPane||!t.groupModel.pivot},isDeny:function(t,e,i){var n=e.attr("deny");return this.that.iGroup.getColsPrimary()[i[0].id][n]},isVisible:function(){return this.$ele.is(":visible")},onCMInit:function(t,e){e.pivot||e.flex||e.group||this.that.Group().isPivot()||this.refresh()},onClick:function(e){var i=t(e.target),n=this,r=n.that;if(i.hasClass("pq-pivot-col")){var o=i[0].id,a=r.iGroup.getColsPrimary()[o],s={dataModel:{data:r.iGroup.getAggOptions(a.dataType).sort().map(function(t){return[t]})},cellClick:function(t,e){var r=e.rowData[0],o=this;i.attr("type",r),setTimeout(function(){o.destroy(),n.refreshGrid(),n.refresh()})}};return pq.Select(s,i),!1}},onGroupOption:function(t,e){if("tp"!==e.source){var i=e.oldGM,n=this.that.options.groupModel;n.groupCols===i.groupCols&&n.agg===i.agg&&n.dataIndx===i.dataIndx&&n.pivot===i.pivot||this.refresh()}},onPivotChange:function(t,e){return function(){var i={pivot:!!this.checked};e.Group().option(i,null,"tp"),t.showHideColPane()}},ph:function(t){return"<span style='color:#999;margin:1px;display:inline-block;'>"+t+"</span>"},refreshGrid:function(){var t=this,e=t.that,i=t.getArray(t.$cols),n=t.getObj(t.$aggs),r=t.getArray(t.$rows);e.Group().option({groupCols:i,dataIndx:r,agg:n,on:!!r.length},null,"tp"),setTimeout(function(){t.refresh()})},onReceive:function(t,e){if(this.getSortCancel())return this.setSortCancel(!1);this.refreshGrid()},onOver:function(e){return function(i,n){var r=t(this),o=n.item,a=o.parent(),s=a[0]!==r[0]&&e.isDeny(a,r,o);n.helper.find(".ui-icon")[s?"addClass":"removeClass"]("ui-icon-closethick")[s?"removeClass":"addClass"]("ui-icon-check")}},onStop:function(e){return function(i,n){var r=t(this),o=n.item,a=o.parent();r[0]!==a[0]&&e.isDeny(r,a,o)&&(r.sortable("cancel"),e.setSortCancel(!0))}},onTimer:function(t,i){clearTimeout(e);var n=this;e=setTimeout(function(){n.onReceive(t,i)})},refresh:function(){this.setHtml(),t(this.panes).sortable("refresh")},render:function(){var e="."+this.clsSort,i=this.that;i.element&&(this.panes=[this.$colsAll,this.$cols,this.$rows,this.$aggs],this.setHtml(),t(this.panes).sortable({appendTo:this.$ele,connectWith:e,containment:this.$ele,cursor:"move",items:"> .pq-pivot-col:not('.pq-deny-drag')",helper:function(t,e){return e.clone(!0).css({opacity:"0.8"}).prepend("<span class='ui-icon-check ui-icon'></span>")},receive:this.onTimer.bind(this),stop:this.onStop(this),over:this.onOver(this),update:this.onTimer.bind(this),tolerance:"pointer"}),i._trigger("tpRender"))},setHtml:function(){var t,e,i=this.that,n=[],r=[],o=[],a=[],s=this.template,l=this.templateVals,d={},c=i.options,h=i.iGroup,u=h.getColsPrimary(),f=h.getCMPrimary(),p=c.groupModel,g=p.dataIndx,v=p.groupCols;g.concat(v).forEach(function(t){d[t]=1}),this.$pivotChk[0].checked=p.pivot,this.showHideColPane();for(var m=0,w=f.length;m<w;m++)e=(t=f[m]).dataIndx,t.tpHide||d[e]||(t.summary&&t.summary.type?a.push(l(e,t)):n.push(s(e,t)));g.forEach(function(t){o.push(s(t,u[t]))}),v.forEach(function(t){r.push(s(t,u[t]))}),this.$colsAll.html(n.join("")),this.$rows.html(o.join("")||this.ph(c.strTP_rowPH)),this.$cols.html(r.join("")||this.ph(c.strTP_colPH)),this.$aggs.html(a.join("")||this.ph(c.strTP_aggPH))},setAttrPanes:function(){this.$ele.attr("panes",this.panes.filter(function(t){return t.is(":visible")}).length)},setHt:function(){this.$ele.height(this.$ele.parent()[0].offsetHeight)},setSortCancel:function(t){this._sortCancel=t},setInit:function(){this._inited=!0},show:function(){this._hide(!1)},showHideColPane:function(){this.$colsPane.css("display",this.isHideColPane()?"none":""),this.setAttrPanes()},template:function(t,e){return["<div id='",t,"' class='pq-pivot-col pq-border-2 ",e.tpCls||"","'>",e.title,"</div>"].join("")},templateVals:function(t,e){var i=e.summary.type;return["<div id='",t,"' type='",i,"' class='pq-pivot-col pq-border-2 ",e.tpCls||"","'>",i,"(",e.title,")</div>"].join("")},toggle:function(){this._hide(this.isVisible())}}}(jQuery),function(t){t.paramquery;function e(t){this.that=t,t.on("headerCellClick",this.onHeadCellClick.bind(this)).on("headerClick",this.onHeadClick.bind(this)).on("destroy",this.onDestroy.bind(this))}t(document).on("pqGrid:bootup",function(t,i){var n=i.instance;n.iHeaderMenu=new e(n),n.HeaderMenu=function(){return n.iHeaderMenu}}),e.prototype={close:function(){this.$popup.remove(),this.$popup=null},popup:function(){return this.$popup},openFilterTab:function(){var t=this.$popup.find("a[href='tabs-filter']").closest("li").index();return this.$tabs.tabs("option","active",t),this.filterMenu},FilterMenu:function(){return this.filterMenu},getCM:function(){var t=this.that.options.strSelectAll||"Select All";return this.nested?[{editor:!1,dataIndx:"title",title:t,useLabel:!0,filter:{crules:[{condition:"contain"}]}},{hidden:!0,dataIndx:"visible",dataType:"bool"}]:[{type:"checkbox",cbId:"visible",dataIndx:"title",title:t,useLabel:!0,filter:{crules:[{condition:"contain"}]},editor:!1},{dataIndx:"visible",hidden:!0,cb:{header:!0},dataType:"bool"}]},getData:function(){var t=1,e=this,i=e.that,n=i.iRenderHead;return i.Columns().reduce(function(i){var r=this.getColIndx({column:i}),o=!i.hidden,a=i.childCount;if(!i.menuInHide&&!i.collapsible)return a&&(e.nested=!0),{visible:a?void 0:o,title:a?i.title:n.getTitle(i,r)||i.dataIndx,column:i,id:t++,pq_disable:i.menuInDisable,pq_close:i.menuInClose,colModel:a?i.colModel:void 0}})},getGridObj:function(){var e=this.that;return t.extend({dataModel:{data:this.getData()},colModel:this.getCM(),check:this.onChange.bind(this),treeExpand:this.onTreeExpand.bind(this),treeModel:this.nested?{dataIndx:"title",childstr:"colModel",checkbox:!0,checkboxHead:!0,cbId:"visible",cascade:!0,useLabel:!0}:void 0},e.options.menuUI.gridOptions)},onChange:function(t,e){if(!e.init){var i=[],n=[];(e.getCascadeList?e.getCascadeList():e.rows).forEach(function(t){var e=t.rowData,r=e.visible,o=e.column,a=o.dataIndx,s=o.colModel;s&&s.length||(r?i.push(a):n.push(a))}),this.that.Columns().hide({diShow:i,diHide:n})}},onDestroy:function(){var t=this.$popup;t&&t.remove(),delete this.$popup},onHeadCellClick:function(e,i){var n=t(e.originalEvent.target);return n.hasClass("pq-filter-icon")?this.onFilterClick(e,i,n):n.hasClass("pq-menu-icon")?this.onMenuClick(e,i,n):void 0},onHeadClick:function(t,e){if(null===this.that.getColModel().find(function(t){return!t.hidden}))return this.onMenuClick(t,e)},getMenuHtml:function(t){var e={hideCols:"visible",filter:"filter"};return["<div class='pq-head-menu pq-theme'>","<div class='pq-tabs' style='border-width:0;'>","<ul>",t.map(function(t){return['<li><a href="#tabs-',t,'"><span class="pq-tab-',e[t],'-icon">&nbsp;</span></a></li>'].join("")}).join(""),"</ul>",t.map(function(t){return'<div id="tabs-'+t+'"></div>'}).join(""),"</div>","</div>"].join("")},getMenuH:function(e,i){return t.extend({},e.menuUI,i.menuUI)},open:function(e,i,n){var r,o,a=this.that;i=i||a.getCellHeader({dataIndx:e}),null!==e?(o=a.columns[e],r=(this.menuH=this.getMenuH(a.options,o)).tabs):r=["hideCols"];var s=this.$popup=t(this.getMenuHtml(r)).appendTo(document.body),l=this.$tabs=s.find(".pq-tabs");if(r.indexOf("hideCols")>-1){var d=this.$grid=t("<div/>").appendTo(s.find("#tabs-hideCols"));this.grid=pq.grid(d,this.getGridObj())}return r.indexOf("filter")>-1&&this.appendFilter(s.find("#tabs-filter"),o),pq.makePopup(this.$popup[0]),l.tabs({active:localStorage["pq-menu-tab"]||1,activate:function(e,i){localStorage["pq-menu-tab"]=t(this).tabs("option","active"),t(i.newPanel).find(".pq-grid").pqGrid("refresh")}}),s.resizable({handles:"e,w",maxWidth:600,minWidth:220}),s.position({my:"left top",at:"left bottom",of:n||i}),this},onMenuClick:function(t,e,i){return this.open(e.dataIndx,t,i),!1},onTreeExpand:function(t,e){e.nodes.forEach(function(t){t.column.menuInClose=e.close})},appendFilter:function(e,i){var n,r,o=this,a=o.that,s=t("<div class='pq-filter-menu pq-theme'/>").appendTo(e),l=o.$popup||s;n=o.filterMenu=new pq.cFilterMenu;var d={filterRow:e.is(document.body),grid:a,column:i,$popup:l,menuH:this.menuH||this.getMenuH(a.options,i)};return n.init(d),r=n.getHtml(),s.html(r),n.ready(s.children().get()),n.addEvents(),l.on("remove",function(){o.$popup=o.filterMenu=null}),s},onFilterClick:function(e,i,n){var r=this.$popup=this.appendFilter(t(document.body),i.column);return pq.makePopup(r[0]),r.position({my:"left top",at:"left bottom",of:n}),!1}}}(jQuery),function(t){var e=pq.cFilterMenu=function(){};e.select=function(t,e){this.that=t,this.di1="selected",this.grid=null,this.column=e},e.select.prototype={change:function(t){this.onChange(t).call(this.grid)},create:function(e,i,n){var r=this.that,o=this.getGridObj(i,n),a=function(t){var e=i[t];e&&e.call(r,s),r._trigger(t,null,s)},s=t.extend({obj:o,column:this.column},i);return a("selectGridObj"),s.grid=this.grid=pq.grid(e,o),a("selectGridCreated"),this.grid},getCM:function(e,i,n,r,o,a){var s=e.dataIndx,l=t.extend({filter:{crules:[{condition:"contain"}]},align:"left",format:a.format||e.format,deFormat:e.deFormat,title:e.pq_title||e.title,dataType:e.dataType,dataIndx:s,editor:!1,useLabel:!0,renderLabel:this.getRenderLbl(r,s,this.that.options.strBlanks)},n?{}:{type:"checkbox",cbId:i});return n?[l,{dataIndx:i,dataType:"bool",hidden:!0},{dataIndx:n,hidden:!0}]:[l,{dataIndx:i,dataType:"bool",hidden:!0,cb:{header:!o,maxCheck:o}}]},getData:function(e,i){var n=this.column,r=this.that,o={},a=this.di1,s=n.dataIndx,l=e.maxCheck,d=pq.filter.getVal(i)[0],c=pq.filter.getOptions(n,e,r,!0);return t.isArray(d)?l&&(d=d.slice(0,l)):d=1===l?[d]:[],d.forEach(function(t){o[t]=!0}),d.length?c.forEach(function(t){t[a]=o[t[s]]}):c.forEach(function(t){t[a]=!l}),c},getGridObj:function(e,i){var n=this.column,r=this.that.options,o=n.filter,a=e.groupIndx,s=e.maxCheck,l=this.di1,d=this.getData(e,o),c=d&&d.length&&null!==d[0].pq_label?"pq_label":e.labelIndx;return this.filterUI=e,t.extend({colModel:this.getCM(n,l,a,c,s,e),check:this.onChange(!i),filterModel:"bool"===n.dataType?{}:void 0,groupModel:a?{on:!0,dataIndx:a?[a]:[],titleInFirstCol:!0,fixCols:!1,indent:18,checkbox:!0,select:!1,checkboxHead:!s,cascade:!s,maxCheck:s,cbId:l}:{},dataModel:{data:d}},r.menuUI.gridOptions,r.filterModel.gridOptions,e.gridOptions)},getRenderLbl:function(t,e,i){return t===e&&(t=void 0),function(n){var r=n.rowData,o=r[t];return o||""!==r[e]?o:i}},onChange:function(t){var e=this,i=e.filterUI,n=i.maxCheck,r=i.condition;return function(){if(t){var i=!1,o=e.column.dataIndx,a=e.di1,s=e.that,l=this.getData().filter(function(t){var e=t[a];return e||(i=!0),e}).map(function(t){return t[o]});i?s.filter({oper:"add",rule:{dataIndx:o,condition:r,value:1===n?l[0]:l}}):s.filter({rule:{dataIndx:o,condition:r,value:[]}}),e.refreshRowFilter()}}},refreshRowFilter:function(){this.that.iRenderHead.postRenderCell(this.column)}},e.prototype={addEvents:function(){this.$sel0.on("change",this.onSel1Change.bind(this)),this.$sel1.on("change",this.onSel2Change.bind(this)),this.$filter_mode.on("change",this.onModeChange.bind(this)),this.$clear.button().on("click",this.clear.bind(this)),this.$ok.button().on("click",this.ok.bind(this))},addEventsInput:function(){this.$inp&&(this.$inp.filter("[type='checkbox']").off("click").on("click",this.onInput.bind(this)),this.$inp.filter("[type='text']").off("keyup").on("keyup",this.onInput.bind(this)))},clear:function(){var t=this.that,e=this.column,i=this.cond0,n=this.getType(i),r=e.dataIndx;t.filter({rule:{dataIndx:r,condition:n?i:void 0},oper:"remove"}),this.refreshRowFilter(),this.ready()},close:function(){this.$popup.remove()},filterByCond:function(t){var e=this.that,i=this.column.dataIndx,n=this.cond0,r=""===n,o=this.cond1,a=this.filterRow;if(this.showHide(n,o),!a)var s=this.getModeVal(),l=this.getType(n),d=this.getVal(0),c=d[0],h=d[1],u=this.getVal(1),f=u[0],p=u[1],g=this.$gridR;"select"===l?(t&&e.filter({oper:"add",rule:{dataIndx:i,condition:n,value:[]}}),a||this.iRange.create(g,this.filterUI[0],this.btnOk)):t&&e.filter({oper:r?"remove":"add",rule:{dataIndx:i,mode:s,crules:[{condition:n,value:c,value2:h},{condition:o,value:f,value2:p}]}})},getBtnOk:function(){return this.$ok},getInp:function(t){return this["$inp"+t]},getSel:function(t){return this["$sel"+t]},getBtnClear:function(){return this.$clear},getHtmlInput:function(t){var e=this.column.dataIndx,i=this.filterUI[t<2?0:1];return"<input type='"+("checkbox"===i.type?"checkbox":"text")+"' "+["name='",e,"' class='",i.cls||"","' style='width:100%;",i.style||"","display:none;' ",i.attr||""].join("")+" />"},getHtml:function(){var t=this,e=t.column.filter,i=t.menuH,n=e.crules||[],r=n[0]||e,o=n[1]||{},a=t.that.options,s=t.cond0=r.condition,l=t.cond1=o.condition,d=t.filterRow;t.readFilterUI();var c=function(e,i){return["<div style='margin:0 auto 4px;'>",t.getHtmlInput(e),"</div>","<div style='margin:0 auto 4px;'>",t.getHtmlInput(i),"</div>"].join("")},h=pq.filter.getConditionsCol(this.column,t.filterUI[0]);return["<div style='padding:4px;'>","<div style='margin:0 auto 4px;'>",a.strCondition," <select>",this.getOptionStr(h,s),"</select></div>",d?"":["<div>",c(0,1),"<div data-rel='grid' style='display:none;'></div>",i.singleFilter?"":["<div class='filter_mode_div' style='text-align:center;display:none;margin:4px 0 4px;'>","<label><input type='radio' name='pq_filter_mode' value='AND'/>AND</label>&nbsp;","<label><input type='radio' name='pq_filter_mode' value='OR'/>OR</label>","</div>","<div style='margin:0 auto 4px;'><select>",this.getOptionStr(h,l,!0),"</select></div>",c(2,3)].join(""),"</div>"].join(""),"<div style='margin:4px 0 0;'>",i.buttons.map(function(t){return"<button data-rel='"+t+"' type='button' style='width:calc(50% - 4px);margin:2px;' >"+(a["str"+pq.cap1(t)]||t)+"</button>"}).join(""),"</div>","</div>"].join("")},getMode:function(t){var e=this.$filter_mode;return t>=0?e[t]:e},getModeVal:function(){return this.$filter_mode.filter(":checked").val()},getOptionStr:function(t,e,i){var n=[""].concat(t),r=this,o=r.that.options.strConditions||{};return i&&(n=n.filter(function(t){return"select"!==r.getType(t)})),n.map(function(t){return'<option value="'+t+'" '+(e===t?"selected":"")+">"+(o[t]||t)+"</option>"}).join("")},getType:function(t){return pq.filter.getType(t,this.column)},getVal:function(t){var e,i,n=this.column,r=this["cond"+t],o=this["$inp"+(t?"2":"0")],a=o[0],s=this["$inp"+(t?"3":"1")];if(o.is("[type='checkbox']")){var l=a.indeterminate;e=!!a.checked||!!l&&null}else o.is(":visible")&&(e=pq.deFormat(n,o.val(),r)),s.is(":visible")&&(i=pq.deFormat(n,s.val(),r));return[e,i]},init:function(t){var e=this.column=t.column;e.filter=e.filter||{},this.that=t.grid,this.menuH=t.menuH,this.$popup=t.$popup,this.filterRow=t.filterRow},initControls:function(){var e=this.filterUI[0],i=this.that,n={column:this.column,headMenu:!0};n.$editor=t([this.$inp0[0],this.$inp1[0]]),n.condition=this.cond0,n.type=e.type,n.filterUI=e,e.init.find(function(t){return t.call(i,n)}),e=this.filterUI[1],n.$editor=t([this.$inp2[0],this.$inp3[0]]),n.condition=this.cond1,n.type=e.type,n.filterUI=e,e.init.find(function(t){return t.call(i,n)})},isInputHidden:function(t){if("select"===t||!t)return!0},ok:function(){var t=this.cond0;"select"!==this.getType(t)||this.filterRow?t&&this.filterByCond(!0):this.iRange.change(!0),this.close(),this.refreshRowFilter()},onModeChange:function(){this.filterByCond(!this.btnOk)},onInput:function(e){var i=t(e.target),n=!this.btnOk;i.is(":checkbox")&&i.pqval({incr:!0}),this.filterByCond(n),n&&this.refreshRowFilter()},onSel1Change:function(){var t=!this.btnOk;this.cond0=this.getSel(0).val(),this.readFilterUI(),this.filterRow||(this.$inp0.replaceWith(this.getHtmlInput(0)),this.$inp1.replaceWith(this.getHtmlInput(1)),this.refreshInputVarsAndEvents(),this.initControls()),this.filterByCond(t),this.refreshRowFilter()},onSel2Change:function(){this.cond1=this.getSel(1).val(),this.readFilterUI(),this.$inp2.replaceWith(this.getHtmlInput(2)),this.$inp3.replaceWith(this.getHtmlInput(3)),this.refreshInputVarsAndEvents(),this.initControls(),this.filterByCond(!this.btnOk)},ready:function(e){this.node=e=e||this.node;var i,n,r,o=t(e),a=this.that,s=this.column,l=s.filter,d=l.crules||[],c=d[0]||l,h=d[1]||{},u=this.cond0=c.condition,f=this.cond1=h.condition,p=this.readFilterUI();this.iRange=new pq.cFilterMenu.select(a,s),i=this.getType(u),n=this.getType(f),r=this.$select=o.find("select"),this.$sel0=t(r[0]).val(u),this.$sel1=t(r[1]).val(f),this.$filter_mode=o.find('[name="pq_filter_mode"]'),this.$clear=o.find("[data-rel='clear']"),this.$ok=o.find("[data-rel='ok']"),this.btnOk=this.$ok.length,this.filterRow||(this.refreshInputVarsAndEvents(),this.$gridR=o.find("[data-rel='grid']"),this.$filter_mode.filter("[value="+l.mode+"]").attr("checked","checked"),this.$filter_mode_div=o.find(".filter_mode_div"),this.showHide(u,f),"select"===i?this.iRange.create(this.$gridR,p[0],this.btnOk):this.readyInput(0,i,c),this.readyInput(1,n,h),this.initControls())},readyInput:function(t,e,i){var n=this.column,r=this["cond"+t],o=this["$inp"+(t?"2":"0")],a=this["$inp"+(t?"3":"1")];o.is(":checkbox")&&o.pqval({val:i.value}),o.val(pq.formatEx(n,i.value,r)),"textbox2"===e&&a.val(pq.formatEx(n,i.value2,r))},readFilterUI:function(){var t=this.filterUI=[],e=this.that,i={column:this.column,condition:this.cond0,indx:0,headMenu:!0};return t[0]=pq.filter.getFilterUI(i,e),i.condition=this.cond1,i.indx=1,t[1]=pq.filter.getFilterUI(i,e),t},refreshInputVarsAndEvents:function(){var e=this.column,i=this.$inp=t(this.node).find("input[name='"+e.dataIndx+"']"),n=i[0],r=i[1],o=i[2],a=i[3];this.$inp0=t(n),this.$inp1=t(r),this.$inp2=t(o),this.$inp3=t(a),this.addEventsInput()},refreshRowFilter:function(){this.that.refreshHeaderFilter({dataIndx:this.column.dataIndx})},SelectGrid:function(){return this.$gridR.pqGrid("instance")},showHide:function(t,e){if(!this.filterRow){var i,n=this.$filter_mode_div,r=this.$sel1,o=this.getType(t),a=this.$inp;"select"===o?(this.$gridR.show(),this.$gridR.hasClass("pq-grid")&&this.$gridR.pqGrid("destroy"),a.hide(),n.hide(),r.hide()):(this.$gridR.hide(),t?(this.$inp0[this.isInputHidden(o)?"hide":"show"](),this.$inp1["textbox2"===o?"show":"hide"](),n.show(),r.show(),e?(i=this.getType(e),this.$inp2[this.isInputHidden(i)?"hide":"show"](),this.$inp3["textbox2"===i?"show":"hide"]()):(this.$inp2.hide(),this.$inp3.hide())):(a.hide(),n.hide(),r.hide()))}},updateConditions:function(){var t=this.column.filter;t.crules=t.crules||[{}],t.crules[0].condition=this.cond0,this.cond1&&(t.crules[1]=t.crules[1]||{},t.crules[1].condition=this.cond1)}}}(jQuery),function(t){var e=t.paramquery;t(document).on("pqGrid:bootup",function(t,i){var n=i.instance;new e.cEditor(n)}),e.cEditor=function(t){var e=this;e.that=t,t.on("editorBeginDone",function(t,i){i.$td[0].edited=!0,e.fixWidth(i),setTimeout(function(){document.body.contains(i.$editor[0])&&e.fixWidth(i)})}).on("editorEnd",function(t,i){i.$td[0].edited=!1,cancelAnimationFrame(e.id)}).on("editorKeyDown",function(t,i){e.id=requestAnimationFrame(function(){e.fixWidth(i)})})},e.cEditor.prototype={escape:function(t){return(t=t.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/</g,"&lt;")).replace(/(\n)$/,"$1A")},fixWidth:function(e){var i,n=this.that,r=e.$td,o=r[0],a=o.offsetWidth,s=o.offsetHeight,l=n.widget(),d=e.$editor,c=d[0].type;if("text"===c||"textarea"===c){var h=this.escape(d.val()),u=l.width(),f=t("<span style='position:absolute;top:0;left:0;visibilty:hidden;'><pre>"+h+"</pre></span>").appendTo(l),p=parseInt(f.width())+25;if(f.remove(),p=p>u?u:p>a?p:a,"textarea"===c){var g=d.clone().appendTo(l),v=g[0];g.css({height:18,width:p,position:"absolute",left:0,top:0,overflow:"hidden"}),i=v.scrollHeight+5,g.remove(),d.css({height:i,width:p,resize:"none",overflow:"hidden"})}}else p=a,i=s;d.css("width",p+"px"),this.position(d,l,r)},position:function(t,e,i){t.closest(".pq-editor-outer").css("border-width","0").position({my:"left center",at:"left center",of:i,collision:"fit",within:e})}}}(jQuery),function(t){var e=window.pq.cVirtual=function(){this.diffH=0,this.diffV=0};e.setSBDim=function(){var e=t("<div style='max-width:100px;height:100px;position:fixed;left:0;top:0;overflow:auto;visibility:hidden;'><div style='width:200px;height:100px;'></div></div>").appendTo(document.body),i=e[0];this.SBDIM=i.offsetHeight-i.clientHeight,e.remove()},e.prototype={assignTblDims:function(t){var e,i=this.isBody(),n=this.getTopSafe(this[t?"cols":"rows"],t,!0),r=this.maxHt;n>r?(this[t?"ratioH":"ratioV"]=n/r,this[t?"virtualWd":"virtualHt"]=n,n=r):(n=n||(this.isHead()?0:1),this[t?"ratioH":"ratioV"]=1);var o=this.$tbl_right[0],a=this[t?"$tbl_tr":"$tbl_left"],s=a.length?a[0]:{style:{}},l=t?"width":"height";o.style[l]=n+"px",s.style[l]=n+"px",e=i?"Tbl":this.isHead()?"TblHead":"TblSum",!i&&t&&this.$spacer.css("left",n),this.dims[t?"wd"+e:"ht"+e]=n,i&&this.triggerTblDims(100)},calInitFinal:function(t,e,i){var n,r,o,a=this[i?"cols":"rows"],s=this[i?"freezeCols":"freezeRows"],l=this[i?"leftArr":"topArr"],d=this.getTopSafe(s,i);if(i&&(d-=this.numColWd),t+=d,e+=d,s<a&&l[s]<t){for(var c,h=30,u=a;h--;)if(l[c=Math.floor((s+u)/2)]>=t)u=c;else{if(s===c){o=!0;break}s=c}if(!o)throw"ri not found"}for(;s<=a;s++)if(l[s]>t){n=s?s-1:s;break}for(;s<=a;s++)if(l[s]>e){r=s-1;break}return null===n&&null===r&&a&&t>l[a-1]?[null,null]:(null===n&&(n=0),null===r&&(r=a-1),[n,r])},calInitFinalSuper:function(){var t=this.dims||{},e=this.calcTopBottom(),i=e[0],n=e[1],r=e[2],o=this.calcTopBottom(!0),a=o[0],s=o[1],l=this.calInitFinal(i,n),d=l[0],c=l[1],h=this.calInitFinal(a,s,!0),u=h[0],f=h[1];return this.isBody()&&(t.bottom=n,t.top=i,t.left=a,t.right=s),[d,u,c,f,r=r||o[2]]},calcTopBottom:function(t){var i,n,r=this.isBody(),o=this.dims,a=this.$cright[0];if(t)var s=a.scrollLeft,l=this.sleft,d=o.wdCont,c=this.wdContLeft,h=this.ratioH;else s=a.scrollTop,l=this.stop,d=this.htCont,c=this.htContTop,h=this.ratioV;if(s=s<0?0:s,1===h)return(n=s+d-c)>=0||(n=0),[s,n];var u,f,p,g=e.maxHt,v=this[t?"virtualWd":"virtualHt"],m=t?o.wdContClient:o.htContClient,w=t?"diffH":"diffV",x=this[w];if(s+m>=g?i=(n=v-c+(d-m))-d+c:n=(i=0===s?0:s*(u=null===l||Math.abs(s-l)>d?h:1)+(1===u&&x?x:0))+d-c,(f=i-s)!==x&&(p=!0,this[w]=f,r&&this.triggerTblDims(3e3)),this[t?"sleft":"stop"]=s,!(s>=0))throw"stop NaN";if(!(n>=0&&i>=0))throw"top bottom NaN";return[i,n,p]},getHtDetail:function(t,e){var i=t.pq_detail;return i&&i.show?i.height||e:0},getTop:function(t,e){var i=this.topArr[t],n=e?0:this.diffV;if(n&&(i-=t>this.freezeRows?n:0)<0&&(i=0),i>=0)return i;throw i},getTopSafe:function(t,e,i){var n=e?this.cols:this.rows;return this[e?"getLeft":"getTop"](t>n?n:t,i)},getLeft:function(t,e){var i=this.numColWd,n=-1===t?0:this.leftArr[t]+i,r=e?0:this.diffH;if(r&&(n-=t>this.freezeCols?r:0)<0&&(n=0),n>=0)return n;throw n},getHeightR:function(t,e){e=e||1;var i=this.topArr,n=i[t+e]-i[t];if(n>=0)return n;throw n},getHeightCell:function(t,e){e=e||1;var i,n,r=this.topArr,o=this.rowHtDetail;if(i=o?this.getHtDetail(this.data[t+e-1],o):0,(n=r[t+e]-r[t]-i)>=0)return n;throw n},getHeightCellM:function(t,e){return this.getTopSafe(t+e)-this.getTop(t)},getHeightCellDirty:function(t,e){return this.setTopArr(t,null,t+e),this.getHeightCellM(t,e)},getWidthCell:function(t){if(-1===t)return this.numColWd;var e=this.colwdArr[t];if(e>=0)return e;throw e},getWidthCellM:function(t,e){return this.getTopSafe(t+e,!0)-this.getLeft(t)},initRowHtArr:function(){var t,e=this.rowHt,i=this.data,n=i.length,r=this.rowHtDetail,o=this.rowhtArr=[],a=(this.topArr=[],0);if(r)for(;a<n;a++)t=i[a],o[a]=t.pq_hidden?0:t.pq_ht||e+this.getHtDetail(t,r);else for(;a<n;a++)t=i[a],o[a]=t.pq_hidden?0:t.pq_ht||e},initRowHtArrDetailSuper:function(t){var e,i=this.rowhtArr,n=this.data;t.forEach(function(t){e=t[0],i[e]=n[e].pq_ht=i[e]+t[1]}),this.setTopArr(),this.assignTblDims()},initRowHtArrSuper:function(){this.initRowHtArr(),this.setTopArr(),this.assignTblDims()},refreshRowHtArr:function(t,e){var i=this.data[t],n=this.rowHtDetail,r=this.rowHt;this.rowhtArr[t]=i.pq_hidden?0:r+this.getHtDetail(i,n),e&&(this.setTopArr(t),this.assignTblDims())},setTopArr:function(t,e,i){var n,r,o,a,s,l=t||0;for(e?(r=this.cols,a=this.colwdArr,s=this.leftArr):(r=this.rows,a=this.rowhtArr,s=this.topArr),o=i&&i<r?i:r-1,n=l?s[l]:0;l<=o;l++)s[l]=n,n+=a[l];s[l]=n,s.length=r+1},triggerTblDims:function(t){var e=this;e.setTimer(function(){e.that._trigger("assignTblDims")},"assignTblDims",t)}}}(jQuery),function(t){var e=1533910;t(function(){var i=t("<div style='position:relative;'></div>").appendTo(document.body),n=t("<div style='position:absolute;left:0;'></div>").appendTo(i)[0],r=pq.cVirtual;n.style.top=1e9+"px";var o=n.offsetTop-50;(e=o<=1e4?e:o)>16554378&&(e=16554378),r.maxHt=e,i.remove(),r.setSBDim(),t(window).on("resize",r.setSBDim.bind(r))})}(jQuery),function(t){var e=window.pq=window.pq||{};e.cRender=function(){this.data=[]},e.cRender.prototype=t.extend({},{_m:function(){},autoHeight:function(t){var e=this.that,i=this.isBody(),n=t.hChanged,r=this.freezeRows,o=!1,a=this.initV,s=this.finalV;this.rows&&(i&&e._trigger("beforeAutoRowHeight"),o=this.setRowHtArr(a,s,n),(o=this.setRowHtArr(0,r-1,n)||o)?(this.setTopArr(r?0:a),this.assignTblDims(),this.setPanes(),this.setCellDims(!0),i&&(t.source="autoRow",this.refresh(t),e._trigger("autoRowHeight"))):this.setCellDims(!0))},autoWidth:function(t){var e=this.freezeCols,i=this.initH,n=this.finalH;null===t?(this.setColWdArr(i,n),this.setColWdArr(0,e-1)):this.setColWdArr(t,t)},_each:function(t,e,i,n,r,o){for(var a,s=this.jump,l=0;l<=i;l++)(a=n[l=s(e,o,l)])[r]||t.call(this,a,l)},eachV:function(t){this._each(t,this.initV,this.finalV,this.data,"pq_hidden",this.freezeRows)},eachH:function(t){this._each(t,this.initH,this.finalH,this.colModel,"hidden",this.freezeCols)},generateCell:function(t,e,i,n,r,o){var a,s,l,d,c,h,u,f,p=this.iMerge,g=[],v=this.riOffset,m=t+v,w=[this.cellCls];if(this._m()&&(f=p.ismergedCell(m,e))){if(!f.o_rc)return t===this._initV||e===this._initH?(c=this.getCellRegion(t,e),s=(d=p.getRootCell(m,e)).v_ri-v,l=d.v_ci,s<0?"":(h=this.getCellRegion(s,l),this.mcLaid[s+","+l+(h===c?"":","+c)]=!0,"")):"";(d=p.getClsStyle(m,e)).style&&g.push(d.style),d.cls&&w.push(d.cls),t=(m=f.o_ri)-v,i=this.data[t],e=f.o_ci,n=this.colModel[e],o=this.getHeightCellM(t,f.o_rc),a=this.getWidthCellM(e,f.o_cc),w.push("pq-merge-cell")}else if(i.pq_hidden||n.hidden)return"";if(u=this.getCellId(t,e,r),this.getById(u))return"";var x=o||this.getHeightCell(t),y=a||this.colwdArr[e],C=this.getLeft(e);return g.push("left:"+C+"px;width:"+y+"px;height:"+x+"px;"),this.renderCell({style:g,cls:w,attr:["role='gridcell' id='"+u+"'"],rowData:i,rowIndxPage:t,rowIndx:m,colIndx:e,column:n})},generateRow:function(t,e){var i="pq-grid-row",n="top:"+this.getTop(t)+"px;height:"+this.getHeightR(t)+"px;width:100%;",r="role='row' id='"+this.getRowId(t,e)+"'",o=this.getRowClsStyleAttr(t);return i+=" "+o[0],n+=o[1],"<div class='"+i+"' "+(r+=" "+o[2])+" style='"+n+"'>"},getById:function(t){return document.getElementById(t)},getCell:function(t,e,i){var n,r,o=this.riOffset,a=t+o;return i||(n=this.iMerge).ismergedCell(a,e)&&(r=n.getRootCell(a,e),this.isHead()&&(t=r.o_ri,e=r.o_ci),i=this.getCellRegion(r.v_ri-o,r.v_ci)),this.getById(this.getCellId(t,e,i))},getCellIndx:function(t){var e=t.id.split("-");if(e[3]==="u"+this.uuid)return[1*e[4],1*e[5],e[6]]},getCellId:function(t,e,i){return t>=this.data.length?"":(i=i||this.getCellRegion(t,e),this.cellPrefix+t+"-"+e+"-"+i)},getCellCont:function(t,e){return this["$c"+this.getCellRegion(t,e)]},getCellCoords:function(t,e){var i,n,r=this.maxHt,o=this.getTop(t),a=this.getHeightCell(t),s=(o=(i=(i=o+a)>r?r:i)-a,this.getLeft(e)),l=this.getWidthCell(e);return[s=(n=(n=s+l)>r?r:n)-l,o,n,i]},getCellRegion:function(t,e){var i=this.freezeCols;return t<this.freezeRows?e<i?"lt":"tr":e<i?"left":"right"},getCellXY:function(t,e){var i=this.maxHt;return[Math.min(this.getLeft(e),i),Math.min(this.getTop(t),i)]},getContRight:function(){return this.$cright},getMergeCells:function(){return this._m()?this.$tbl.children().children(".pq-merge-cell"):t()},getRow:function(t,e){return this.getById(this.getRowId(t,e))},getAllCells:function(){return this.$ele.children().children().children().children().children(this.isHead()?".pq-grid-col":".pq-grid-cell")},get$Col:function(t,e){var i=["right","left","lt","rt"].map(function(e){return"[id$=-"+t+"-"+e+"]"}).join(",");return(e||this.getAllCells()).filter(i)},get$Row:function(t){return this.$ele.find("[id^="+this.getRowId(t,"")+"]")},getRowClsStyleAttr:function(t){var e=this.that,i=[],n=e.options,r=n.rowInit,o=this.data[t],a=o.pq_rowcls,s=o.pq_rowattr,l="",d="",c=t+this.riOffset;if(r){var h=r.call(e,{rowData:o,rowIndxPage:t,rowIndx:c});h&&(h.cls&&i.push(h.cls),l+=h.attr?" "+h.attr:"",d+=h.style?h.style:"")}if(n.stripeRows&&this.stripeArr[t]&&i.push("pq-striped"),o.pq_rowselect&&i.push(e.iRows.hclass),a&&i.push(a),s){var u=e.stringifyAttr(s);for(var f in u){l+=" "+f+'="'+u[f]+'"'}}return[i.join(" "),d,l]},getRowId:function(t,e){if(null===e)throw"getRowId region.";return this.rowPrefix+t+"-"+e},getRowIndx:function(t){var e=t.id.split("-");return[1*e[4],e[5]]},getTable:function(t,e){return this["$tbl_"+this.getCellRegion(t,e)]},getTblCls:function(t){var e=this.isBody()?[]:["pq-grid-summary-table"];return t.rowBorders&&e.push("pq-td-border-top"),t.columnBorders&&e.push("pq-td-border-right"),t.wrap||e.push("pq-no-wrap"),e.join(" ")},getFlexWidth:function(){return this._flexWidth},preInit:function(t){var e=this.isBody(),i=this.isHead(),n=this.that.options,r=(n.freezeCols,i||n.freezeRows,"pq-table "+this.getTblCls(n)),o=["pq-cont-inner ","pq-cont-right","pq-cont-left","pq-cont-lt","pq-cont-tr"];t.empty(),t[0].innerHTML=['<div class="pq-grid-cont">',e?'<div class="pq-grid-norows">'+n.strNoRows+"</div>":"",'<div class="',o[0]+o[1],'"><div class="pq-table-right '+r+'"></div>',e?"":'<div class="pq-r-spacer" style="position:absolute;top:0;height:10px;"></div>',"</div>",'<div class="'+o[0]+o[2]+'"><div class="pq-table-left '+r+'"></div></div>','<div class="'+o[0]+o[4]+'"><div class="pq-table-tr '+r+'"></div></div>','<div class="'+o[0]+o[3]+'"><div class="pq-table-lt '+r+'"></div></div>',"</div>"].join(""),this.$cright=t.find("."+o[1]).on("scroll",this.onNativeScroll(this)),e||(this.$spacer=t.find(".pq-r-spacer")),this.$cleft=t.find("."+o[2]).on("scroll",this.onScrollL),this.$clt=t.find("."+o[3]).on("scroll",this.onScrollLT),this.$ctr=t.find("."+o[4]).on("scroll",this.onScrollT),this.$tbl=t.find(".pq-table").on("scroll",this.onScrollLT),this.$tbl_right=t.find(".pq-table-right"),this.$tbl_left=t.find(".pq-table-left"),this.$tbl_lt=t.find(".pq-table-lt"),this.$tbl_tr=t.find(".pq-table-tr"),e&&this.$cleft.add(this.$ctr).on("mousewheel DOMMouseScroll",this.onMouseWheel(this))},isBody:function(){},isHead:function(){},isSum:function(){},jump:function(t,e,i){return i<t&&i>=e&&(i=t),i},hasMergeCls:function(t){return t&&t.className.indexOf("pq-merge-cell")>=0},initRefreshTimer:function(t){this.setTimer(this.onRefreshTimer(this,t),"refresh")},initStripeArr:function(){for(var t,e=this.rows,i=0,n=this.stripeArr=[],r=this.data;i<e;i++)r[i].pq_hidden||(t=n[i]=!t)},isRenderedRow:function(t){return!!this.getRow(t)},onScrollLT:function(){this.scrollTop=this.scrollLeft=0},onScrollT:function(){this.scrollTop=0},onScrollL:function(){this.scrollLeft=0},refresh:function(t){t=t||{};var e=this.that,i=this.isBody(),n=this.isHead(),r=(null===t.timer||t.timer,this.mcLaid={}),o=this.freezeCols,a=this.numColWd,s=!(!o&&!a),l=this.freezeRows,d=(x=this.calInitFinalSuper())[0],c=x[1],h=x[2],u=x[3],f=x[4],p=this.initV,g=this.finalV,v=this.initH,m=this.finalH;for(var w in i&&e.blurEditor({force:!0}),this._initV=d,this._finalV=h,this._initH=c,this._finalH=u,i&&e._trigger("beforeTableView",null,{initV:d,finalV:h,pageData:this.data}),f||(null!==g&&h>=p&&d<=g&&(d>p?(this.removeView(p,d-1,v,m),s&&this.removeView(p,d-1,a?-1:0,o-1)):d<p&&(this.renderView(d,p-1,c,u),s&&this.renderView(d,p-1,0,o-1)),h<g?(this.removeView(h+1,g,v,m),s&&this.removeView(h+1,g,a?-1:0,o-1)):h>g&&(this.renderView(g+1,h,c,u),s&&this.renderView(g+1,h,0,o-1)),p=d,g=h),null!==m&&u>v&&c<m&&(c>v?(this.removeView(p,g,v,c-1),l&&this.removeView(0,l-1,v,c-1)):c<v&&(this.renderView(p,g,c,v-1),l&&this.renderView(0,l-1,c,v-1)),u<m?(this.removeView(p,g,u+1,m),l&&this.removeView(0,l-1,u+1,m)):u>m&&(this.renderView(p,g,m+1,u),l&&this.renderView(0,l-1,m+1,u)),v=c,m=u)),f||h!==g||d!==p||c!==v||u!==m?(i&&e._trigger("beforeViewEmpty",null,{region:"right"}),this.$tbl_right.empty(),this.renderView(d,h,c,u),!s||h===g&&d===p||(this.$tbl_left.empty(),this.renderView(d,h,0,o-1)),l&&(c===v&&u===m||(e._trigger("beforeViewEmpty",null,{region:"tr"}),this.$tbl_tr.empty(),this.renderView(0,l-1,c,u)),s&&null===g&&(this.$tbl_lt.empty(),this.renderView(0,l-1,0,o-1)))):this.removeMergeCells(),r){var x,y=1*(x=w.split(","))[0],C=1*x[1],b=x[2];this.renderView(y,y,C,C,b)}var I=c!==this.initH||u!==this.finalH,_=I&&null!==this.initH;(h!==this.finalV||d!==this.initV||I)&&(this.initV=d,this.finalV=h,this.initH=c,this.finalH=u,i?e._trigger("refresh",null,{source:t.source,hChanged:_}):e._trigger(n?"refreshHeader":"refreshSum",null,{hChanged:_}))},refreshAllCells:function(t){this.initH=this.initV=this.finalH=this.finalV=null,this.refresh(t)},refreshCell:function(e,i,n,r){var o,a=this,s=a.isBody()&&a._m()?a.iMerge.getRootCellV(e+a.riOffset,i):0,l=e,d=i,c=function(s,l){s&&(o=!0,s.id="",t(s).replaceWith(a.generateCell(e,i,n,r,l)))};return s?(e=s.rowIndxPage,i=s.colIndx,n=s.rowData,r=s.column,["lt","tr","left","right"].forEach(function(t){c(a.getCell(l,d,t),t)})):c(a.getCell(e,i)),o},removeMergeCells:function(){for(var e,i,n,r,o,a,s,l,d,c,h=this.iMerge,u=this.riOffset,f=(this.freezeCols,this.freezeRows,this.getMergeCells()),p=this._initH,g=this._finalH,v=this._initV,m=this._finalV,w=0,x=f.length;w<x;w++)l=f[w],(i=this.getCellIndx(l))&&(n=i[0],r=i[1],d=i[2],o=n+(e=h.getRootCell(n+u,r)).o_rc-1,a=r+e.o_cc-1,s=!1,n>m||r>g?s=!0:"right"===d?(o<v||a<p)&&(s=!0):"left"===d?o<v&&(s=!0):"tr"===d&&a<p&&(s=!0),c=l.parentNode,s&&t(l).remove(),c.children.length||c.parentNode.removeChild(c))},removeView:function(e,i,n,r){var o,a,s,l,d=this.getCellRegion(e,n);for(a=e;a<=i;a++)if(o=this.getRow(a,d)){for(s=n;s<=r;s++)(l=this.getCell(a,s,d))&&(this.hasMergeCls(l)||t(l).remove());o.children.length||o.parentNode.removeChild(o)}},renderNumCell:function(t,e,i){var n=this.getHeightR(t),r=this.isHead();return"<div id='"+this.getCellId(t,-1,i)+"' style='"+("position:absolute;left:0;top:0;width:"+e+"px;height:"+n+"px;")+"' role='gridcell' class='pq-grid-number-cell '>"+(this.isBody()?t+1+this.riOffset:r&&t===this.data.length-1&&this.numberCell.title||"")+"</div>"},renderRow:function(e,i,n,r,o,a){var s,l,d,c,h=this.getRow(n,a),u=this.numColWd,f=[],p=this.getHeightCell(n),g=this.colModel;for(!h&&e.push(this.generateRow(n,a)),0!==r||!u||"left"!==a&&"lt"!==a||(c=this.renderNumCell(n,u,a),f.push(c)),d=r;d<=o;d++)(l=g[d]).hidden||(c=this.generateCell(n,d,i,l,a,p),f.push(c));s=f.join(""),h?t(h).append(s):e.push(s,"</div>")},renderView:function(t,e,i,n,r){if(null!==i&&null!==n){r=r||this.getCellRegion(t,Math.min(i,n));for(var o,a=[],s=this.data,l=this["$tbl_"+r],d=t;d<=e;d++)(o=s[d])&&!o.pq_hidden&&this.renderRow(a,o,d,i,n,r);l.append(a.join(""))}},scrollX:function(t,e){var i=this.$cright[0];if(!(t>=0))return i.scrollLeft;this.scrollXY(t,i.scrollTop,e)},setCellDims:function(t){var e,i=this,n=i.iMerge,r=i._m(),o=i.colModel,a=i.numColWd,s=i.jump,l=i.setRowDims(),d=i.riOffset,c=i.initH,h=i.finalH,u=i.freezeCols;i.eachV(function(f,p){var g,v=i.get$Row(p),m=i.getHeightR(p),x=i.getTop(p),y=i.getHeightCell(p);l(v,m,x);for(var C=a?-1:0;C<=h;C++)((C=s(c,u,C))<0||!o[C].hidden)&&(r&&(w=n.ismergedCell(p+d,C))||(g=i.getCell(p,C))&&((e=g.style).height=(-1===C?m:y)+"px",t||(e.width=i.getWidthCell(C)+"px",e.left=i.getLeft(C)+"px")))});for(var f=i.getMergeCells(),p=0,g=f.length;p<g;p++){var v=f[p],m=i.getCellIndx(v);if(m){var w,x=m[0],y=m[1],C=(w=n.getRootCell(x+d,y)).v_ri-d,b=i.get$Row(C),I=i.getHeightR(C),_=i.getHeightCellM(x,w.o_rc),q=i.getTop(C);l(b,I,q),(e=v.style).height=_+"px",t||(e.width=i.getWidthCellM(y,w.o_cc)+"px",e.left=i.getLeft(y)+"px")}}},setRowDims:function(){var t=this.isBody()&&this.that.Anim().isActive();return function(e,i,n){var r={height:i,width:"100%"};t||(r.top=n),e.css(r)}},setColWdArr:function(e,i){var n,r,o,a,s,l,d,c,h=i,u=this.jump,f=this.colModel,p=this.data,g=this.freezeRows,v=this.maxHt+"px",m=this.iMerge,w=this.initV,x=this.isBody(),y=this.isSum(),C=x||y,b=this.isHead()?this.that.headerCells.length-1:this.finalV;if(b>=0)for(;h>=e;h--)if(!(r=f[h]).hidden&&-1===(r.width+"").indexOf("%")&&(l=C?r.width:r._minWidth)){for(n=0;n<=b;n++)if((a=p[n=u(w,g,n)])&&!a.pq_hidden){if(d=!0,c=m.ismergedCell(n,h)){if(!0===c)continue;if((c=m.getRootCell(n,h)).v_rc>1||c.v_cc>1){if(c.v_cc>1)continue;d=!1}o=this.getCell(c.o_ri,c.o_ci)}else o=this.getCell(n,h);if(o.parentNode.style.width=v,d){o.style.width="auto";var I=t(o).find(".pq-menu-icon,.pq-menu-filter-icon");if(I.length){I.css({position:"static",float:"left",width:20});var _=t(o).find(".pq-td-div");_.css("width","auto")}}s=o.offsetWidth+1,d&&I.length&&(I.css({position:"",float:"",width:""}),_.css("width","")),l=Math.max(s,l)}if(!(l>0))throw"wd NaN";r.width=this.colwdArr[h]=l,r._resized=!0}},setRowHtArr:function(t,e,i){for(var n,r,o,a,s,l,d,c,h,u,f=e,p=this.jump,g=this.riOffset,v=this.rowhtArr,m=this.data,w=this.colModel,x=this._m(),y=this.diffV,C=this.freezeCols,b=this.rowHt,I=this.iMerge,_=this.rowHtDetail,q=this.initH,D=this.finalH;f>=t;f--)if((a=m[f])&&!a.pq_hidden){for(u=_?this.getHtDetail(a,_):0,d=i?v[f]-u:b,n=0;n<=D;n++)if(n,!w[n=p(q,C,n)].hidden){if(c=x&&I.ismergedCell(f+g,n)){if(!0===c||y)continue;c=I.getRootCell(f+g,n),s=this.getCell(c.o_ri-g,c.o_ci)}else s=this.getCell(f,n);s.style.height="auto",l=s.offsetHeight,c&&(h=c.o_rc-(c.v_ri-c.o_ri)-1,l-=c.v_rc>1?this.getHeightCellDirty(c.v_ri+1,h):0),d=Math.max(l,d)}o=d+u,v[f]!==o&&(v[f]=a.pq_ht=o,r=!0)}return r},setTimer:function(t){var e={};return function(i,n,r){n=t+n,clearTimeout(e[n]);var o=this;e[n]=setTimeout(function(){o.that.element&&i.call(o)},r||300)}}},new e.cVirtual)}(jQuery),function(t){pq.cRenderBody=function(t,e){var i=this,n=i.uuid=t.uuid,r=t.options,o=i.$ele=e.$b,a=i.$sum=e.$sum,s=i.$h=e.$h,l=r.postRenderInterval;i.that=t,i.setTimer=i.setTimer(n),i.cellPrefix="pq-body-cell-u"+n+"-",i.rowPrefix="pq-body-row-u"+n+"-",i.cellCls="pq-grid-cell",i.iMerge=t.iMerge,i.rowHt=r.rowHt||27,i.rowHtDetail=r.detailModel.height,i.iRenderHead=t.iRenderHead=new pq.cRenderHead(t,s),i.iRenderSum=t.iRenderSum=new pq.cRenderSum(t,a),t.on("headHtChanged",i.onHeadHtChanged(i)),null!==l&&t.on("refresh refreshRow refreshCell refreshColumn",function(){l<0?i.postRenderAll():i.setTimer(i.postRenderAll,"postRender",l)}),i.preInit(o),t.on("refresh softRefresh",i.onRefresh.bind(i))},pq.cRenderBody.prototype=t.extend({},new t.paramquery.cGenerateView,new pq.cRender,{setHtCont:function(t){this.dims.htCont=t,this.$ele.css("height",t)},flex:function(t){var e=this.that;!1!==e._trigger("beforeFlex",null,{colIndx:t})&&(this.iRenderHead.autoWidth(t),this.iRenderSum.autoWidth(t),this.autoWidth(t),e.refreshCM(null,{flex:!0}),e.refresh({source:"flex",soft:!0}))},init:function(t){t=t||{};var e,i=this.that,n=t.soft,r=!n,o=t.source,a=this.iRenderHead,s=this.iRenderSum,l=i.options,d=l.scrollModel,c=(this.freezeCols=l.freezeCols||0,this.freezeRows=l.freezeRows,this.numberCell=l.numberCell),h=this.colModel=i.colModel,u=(this.width=l.width,this.height=l.height,this.$ele);r&&(this.dims=i.dims,this.autoFit=d.autoFit,this.pauseTO=d.timeout,e=i.pdata||[],u.find(".pq-grid-norows").css("display",e.length?"none":""),this.data=e,this.maxHt=pq.cVirtual.maxHt,this.riOffset=i.riOffset,this.cols=h.length,this.rows=e.length,i._mergeCells&&(this._m=function(){return!0}),this.autoRow=l.autoRow,this.initRowHtArrSuper(),l.stripeRows&&this.initStripeArr()),this.refreshColumnWidths(),this.numColWd=a.numColWd=s.numColWd=c.show?c.outerWidth:0,this.initColWdArrSuper(),s.init(t),t.header?a.init(t):this.setPanes(),s.initPost(t),t.header&&a.initPost(t),this.$cright[0].scrollTop>this.getTop(this.rows)||(r?this.refreshAllCells({source:o}):n&&(this.setCellDims(),this.refresh({source:o}),i._trigger("softRefresh")))},initColWdArr:function(){for(var t,e=this.colModel,i=e.length,n=(this.leftArr=this.iRenderHead.leftArr=this.iRenderSum.leftArr=[],0),r=this.colwdArr=this.iRenderHead.colwdArr=this.iRenderSum.colwdArr=[];n<i;n++)t=e[n],r[n]=t.hidden?0:t.outerWidth},initColWdArrSuper:function(){this.initColWdArr(),this.setTopArr(0,!0),this.assignTblDims(!0)},inViewport:function(t,e,i){i=i||this.getCell(t,e);var n=this.dims,r=n.left-2,o=n.right-(n.wdCont-n.wdContClient)+2,a=n.top-2,s=n.bottom-(n.htCont-n.htContClient)+2,l=this.getCellRegion(t,e),d=(this.initH,this.finalH,this.initV,this.finalV,i.parentNode),c=i.offsetLeft-n.wdContLeft,h=d.offsetTop-n.htContTop,u=c+i.offsetWidth,f=h+i.offsetHeight;return"right"===l?c>r&&u<o&&h>a&&f<s:"tr"===l?c>r&&u<o:"left"!==l||h>a&&f<s},isBody:function(){return!0},onHeadHtChanged:function(t){return function(e,i){t.setPanes()}},onMouseWheel:function(t){var e;return function(t){var i=this;i.style["pointer-events"]="none",clearTimeout(e),e=setTimeout(function(){i.style["pointer-events"]=""},300)}},onNativeScroll:function(t){return function(){var e=t.$cright[0],i=t.that,n=e.scrollLeft,r=e.scrollTop;t.iRenderSum.setScrollLeft(n),t.iRenderHead.setScrollLeft(n),t.$cleft[0].scrollTop=r,t.$ctr[0].scrollLeft=n,t.refresh(),i._trigger("scroll"),t.setTimer(function(){i._trigger("scrollStop")},"scrollStop",t.pauseTO)}},onRefresh:function(t,e){"autoRow"!==e.source&&this.initRefreshTimer(e.hChanged)},onRefreshTimer:function(t,e){return function(){var i=t.$cright[0];t.autoRow&&t.autoHeight({hChanged:e}),i.scrollTop=i.scrollTop,i.scrollLeft=i.scrollLeft}},pageDown:function(t,e){var i,n=this,r=n.topArr,o=r[t],a=t,s=n.dims,l=this.$cright[0].scrollTop,d=95*(s.htContClient-s.htContTop)/100,c=o+d,h=t,u=r.length-1;n.scrollY(l+d,function(){for(h=t<n.initV?n.initV:t;h<=u;h++)if((i=r[h])>o&&(o=i,a=h-1),i>c){a=h-1;break}e(a)})},pageUp:function(t,e){for(var i,n=this.topArr,r=n[t],o=this.$cright[0].scrollTop,a=this.dims,s=80*(a.htContClient-a.htContTop)/100,l=r-s,d=t,c=t;c>=0;c--)if((i=n[c])<r&&(r=i,d=c),i<l){d=c;break}this.scrollY(o-s,function(){e(d)})},postRenderAll:function(){var t,e,i,n=this,r=n.that,o=n.riOffset,a=n.iMerge,s=n.data;n.colModel;n.eachH(function(s,l){(i=s.postRender)&&n.eachV(function(s,d){e=a.getRootCellO(d+o,l,!0),(t=n.getCell(e.rowIndxPage,e.colIndx))&&!t._postRender&&(e.cell=t,r.callFn(i,e),t._postRender=!0)})}),(i=n.numberCell.postRender)&&n.eachV(function(t,e){var a=n.getCell(e,-1),l=e+o,d={rowIndxPage:e,colIndx:-1,rowIndx:l,rowData:s[l]};a&&!a._postRender&&(d.cell=a,r.callFn(i,d),a._postRender=!0)})},refreshRow:function(t){var e,i,n=this,r=n.initH,o=n.finalH,a=n.freezeCols,s=n.get$Row(t),l=[];s.each(function(t,e){var i=n.getRowIndx(e);l.push(i[1])}),n.that._trigger("beforeViewEmpty",null,{rowIndxPage:t}),s.remove(),l.forEach(function(s){"left"===s||"lt"===s?(e=0,i=a-1):(e=r,i=o),n.renderView(t,t,e,i,s)})},_scrollRow:function(t,e){var i,n=this.dims,r=n[e?"wdContClient":"htContClient"],o=e?"scrollLeft":"scrollTop",a=this.$cright[0],s=this[e?"colModel":"data"].length,l=this[e?"freezeCols":"freezeRows"],d=a[o],c=n[e?"wdContLeft":"htContTop"];if(t<l||t>s-1)return d;var h=this.getTopSafe(t,e),u=this[e?"getWidthCell":"getHeightR"](t);return null!==h?(h+u+1>d+r?i=h+u+1-r:h<d+c&&(i=(i=h-c)<0?0:i),i>=0?i:d):void 0},scrollColumn:function(t,e){var i=this._scrollRow(t,!0);this.scrollX(i,e)},scrollRow:function(t,e){var i=this._scrollRow(t);this.scrollY(i,e)},scrollCell:function(t,e,i){var n=this._scrollRow(t),r=this._scrollRow(e,!0);this.scrollXY(r,n,i)},scrollY:function(t,e){var i=this.$cright[0];if(null===t)return i.scrollTop;t=t>=0?t:0,this.scrollXY(i.scrollLeft,t,e)},scrollXY:function(t,e,i){var n,r,o=this.$cright[0],a=this.that,s=o.scrollLeft,l=o.scrollTop;if(!(t>=0))return[s,l];o.scrollLeft=t,o.scrollTop=e,n=o.scrollLeft,r=o.scrollTop,i&&(n===s&&r===l?i():a.one("scroll",function(){n===s?i():a.one("scrollHead",i)}))},getSBHt:function(t){var e=this.dims,i=this.that.options,n=pq.cVirtual.SBDIM;return this.autoFit?0:("flex"!==this.width||i.maxWidth)&&t>e.wdCenter+n?n:0},getSBWd:function(){return this.dims.htCenter?pq.cVirtual.SBDIM:0},setPanes:function(){var t,e,i,n=this.that.options,r=this.autoFit,o=this.dims,a=o.htCenter-o.htHead-o.htSum,s=o.wdCenter,l=this.$ele,d=this.freezeCols,c=this.freezeRows,h=this.$cright,u=h[0],f=this.$cleft,p=this.$clt,g=this.$ctr,v=this.getLeft(d),m=pq.cVirtual.SBDIM,w=o.wdTbl,x=Math.max(o.htTbl,30)+this.getSBHt(w),y=this.getTopSafe(c);g.css("display",c?"":"none"),f.css("display",v?"":"none"),p.css("display",v&&c?"":"none"),h.css("overflow-y",""),"flex"===this.height?(a>0&&x>a?x=Math.min(x,a):h.css("overflow-y","hidden"),this.setHtCont(x)):this.setHtCont(a),r&&this.getSBWd()&&h.css("overflow-y","scroll"),h.css("overflow-x",r?"hidden":""),"flex"===this.width?(w=parseInt(l[0].style.height)>=o.htTbl-1?w:w+m,n.maxWidth&&w>s?w=Math.min(w,s):h.css("overflow-x","hidden"),this._flexWidth=w,l.width(this._flexWidth)):l.css("width",""),this.htCont=o.htCont=h.height(),this.wdCont=o.wdCont=h.width(),o.htContClient=i=u.clientHeight,o.wdContClient=t=u.clientWidth,v>t&&(h.css("overflow-x","hidden"),v=t),f.css("width",v),p.css("width",v),g.width(t),f.height(i),e=u.offsetWidth,this.iRenderHead.setWidth(e,t),this.iRenderSum.setWidth(e,t),y>i&&(h.css("overflow-y","hidden"),y=i),p.css("height",y),g.css("height",y),this.wdContLeft=o.wdContLeft=f.width(),this.htContTop=o.htContTop=g.height()}},new pq.cVirtual)}(jQuery),function(t){function e(t){this.that=t}jQuery.paramquery.cMergeHead=e,e.prototype={getRootCell:function(t,e){for(var i=this.that,n=i.headerCells,r=n[t][e],o=r.rowSpan,a=r.leftPos;t&&n[t-1][a]===r;)t--;return{v_ri:t,o_ri:t,v_ci:i.getNextVisibleCI(a),o_ci:a,v_rc:o,o_rc:o,v_cc:r.colSpan,o_cc:r.o_colspan}},ismergedCell:function(t,e){var i,n,r,o=this.that,a=o.headerCells,s=a[t],l=s?s[e]:"";if(l)if(i=l.leftPos,0!==t&&a[t-1][e]===l||o.getNextVisibleCI(i)!==e){if(l.colSpan)return!0}else if(n=l.rowSpan,r=l.colSpan,n&&r&&(n>1||r>1))return{o_ri:t,o_ci:i,v_rc:n,o_rc:n,v_cc:r,o_cc:l.o_colspan}},getClsStyle:function(){return{}}}}(),function(t){pq.cRenderHS=t.extend({},new pq.cRender,{init:function(t){t=t||{};var e,i=this.that,n=i.options,r=(this.freezeCols=n.freezeCols||0,this.numberCell=n.numberCell,this.colModel=i.colModel),o=this.isHead(),a=this.isSum(),s=o?n.autoRowHead:n.autoRowSum,l=(this.width=n.width,this.height="flex",i.headerCells);this.freezeRows=0;this.dims=i.dims,o?e=this.data=n.showHeader?n.filterModel.header?l.concat([[]]):l:[]:a&&(e=this.data=n.summaryData||[]),this.maxHt=pq.cVirtual.maxHt,this.riOffset=0,this.cols=r.length,this.rows=e.length,o?l.length>1&&(this._m=function(){return!0}):n.stripeRows&&this.initStripeArr(),this.autoRow=null===s?n.autoRow:s,this.initRowHtArrSuper(),this.assignTblDims(!0),this.setPanes()},initPost:function(t){t=t||{};this.autoRow;this.data.length&&(t.soft?(this.setCellDims(),this.refresh()):this.refreshAllCells())},onNativeScroll:function(t){return function(){t.refresh(),t.isHead()&&t.that._trigger("scrollHead")}},onRefresh:function(t,e){this.initRefreshTimer(e.hChanged)},refreshHS:function(){this.init(),this.initPost()},setPanes:function(){var t=this.that,e=this.dims,i=this.$ele,n=this.freezeCols,r=this.$cright,o=r[0],a=this.$cleft,s=this.getLeft(n),l=this.isHead(),d=this.isSum(),c=this.getTopSafe(this.rows);this.data.length;a.css("display",s?"":"none"),i.height(c),l?(e.htHead=c,t._trigger("headHtChanged")):d&&(e.htSum=c,t._trigger("headHtChanged")),this.htCont=r.height(),this.wdCont=r.width(),a.css("width",s),a.height(o.clientHeight),this.wdContLeft=a.width(),this.htContTop=0},setScrollLeft:function(t){var e=this.$cright;e&&this.scrollLeft!==t&&(this.scrollLeft=e[0].scrollLeft=t)},setWidth:function(t,e){this.$ele[0].style.width=t+"px",this.$spacer.width(t-e)}})}(jQuery),function(t){var e=t.paramquery;(pq.cRenderHead=function(t,i){this.that=t;var n=t.options,r=this,o=r.uuid=t.uuid;r.iMerge=new e.cMergeHead(t),r.$ele=i,r.height="flex",r.scrollTop=0,r.rowHt=n.rowHtHead||28,r.cellCls="pq-grid-col",r.setTimer=r.setTimer(o),r.cellPrefix="pq-head-cell-u"+o+"-",r.rowPrefix="pq-head-row-u"+o+"-",r.preInit(i),i.on("click",function(t){return r.onHeaderClick(t)}),t.on("headerKeyDown",r.onHeaderKeyDown.bind(r)).on("refreshHeader softRefresh",r.onRefresh.bind(r))}).prototype=t.extend({},pq.cRenderHS,new e.cHeader,new e.cHeaderSearch,{getRowClsStyleAttr:function(t){var e=this.that.headerCells.length,i="";return e===t?i="pq-grid-header-search-row":t===e-1&&(i="pq-grid-title-row"),[i,"",""]},getTblCls:function(t){var e="pq-grid-header-table";return t.hwrap?e:e+" pq-no-wrap"},isHead:function(){return!0},onRefreshTimer:function(t,e){return function(){var i=t.$cright[0];t.autoRow&&t.autoHeight({timer:!1,hChanged:e}),i.scrollTop=0,i.scrollLeft=i.scrollLeft,t.onCreateHeader(),t.refreshResizeColumn(),t.refreshHeaderSortIcons(),t.that._trigger("refreshHeadAsync")}},_resizeId:function(t){return"pq-resize-div-"+this.uuid+"-"+t},_resizeCls:function(){return"pq-resize-div-"+this.uuid},_resizeDiv:function(t){return this.getById(this._resizeId(t))},refreshResizeColumn:function(){var t,e,i,n,r=this.initH,o=this.colModel,a=this._resizeCls(),s=this.finalH,l=this.numberCell,d=this.freezeCols,c=[],h=[],u=l.show?-1:0;for(this.$ele.find("."+a).remove();u<=s;u++){if(u>=r)e=h;else{if(!(u<d))continue;e=c}(t=u>=0?o[u]:l).hidden||!1===t.resizable||this._resizeDiv(u)||(i=this.getLeft(u+1)-5,n=this._resizeId(u),e.push("<div id='",n,"' pq-col-indx='",u,"' style='left:",i,"px;'"," class='pq-grid-col-resize-handle "+a+"'>&nbsp;</div>"))}c.length&&this.$cleft.append(c.join("")),h.length&&this.$cright.append(h.join(""))},renderCell:function(t){var e,i=t.rowData,n=t.rowIndx,r=t.colIndx,o=t.attr,a=t.cls,s=t.style,l=i[r];return l?this.createHeaderCell(n,r,l,o,a,s):(e=this.renderFilterCell(t.column,r,a),"<div "+o+" class='"+a.join(" ")+"' style='"+s.join("")+"'>"+e+"</div>")}})}(jQuery),function(t){var e=t.paramquery;(pq.cRenderSum=function(t,e){var i=t.options,n=this.uuid=t.uuid;this.that=t,this.iMerge={ismergedCell:function(){}},this.$ele=e,this.height="flex",this.scrollTop=0,this.rowHt=i.rowHtSum||27,this.cellCls="pq-grid-cell",this.setTimer=this.setTimer(n),this.cellPrefix="pq-sum-cell-u"+n+"-",this.rowPrefix="pq-sum-row-u"+n+"-",this.preInit(e),t.on("refreshSum softRefresh",this.onRefresh.bind(this))}).prototype=t.extend({},new e.cGenerateView,pq.cRenderHS,{isSum:function(){return!0},onRefreshTimer:function(t,e){return function(){var i=t.$cright[0];t.autoRow&&t.autoHeight({timer:!1,hChanged:e}),i.scrollTop=0,i.scrollLeft=i.scrollLeft}}})}(jQuery);